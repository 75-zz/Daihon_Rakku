"""エロセリフプール v3.5: 重複置換用の大量セリフ辞書（CG集吹き出し用）

合計1415+エントリー:
  MOAN_POOL: 5 intensity × 80 = 400
  SPEECH_FEMALE_POOL: 8 categories = 370
  THOUGHT_POOL: 5 categories + forced = 340
  SPEECH_MALE_POOL: 4 categories = 155
  NEUTRAL_POOL: 2 categories = 50 (非エロシーン用)
  AFTERMATH_POOL: 2 categories = 50 (事後シーン用)
  MALE_SHORT_REPLACEMENTS: 男性セリフ短縮辞書 = 50+
"""
import random


# ============================================================================
# 喘ぎ声プール（intensity別、各80エントリー）
# ============================================================================
MOAN_POOL = {
    # Intensity 1: 低感度・恥じらい（控えめ、♡なし）
    1: [
        "んっ…",
        "はぁ…",
        "ふぅ…",
        "くっ…",
        "うっ…",
        "ひっ…",
        "んぅ…",
        "はっ…",
        "ふっ…",
        "ぅん…",
        "んん…",
        "くぅ…",
        "ひぅ…",
        "うぅ…",
        "はぅ…",
        "んはっ…",
        "ふぁ…",
        "くはっ…",
        "ぁ…",
        "んくっ…",
        "ひぁ…",
        "はふ…",
        "ふんっ…",
        "うん…",
        "くふっ…",
        "んぁ…",
        "ふはっ…",
        "ひふ…",
        "はんっ…",
        "ぅぁ…",
        "んふっ…",
        "くんっ…",
        "ふぅん…",
        "はぁん…",
        "ひんっ…",
        "うはっ…",
        "んはぁ…",
        "くはぁ…",
        "ふくっ…",
        "ぅんっ…",
        "はひっ…",
        "ひくっ…",
        "んんっ…",
        "ふひっ…",
        "くぅん…",
        "うくっ…",
        "はふっ…",
        "ひはっ…",
        "んくぅ…",
        "ふぅっ…",
        "くっん…",
        "うふっ…",
        "ぅはっ…",
        "んひっ…",
        "はくっ…",
        "ふんぅ…",
        "ひぅん…",
        "くんぅ…",
        "うんっ…",
        "んぅっ…",
        "はぁっ…",
        "ふぁっ…",
        "くひっ…",
        "うぁ…",
        "ひはぁ…",
        "んふぅ…",
        "はんぅ…",
        "ふひぁ…",
        "くぁ…",
        "うひっ…",
        "ぅくっ…",
        "んはっ",
        "はぅん…",
        "ふはぁ…",
        "ひんぅ…",
        "くふぅ…",
        "うはぁ…",
        "んぅん…",
        "はふぅ…",
        "ふぅぁ…",
    ],

    # Intensity 2: 感じ始め（声が漏れ始める、♡付き）
    2: [
        "あっ♡",
        "やぁ…♡",
        "ひゃっ♡",
        "んあっ♡",
        "あぁ…",
        "やっ…",
        "ふあっ♡",
        "んんっ♡",
        "はあっ…",
        "ひあっ♡",
        "あんっ♡",
        "やぁん…",
        "くあっ…",
        "ふあぁ…♡",
        "んやっ♡",
        "あはっ♡",
        "ひゃぁ…♡",
        "やんっ…",
        "はあぁ…♡",
        "あふっ…",
        "んはっ♡",
        "ふやっ♡",
        "ひあぁ…",
        "あくっ…",
        "やひっ♡",
        "くあぁ…♡",
        "んあぁ…",
        "はやっ♡",
        "あぁん♡",
        "ふひゃっ♡",
        "ひんっ…♡",
        "やあっ…",
        "あやっ♡",
        "んふあっ♡",
        "くやっ…",
        "はあんっ♡",
        "ふあんっ…",
        "あひっ♡",
        "ひやっ…♡",
        "やふっ…",
        "んくあっ…",
        "あんぅ…♡",
        "はふあ…",
        "くんあっ♡",
        "ふやぁ…♡",
        "ひふっ…",
        "やあぁ…♡",
        "あはぁ…♡",
        "んひゃっ♡",
        "はやぁ…",
        "ふんあっ…",
        "あぅっ♡",
        "くひゃ…",
        "ひあんっ♡",
        "やくっ…♡",
        "んあんっ…",
        "はひゃっ♡",
        "あやぁ…♡",
        "ふくあっ…",
        "ひやぁ…",
        "やんあっ♡",
        "あんはっ♡",
        "くふあっ♡",
        "んやぁ…♡",
        "はあふっ…",
        "ふひあっ♡",
        "あくぅ…",
        "ひゃんっ♡",
        "やはっ…",
        "んあはっ…",
        "くやぁ…♡",
        "はんあ…♡",
        "あひゃ…♡",
        "ふやんっ♡",
        "ひくっ…♡",
        "やぅん…",
        "あふぅ…♡",
        "んやんっ…",
        "はひあっ♡",
        "くあんっ♡",
    ],

    # Intensity 3: 前戯・本番開始（♡♡も登場）
    3: [
        "あぁっ♡",
        "んはぁっ♡",
        "ひぁっ♡♡",
        "あんっ♡♡",
        "やぁっ♡♡",
        "はぁんっ♡",
        "ふあぁっ♡",
        "んあぁっ♡♡",
        "あひぃっ♡",
        "くぅっ♡♡",
        "やあぁっ♡♡",
        "ひゃあっ♡♡",
        "あぁあっ♡",
        "んんぅっ♡♡",
        "はあぁっ♡♡",
        "ふぁぁっ♡",
        "あやぁっ♡♡",
        "くあぁっ♡",
        "ひぁぁっ♡♡",
        "やんっ♡♡",
        "んはあっ♡♡",
        "あふぁっ♡",
        "はひぁっ♡♡",
        "ふんあっ♡♡",
        "ひやぁっ♡♡",
        "あくぅっ♡♡",
        "やひぁっ♡",
        "んあっ♡♡",
        "くひゃっ♡♡",
        "はあんっ♡♡",
        "あぁんっ♡♡",
        "ふひぁっ♡♡",
        "ひんあっ♡♡",
        "やあんっ♡♡",
        "んやぁっ♡♡",
        "あはぁっ♡♡",
        "くんあっ♡♡",
        "はふぁっ♡♡",
        "ふやぁっ♡♡",
        "ひあぁっ♡♡",
        "あぁひっ♡",
        "やくぅっ♡♡",
        "んふあっ♡♡",
        "はやぁっ♡♡",
        "くあんっ♡♡",
        "ふあんっ♡♡",
        "ひゃんっ♡♡",
        "あんはっ♡♡",
        "やふぁっ♡♡",
        "んひあっ♡♡",
        "はくぅっ♡♡",
        "あやんっ♡♡",
        "ふひゃっ♡♡",
        "くやぁっ♡♡",
        "ひはぁっ♡♡",
        "やあぁん♡♡",
        "んあはっ♡♡",
        "あふぅっ♡♡",
        "はひゃっ♡♡",
        "くふあっ♡♡",
        "ふんはっ♡♡",
        "ひやんっ♡♡",
        "あんくっ♡♡",
        "やひゃっ♡♡",
        "んくあっ♡♡",
        "はあひっ♡♡",
        "あひゃっ♡♡",
        "くんはっ♡♡",
        "ふあひっ♡♡",
        "ひくあっ♡♡",
        "やんはっ♡♡",
        "んあやっ♡♡",
        "はんあっ♡♡",
        "あぁふっ♡♡",
        "くひあっ♡♡",
        "ふやんっ♡♡",
        "ひあんっ♡♡",
        "やぁふっ♡♡",
        "んはやっ♡♡",
        "あくんっ♡♡",
    ],

    # Intensity 4: 激しい・理性崩壊（濁点、♡♡）
    4: [
        "あ゛あっ♡♡",
        "お゛っ♡♡",
        "ひぎぃっ♡♡",
        "ん゛っ♡♡",
        "あ゛っ♡♡",
        "ぐぅっ♡♡",
        "お゛ぉっ♡♡",
        "ひぎっ♡♡",
        "あ゛ぁっ♡♡",
        "ん゛んっ♡♡",
        "ぐっ♡♡",
        "お゛ほっ♡♡",
        "ひぎぃ♡♡",
        "あ゛はっ♡♡",
        "ん゛ぁっ♡♡",
        "ぐぅぅっ♡♡",
        "お゛あっ♡♡",
        "ひぎぃん♡♡",
        "あ゛んっ♡♡",
        "ん゛はっ♡♡",
        "ぐあっ♡♡",
        "お゛ぅっ♡♡",
        "ひぎゃっ♡♡",
        "あ゛ぅっ♡♡",
        "ん゛ふっ♡♡",
        "ぐひっ♡♡",
        "お゛おっ♡♡",
        "ひぎあっ♡♡",
        "あ゛あぁっ♡♡",
        "ん゛くっ♡♡",
        "ぐうっ♡♡",
        "お゛ひぃ♡♡",
        "ひぎぃぃ♡♡",
        "あ゛ひっ♡♡",
        "ん゛あっ♡♡",
        "ぐぅんっ♡♡",
        "お゛ぉぉ♡♡",
        "ひぎゅっ♡♡",
        "あ゛ふっ♡♡",
        "ん゛おっ♡♡",
        "ぐあぁっ♡♡",
        "お゛くっ♡♡",
        "ひぎんっ♡♡",
        "あ゛あんっ♡♡",
        "ん゛ひっ♡♡",
        "ぐぅあっ♡♡",
        "お゛はっ♡♡",
        "ひぎはっ♡♡",
        "あ゛ぁぁ♡♡",
        "ん゛ぅんっ♡♡",
        "ぐふっ♡♡",
        "お゛んっ♡♡",
        "ひぎふっ♡♡",
        "あ゛おっ♡♡",
        "ん゛やっ♡♡",
        "ぐはっ♡♡",
        "お゛ぁっ♡♡",
        "ひぎぁっ♡♡",
        "あ゛やっ♡♡",
        "ん゛ぁぁっ♡♡",
        "ぐんっ♡♡",
        "お゛ふっ♡♡",
        "ひぎくっ♡♡",
        "あ゛くっ♡♡",
        "ん゛ぐっ♡♡",
        "ぐぅひっ♡♡",
        "お゛ひっ♡♡",
        "ひぎぃぁ♡♡",
        "あ゛ぐっ♡♡",
        "ん゛あぁっ♡♡",
        "ぐぅぁっ♡♡",
    ],

    # Intensity 5: 絶頂・汚喘ぎ（♡♡♡、崩壊発声）
    5: [
        "いぐぅっ♡♡♡",
        "あ゛あ゛あ゛っ♡♡",
        "お゛ほぉっ♡♡♡",
        "ひぎぃぃっ♡♡♡",
        "ぐぅ゛っ♡♡♡",
        "い゛っ♡♡♡",
        "あ゛あ゛っ♡♡♡",
        "お゛ほっ♡♡♡",
        "いぐっ♡♡♡",
        "ひぎぃぁっ♡♡♡",
        "ぐぅ゛ぅっ♡♡♡",
        "い゛ぐっ♡♡♡",
        "あ゛あ゛ぁっ♡♡♡",
        "お゛ほぉぉ♡♡♡",
        "ひぎぃんっ♡♡♡",
        "いぐぅぅっ♡♡♡",
        "ぐぅ゛あっ♡♡♡",
        "い゛い゛っ♡♡♡",
        "あ゛あ゛んっ♡♡♡",
        "お゛ほぅっ♡♡♡",
        "ひぎゃあっ♡♡♡",
        "いぐんっ♡♡♡",
        "ぐぅ゛ぅぅ♡♡♡",
        "い゛くっ♡♡♡",
        "あ゛あ゛はっ♡♡♡",
        "お゛ほぉんっ♡♡♡",
        "ひぎぃぃぃ♡♡♡",
        "いぐぅんっ♡♡♡",
        "ぐぅ゛んっ♡♡♡",
        "い゛ぃっ♡♡♡",
        "あ゛あ゛ふっ♡♡♡",
        "お゛ほぁっ♡♡♡",
        "ひぎゅぅっ♡♡♡",
        "いぐあっ♡♡♡",
        "ぐぅ゛はっ♡♡♡",
        "い゛あっ♡♡♡",
        "あ゛あ゛ぅっ♡♡♡",
        "お゛ほひっ♡♡♡",
        "ひぎあぁっ♡♡♡",
        "いぐひっ♡♡♡",
        "ぐぅ゛ひっ♡♡♡",
        "い゛ぁっ♡♡♡",
        "あ゛あ゛くっ♡♡♡",
        "お゛ほぉぁ♡♡♡",
        "ひぎふぅっ♡♡♡",
        "いぐふっ♡♡♡",
        "ぐぅ゛ふっ♡♡♡",
        "い゛んっ♡♡♡",
        "あ゛あ゛おっ♡♡♡",
        "お゛ほぉっん♡♡♡",
        "ひぎぃはっ♡♡♡",
        "いぐぅはっ♡♡♡",
        "ぐぅ゛おっ♡♡♡",
        "い゛ひっ♡♡♡",
        "あ゛あ゛ひっ♡♡♡",
        "お゛ほぅぅ♡♡♡",
        "ひぎぃくっ♡♡♡",
        "いぐぅぁっ♡♡♡",
        "ぐぅ゛ぁっ♡♡♡",
        "い゛ふっ♡♡♡",
        "あ゛あ゛やっ♡♡♡",
        "お゛ほくっ♡♡♡",
        "ひぎぃおっ♡♡♡",
        "いぐやっ♡♡♡",
        "ぐぅ゛やっ♡♡♡",
        "い゛くぅっ♡♡♡",
        "あ゛あ゛ぁぁ♡♡♡",
        "お゛ほぉはっ♡♡♡",
        "ひぎぃふっ♡♡♡",
        "いぐぅおっ♡♡♡",
        "ぐぅ゛くっ♡♡♡",
        "い゛ぐぅっ♡♡♡",
        "あ゛あ゛ぐっ♡♡♡",
        "お゛ほんっ♡♡♡",
        "ひぎぃやっ♡♡♡",
        "いぐくっ♡♡♡",
        "ぐぅ゛ぅんっ♡♡♡",
        "い゛はっ♡♡♡",
        "あ゛あ゛あ゛ぁ♡♡♡",
        "お゛ほぉぅっ♡♡♡",
    ],
}


# ============================================================================
# 女性セリフプール（状況別）
# ============================================================================
SPEECH_FEMALE_POOL = {
    # denial: 否定・抵抗
    "denial": [
        "やだ…",
        "だめ…",
        "いや…っ",
        "むり…",
        "やめ…",
        "離して…",
        "やめて…",
        "触んないで",
        "いやっ…",
        "だめっ…",
        "嫌…っ",
        "やだぁ…",
        "やめてよ…",
        "やだってば",
        "さわらないで",
        "だめだって…",
        "無理だよ…",
        "いやぁっ…",
        "来ないで…",
        "放して…",
        "嫌だってば",
        "やめろ…",
        "だめぇ…",
        "入れないで…",
        "そこはだめ…",
        "やだやだ…",
        "ほんとやめて",
        "近寄らないで",
        "いやだ…",
        "なにすんの",
        "やめなさい…",
        "しないで…",
        "ひどい…",
        "こわい…",
        "痛い…っ",
        "いたい…",
        "何するの…",
        "やめてって…",
        "嘘でしょ…",
        "信じらんない",
        "ありえない…",
        "最低…",
        "無理無理…",
        "やだよぉ…",
        "いやなの…",
        "だめだってば",
        "そこだめ…っ",
        "こないで…",
        "嫌なの…っ",
        "なんで…っ",
    ],

    # embarrassed: 恥ずかしい
    "embarrassed": [
        "見ないで…",
        "はずかし…",
        "そこ…だめ…",
        "見ちゃだめ…",
        "やだ…見える",
        "恥ずかしぃ…",
        "えっちだよ…",
        "こんなの…",
        "声…出ちゃう",
        "聞かないで…",
        "言わないで…",
        "そんな目で…",
        "みないでよぉ",
        "はずかしい…",
        "変な声…出る",
        "そこ…やだ…",
        "濡れてない…",
        "感じてないし",
        "そんなとこ…",
        "見えちゃう…",
        "恥ずかし…",
        "変態…",
        "あつい…",
        "聞こえちゃう",
        "顔…見ないで",
        "どこ見てるの",
        "だめ…そこぉ",
        "やだ…変な音",
        "え…なにこれ",
        "顔あつい…",
        "声やばい…",
        "こんなかっこ",
        "自分で見えて",
        "ばか…えっち",
        "音…やだ…",
        "そこ見ないで",
        "なに見てるの",
        "やだ…声が…",
        "照れるから…",
        "はずかしぃ…",
        "体あつい…",
        "こんな姿…",
        "恥ずかしすぎ",
        "変態さん…",
        "エッチ…",
        "やだ…顔熱い",
        "見すぎ…",
        "声出さないで",
        "目…そらして",
        "電気消して…",
    ],

    # plea: 懇願
    "plea": [
        "お願い…",
        "許して…",
        "もう許して♡",
        "もうだめ…",
        "もう無理…",
        "たすけて…",
        "お願い…♡",
        "許して…♡",
        "もうやだ…♡",
        "やすませて…",
        "休んで…♡",
        "まって…♡",
        "おねがい…♡",
        "これ以上は…",
        "勘弁して…",
        "もう限界…♡",
        "壊れちゃう♡",
        "頭おかしくなる",
        "頭…まわらない",
        "もうむり…♡",
        "ゆるして…♡",
        "待って…♡",
        "ちょっと待って",
        "やすんで…♡",
        "時間ちょうだい",
        "息できない…",
        "体もたない…",
        "もう耐えらん",
        "限界なの…♡",
        "腰…もう…",
        "足閉じさせて",
        "死んじゃう…",
        "ほんとに無理",
        "もうゆるして",
        "少し休ませて",
        "一回やめて…",
        "体おかしい…",
        "溶けちゃう♡",
        "頭ぐるぐる…",
        "ダメになる♡",
        "感覚やばい…",
        "もう立てない",
        "体ぴくぴく…",
        "意識とぶ…♡",
        "これ以上むり",
        "腰くだける…",
        "力はいらない",
        "もうだめぇ♡",
        "お願いだから",
        "壊れちゃうよ",
    ],

    # acceptance: 受容・快楽
    "acceptance": [
        "いい…♡",
        "もっと…♡",
        "すき…♡",
        "きもちぃ…♡",
        "すごい…♡",
        "奥…いい♡",
        "気持ちいい♡",
        "そこぉ…♡",
        "もっとして♡",
        "ほしい…♡",
        "いいよ…♡",
        "中…いい♡",
        "好き…♡♡",
        "やばい…♡",
        "入ってる…♡",
        "あったかい♡",
        "すきぃ…♡",
        "奥まで…♡",
        "全部ほしい♡",
        "抱いて…♡",
        "離さないで♡",
        "もっと奥…♡",
        "いっぱい…♡",
        "大きい…♡",
        "触って…♡",
        "きて…♡",
        "ちょうだい♡",
        "もっと強く♡",
        "そこ…いい♡",
        "このまま…♡",
        "ぜんぶ…♡",
        "だいすき…♡",
        "中あったかい",
        "動いて…♡",
        "深い…♡",
        "感じる…♡",
        "いい…もっと",
        "幸せ…♡♡",
        "つながってる",
        "ぎゅってして♡",
        "奥に当たる♡",
        "抱きしめて♡",
        "キスして…♡",
        "嬉しい…♡",
        "ずっとこのまま",
        "好きすぎる♡",
        "最高…♡",
        "溶ける…♡",
        "もっと深く♡",
        "ぴったり…♡",
    ],

    # ecstasy: 快楽絶頂
    "ecstasy": [
        "イっちゃう♡",
        "もうだめ♡♡",
        "おかしくなる",
        "イく…♡♡",
        "イっちゃ♡♡",
        "とんじゃう♡",
        "しんじゃう♡",
        "だめ…イく♡",
        "もうイく♡♡",
        "イきたい…♡",
        "頭とぶ…♡♡",
        "何も考えらん",
        "止まんない♡",
        "またイく♡♡",
        "連続でイく♡",
        "やば…イく♡",
        "壊れる…♡♡",
        "もう何回目…",
        "イっちゃった",
        "だめイっちゃ",
        "おかしい…♡",
        "あっイく…♡",
        "イくイく♡♡",
        "やだイっちゃ",
        "イきそう…♡",
        "また…イく♡",
        "奥でイく♡♡",
        "中でイく…♡",
        "だめもうイく",
        "頭まっしろ♡",
        "なにもみえない",
        "意識とぶ♡♡",
        "ぶっとぶ…♡",
        "すごいイく♡",
        "全身びくびく",
        "腰とまんない",
        "ぐちゃぐちゃ",
        "もうわかんない",
        "おかしくなっちゃ",
        "体ビクビク♡",
        "とまんない♡",
        "目の前真っ白",
        "何回イった…",
        "また…きちゃう",
        "だめ…きちゃう",
        "イった…♡♡",
        "こわれちゃう",
        "ああイく♡♡",
        "びくっ…♡♡",
        "やだまたイく",
    ],

    # post: 事後
    "post": [
        "はぁ…はぁ…",
        "もう…むり…",
        "すごかった…",
        "まだ…ドキドキ",
        "動けない…",
        "足…がくがく",
        "ふぅ…♡",
        "びっくりした",
        "もう…ばか…",
        "中…あつい…",
        "抜かないで…",
        "幸せ…♡",
        "とろけた…♡",
        "力…入んない",
        "ぼーっとする",
        "頭ふわふわ…",
        "まだびくびく",
        "疲れた…♡",
        "気持ちよかった",
        "すごかった♡",
        "またしたい…",
        "もうむり…",
        "腰が…♡",
        "意識飛んでた",
        "何回イったの",
        "夢みたい…♡",
        "まだ震えてる",
        "体あつい…♡",
        "ぐったり…♡",
        "余韻…すごい",
        "立てない…♡",
        "目がとろとろ",
        "大好きだよ♡",
        "このままいたい",
        "もう一回…♡",
        "あったかい…",
        "まだ感じてる",
        "体とろとろ…",
        "ちょっと休憩…",
        "出てきてる…",
    ],

    # provoke: 挑発・煽り
    "provoke": [
        "できるの？",
        "もう終わり？",
        "それだけ？",
        "足りない♡",
        "かかってきて",
        "遅い♡",
        "もっとできる？",
        "全然平気♡",
        "こんなもの？",
        "つまんない♡",
        "物足りない♡",
        "まだまだ♡",
        "弱いなぁ♡",
        "へたくそ♡",
        "もっと激しく",
        "その程度？",
        "本気出して♡",
        "元気ないね♡",
        "全然足りない",
        "もっとできるよ",
        "まだいけるよ♡",
        "手加減してる？",
        "余裕だよ♡",
        "ぜんぜん♡",
        "こっちおいで♡",
        "逃げないで♡",
        "捕まえて♡",
        "ほらもっと♡",
        "早くして♡",
        "焦らさないで",
        "待ちきれない",
        "ほしくないの？",
        "怖いの？♡",
        "ほら…おいで",
        "欲しいんでしょ",
        "ねぇまだ？♡",
        "もう降参？♡",
        "だらしないね",
        "限界？♡",
        "ざーこ♡",
    ],

    # submissive: 従順・奉仕
    "submissive": [
        "なんでもします",
        "ご主人様…♡",
        "使って…♡",
        "言う通りに…",
        "お好きに…♡",
        "従います…♡",
        "命令して…♡",
        "ご奉仕します",
        "好きにして♡",
        "はい…♡",
        "わかりました♡",
        "あなたのもの♡",
        "逆らわない♡",
        "なんでもする♡",
        "全部あげる♡",
        "捧げます…♡",
        "犬になります",
        "飼って…♡",
        "どうぞ…♡",
        "されるがまま♡",
        "言うこと聞く♡",
        "壊していいよ♡",
        "お仕置きして",
        "もっと虐めて♡",
        "褒めて…♡",
        "頑張ります♡",
        "ぺろぺろ…♡",
        "舐めていい？♡",
        "味…します♡",
        "奉仕するね♡",
        "もっと汚して♡",
        "マーキングして",
        "印つけて…♡",
        "独占して…♡",
        "所有して…♡",
        "体…全部…♡",
        "おねだり…♡",
        "ください…♡",
        "服従します♡",
        "忠誠…♡♡",
    ],
}


# ============================================================================
# 心の声プール（テーマ別）
# ============================================================================
THOUGHT_POOL = {
    # general: 汎用（70エントリー - 先頭2文字の偏りを最小化）
    "general": [
        "やば…",
        "なにこれ…",
        "おかしい…",
        "頭…真っ白…",
        "嘘でしょ…",
        "うそ…でしょ…",
        "からだが…",
        "止まらない…",
        "変になる…",
        "どしよ…",
        "感じすぎ…",
        "こんなの初めて",
        "声…出ちゃう",
        "やばいやばい",
        "もうだめかも",
        "なんで…",
        "こわい…",
        "あたまが…",
        "理性が…",
        "意識が…",
        "知らない…",
        "嫌なのに…",
        "体が勝手に…",
        "なにも…わかんない",
        "ぐちゃぐちゃ",
        "溶ける…",
        "力が…抜ける",
        "目の前が…",
        "お腹の奥が…",
        "全身…びりびり",
        "何されてるの",
        "わからない…",
        "息ができない",
        "頭がぼーっと",
        "足の力が…",
        "聞こえてる…",
        "目が…回る…",
        "熱い…中が…",
        "ふるえ…てる",
        "思考が…飛ぶ",
        "深い…奥まで",
        "指先が痺れて",
        "心臓…早い…",
        "声が…勝手に",
        "あつい…からだ",
        "頭がくらくら",
        "背中がぞくっ",
        "うそ…これ…",
        "呼吸が…乱れ",
        "限界…近い…",
        # v3.5追加: 多様な先頭パターン（だめ/やだ以外）
        "こんな声…",
        "腰が…勝手に",
        "とまんない…",
        "ぞくぞくする…",
        "奥…響いてる",
        "もう…わかんない",
        "頭ぐるぐる…",
        "びくってした…",
        "ぴくぴくする…",
        "あたし…変…",
        "なんか…へん…",
        "ずっと…ずっと…",
        "ここ…弱い…",
        "指が…震えて…",
        "視界が…ぼやけ",
        "耳…きこえない",
        "脳みそ…とけ…",
        "体…言うこと…",
        "膝…がくがく…",
        "お腹…きゅって…",
        "つま先まで…",
    ],

    # forced: 強制・暴行テーマ専用
    "forced": [
        "やめて…",
        "離して…",
        "いたい…のに…",
        "なんで…あたし…",
        "たすけて…",
        "こんなの…嫌…",
        "体が…裏切る",
        "やだ…感じて…",
        "抵抗できない…",
        "力が…入らない",
        "逃げたいのに…",
        "怖い…でも…",
        "声…出さない…",
        "誰か…たすけ…",
        "嫌なのに体が…",
        "頭は拒否…でも",
        "涙…止まらない",
        "動けない…",
        "こんな場所で…",
        "屈辱的…",
        "なのに腰が…",
        "悔しい…",
        "こんな奴に…",
        "惨めだ…",
        "なんで反応…",
        "勝手に濡れて…",
        "心は拒否してる",
        "もう…耐えられ",
        "体だけ…勝手に",
        "やだ…やだよ…",
    ],

    # ntr: NTR・寝取られ
    "ntr": [
        "彼より…",
        "もう…戻れない",
        "ごめん…",
        "彼氏に…",
        "ごめんね…",
        "嫌いなのに…",
        "こんな男に…",
        "負けてる…",
        "彼を裏切って",
        "最低だ…私",
        "バレたら…",
        "でも止めらん",
        "比べちゃだめ",
        "彼で満足…",
        "嘘…こっちが",
        "こんな体に…",
        "彼の前では…",
        "知られたら…",
        "もう彼には…",
        "浮気…してる",
        "私…最低…",
        "全然違う…",
        "慣れちゃった",
        "彼じゃだめ…",
        "ごめん…好き",
        "体が覚えてる",
        "彼に申し訳…",
        "ほんとは嫌…",
        "なのに体が…",
        "待ってる人が",
        "彼の顔が浮ぶ",
        "忘れたい…",
        "裏切り者だ…",
        "帰りたい…",
        "でも…気持ち…",
        "約束したのに",
        "上書きされる",
        "もう嘘つけない",
        "彼には見せれ",
        "この体…汚い",
        "なのに求めて",
        "どっちが本当",
        "元に戻れない",
        "秘密が増える",
        "彼より深く…",
        "合わせる顔が",
        "染まっていく",
        "隠し通せない",
        "もう正妻面…",
        "消えない記憶",
    ],

    # vanilla: 純愛
    "vanilla": [
        "好き…",
        "幸せ…",
        "ずっと一緒…",
        "大好き…",
        "嬉しい…",
        "あったかい…",
        "繋がってる…",
        "いかないで…",
        "愛してる…",
        "もっと近くに",
        "夢みたい…",
        "安心する…",
        "胸がいっぱい",
        "溶けちゃう…",
        "もっとほしい",
        "ずっとこのまま",
        "心もとろける",
        "一つになれた",
        "きゅんとする",
        "宝物みたい",
        "触れてほしい",
        "包まれてる…",
        "あなたの匂い",
        "心が満たされ",
        "世界で一番…",
        "居場所がある",
        "温もりが好き",
        "ここが安全…",
        "全部あげたい",
        "二人だけの…",
        "時間止まって",
        "もっと深く…",
        "声聞きたい…",
        "名前呼んで…",
        "涙が出そう…",
        "抱きしめたい",
        "この人だけ…",
        "心まで触れて",
        "唇が離せない",
        "鼓動が伝わる",
        "ぜんぶ受け止",
        "ずっと感じて",
        "甘い匂い…",
        "一緒に…いたい",
        "守ってくれる",
        "同じ気持ち…",
        "特別な夜…",
        "最高に幸せ",
        "ここにいたい",
        "想いが溢れる",
    ],

    # corruption: 堕落・快楽落ち
    "corruption": [
        "もう…壊れる",
        "従いたい…",
        "もっと欲しい",
        "堕ちてく…",
        "快楽に…負けた",
        "もう…だめ…",
        "頭おかしく…",
        "体が…求めてる",
        "欲しくて…",
        "壊されたい…",
        "もう…どうでも",
        "何でもする…",
        "支配されたい",
        "私…変態…",
        "止められない",
        "もっとください",
        "依存してる…",
        "逆らえない…",
        "言いなりに…",
        "ご主人様…",
        "お願い…もっと",
        "壊して…",
        "体だけじゃない",
        "心も…堕ちた",
        "もう普通に…",
        "快楽しか…",
        "脳が溶けて…",
        "自分じゃない",
        "理性なんか…",
        "恥も捨てた…",
        "おかしくなる",
        "もう獣みたい",
        "思考が消える",
        "人でなくなる",
        "こんな姿…",
        "もっと壊して",
        "戻りたくない",
        "全部…どうでも",
        "中毒になった",
        "考えるのやめ",
        "抵抗…無意味",
        "最低…でも好き",
        "何回でも…",
        "飼われたい…",
        "どこまで堕ち",
        "快感が正義…",
        "プライドなんか",
        "溺れていたい",
        "帰れなくなる",
        "もう…家畜…",
    ],

    # reluctant: 不本意な感覚
    "reluctant": [
        "嫌なはず…",
        "なんで感じて",
        "認めたくない",
        "こんなの嫌…",
        "体が裏切る…",
        "抵抗してるの",
        "拒否したいの",
        "感じちゃだめ",
        "嫌いなのに体",
        "望んでない…",
        "受け入れない",
        "でも…熱い…",
        "気持ちよくない",
        "嘘…反応して",
        "本心じゃない",
        "頭は拒否して",
        "屈しない…",
        "心は嫌がって",
        "嫌…でも体が",
        "泣きたい…",
        "なのに腰が…",
        "悔しい…",
        "こんな反応…",
        "感じるなんて",
        "勝手に声が…",
        "許せない…体",
        "否定したいの",
        "惨めだ…",
        "誰かのせいで",
        "嫌だ…好きに",
        "心が追いつか",
        "なぜ濡れて…",
        "嘘よ…こんな",
        "腰が勝手に…",
        "拒絶してるの",
        "意思と反対に",
        "涙が止まらな",
        "こんな体嫌…",
        "負けたくない",
        "でも…声が…",
    ],
}


# ============================================================================
# 男性セリフプール（タイプ別）
# ============================================================================
SPEECH_MALE_POOL = {
    # command: 命令・支配
    "command": [
        "逃がさねぇよ",
        "おとなしくしろ",
        "脱げ",
        "見せろ",
        "開け",
        "動くな",
        "声出せ",
        "こっち向け",
        "逆らうな",
        "黙ってろ",
        "力抜け",
        "受け入れろ",
        "泣いても無駄",
        "四つん這いだ",
        "もっと開けろ",
        "逃げんなよ",
        "咥えろ",
        "舐めろ",
        "言う通りにしろ",
        "腰振れよ",
        "顔上げろ",
        "こっち来い",
        "立つな",
        "寝転がれ",
        "足開け",
        "奥まで入れろ",
        "離すなよ",
        "自分でやれ",
        "見ろよ",
        "止まんな",
        "耐えろ",
        "跨がれ",
        "飲み込め",
        "触るな",
        "声我慢すんな",
        "そのまま動け",
        "全部出せ",
        "顔見せろ",
        "両手上げろ",
        "俺だけ見ろ",
    ],

    # dirty: 言葉責め
    "dirty": [
        "感じてんだろ",
        "すげえ締まる",
        "もう濡れてる",
        "いい声だな",
        "もう我慢すんな",
        "正直になれよ",
        "ここ好きだろ",
        "すげえ顔",
        "とろとろだな",
        "感じやすいな",
        "もうイきそうか",
        "欲しいんだろ",
        "締めんなよ",
        "何回目だ？",
        "名前呼んでみろ",
        "だらしねえな",
        "たまんねえ",
        "すげえ吸いつく",
        "腰引くなよ",
        "もう戻れねえな",
        "中で感じてる",
        "いい反応だな",
        "かわいい顔",
        "ぐちょぐちょだ",
        "堕ちたな",
        "もう慣れたか",
        "自分から腰振っ",
        "素直になったな",
        "体は正直だな",
        "エロい体だな",
        "もうトロトロだ",
        "顔真っ赤だぞ",
        "相当好きだろ",
        "口でも感じる",
        "どこが一番？",
        "奥当たってる",
        "中びくびくだ",
        "声漏れてるぞ",
        "もっと鳴けよ",
        "ほら自分で言え",
    ],

    # gentle: 優しめ
    "gentle": [
        "気持ちいい？",
        "もっと聞かせて",
        "大丈夫だよ",
        "可愛いよ",
        "力抜いて",
        "ゆっくりでいい",
        "好きだよ",
        "痛くない？",
        "もう少しだけ",
        "綺麗だよ",
        "任せて",
        "離さないよ",
        "感じてくれた？",
        "もっとしたい",
        "愛してるよ",
        "怖くないよ",
        "無理しないで",
        "ここにいるよ",
        "そのままでいい",
        "俺を見て",
        "一緒にいこう",
        "泣いてもいいぞ",
        "嫌なら言えよ",
        "抱きしめるぞ",
        "ずっと一緒だ",
        "声聞かせろ",
        "近くに来い",
        "全部受け止める",
        "安心しろ",
        "目閉じていい",
        "いい子だな",
        "ゆっくりでいい",
        "温かいな",
        "触るぞ",
        "このままだ",
        "そばにいるぞ",
        "幸せにする",
        "お前だけだ",
        "何度でもいい",
        "ぎゅっとしろ",
    ],

    # praise: 褒め・称賛
    "praise": [
        "最高だよ",
        "いい子だな",
        "かわいすぎる",
        "敏感だな",
        "たまらない",
        "すごいよ",
        "上手だな",
        "えらいな",
        "よく耐えたな",
        "素直でいい",
        "最高の体だ",
        "いい声だよ",
        "よくできたな",
        "天才かよ",
        "本当に綺麗だ",
        "たまらん顔だ",
        "いい表情だ",
        "完璧だよ",
        "極上だな",
        "最高の反応",
        "かわいい奴だ",
        "よく頑張った",
        "ご褒美だな",
        "もっと見せて",
        "いい身体だな",
        "ほんと好きだ",
        "凄くいいぞ",
        "堪能させろよ",
        "えろすぎるよ",
        "反応いいな",
        "才能あるな",
        "もう最高かよ",
        "愛おしいよ",
        "素晴らしい",
        "こんな子初めて",
    ],
}


# ============================================================================
# 中立セリフプール（非エロシーン用・文脈保護）
# ============================================================================
NEUTRAL_POOL = {
    "female": [
        "うん…", "ん…", "え…", "あ、はい", "そう…", "ふぅ…", "えっと…",
        "あの…", "なんだろ", "そっか…", "わかった", "ありがと", "大丈夫…",
        "そうなんだ", "ここ…?", "静かだね", "きれい…", "落ち着く…",
        "不思議…", "怖い…", "緊張する", "どうしよ", "変な感じ",
        "なにか…", "待って…",
    ],
    "male": [
        "ああ", "そうか", "来い", "行くぞ", "どうした", "ほら", "こっちだ",
        "座れ", "待ってろ", "黙れ", "いいから", "聞けよ", "わかった",
        "問題ない", "さあな", "ついて来い", "落ち着け", "心配すんな",
        "急ぐぞ", "見てろ", "準備しろ", "ったく", "やれやれ", "おい",
        "へえ",
    ],
}


# ============================================================================
# 事後セリフプール（aftermath用）
# ============================================================================
AFTERMATH_POOL = {
    "female": [
        "もう…むり", "動けない…", "ぼーっと…", "からだ重い…", "震えてる…",
        "夢みたい…", "ごめん…", "なにこれ…", "頭まっしろ", "力入んない",
        "息できない", "涙が…", "どしよ…", "戻れない…", "ふわふわ…",
        "全身痺れて", "立てない…", "声出ない…", "意識が…", "熱い…",
        "汗すごい…", "まだ震えて", "ぐったり…", "目が回る", "指先痺れ",
    ],
    "male": [
        "もういいぞ", "帰れ", "次もな", "よくやった", "最高だった",
        "片付けろ", "寝てろ", "まだ終わり", "覚えとけ", "また来るぞ",
        "おとなしくしろ", "じゃあな", "疲れたろ", "もう朝だぞ", "起きろ",
        "ったく", "もう一発", "休憩だ", "水飲め", "立てるか",
        "まだだ", "逃がさねえ", "おい起きろ", "終わりだ", "さっさと",
    ],
}


# ============================================================================
# ユーティリティ関数
# ============================================================================

def pick_replacement(pool_list: list, used_set: set, normalize_fn=None,
                     max_len: int = 10) -> str:
    """プールからused_setに含まれない未使用エントリーをランダムに選択。
    normalize_fnがあれば正規化後の値でも重複判定する。
    max_len: 文字数上限（デフォルト10、CG集吹き出し制限）"""
    if normalize_fn:
        used_normalized = {normalize_fn(t) for t in used_set}
        candidates = [t for t in pool_list
                      if t not in used_set
                      and normalize_fn(t) not in used_normalized
                      and len(t) <= max_len]
    else:
        candidates = [t for t in pool_list
                      if t not in used_set
                      and len(t) <= max_len]
    if candidates:
        return random.choice(candidates)
    # max_len制限を緩和して再試行
    if normalize_fn:
        candidates = [t for t in pool_list if t not in used_set and normalize_fn(t) not in used_normalized]
    else:
        candidates = [t for t in pool_list if t not in used_set]
    if candidates:
        return random.choice(candidates)
    # 全て使用済みなら、バリエーション生成で重複回避
    if pool_list:
        base = random.choice(pool_list)
        _VARIANTS = ["♡", "…♡", "っ♡", "…", "♡♡"]
        for v in _VARIANTS:
            candidate = base.rstrip("♡…っ。") + v
            if candidate not in used_set and (not normalize_fn or normalize_fn(candidate) not in used_normalized):
                return candidate
        return base  # 最終手段: バリエーション不可なら元を返す
    return ""


def get_moan_pool(intensity: int, expand: bool = True) -> list:
    """intensity(1-5)に応じた喘ぎ声プールを返す。
    expand=Trueの場合、隣接intensityからも補充して枯渇を防ぐ"""
    i = max(1, min(5, intensity))
    pool = list(MOAN_POOL.get(i, MOAN_POOL[3]))
    if expand:
        # 隣接intensityから補充（±1）。本来のintensityが先に来るよう順序維持
        if i + 1 <= 5:
            pool.extend(MOAN_POOL.get(i + 1, []))
        if i - 1 >= 1:
            pool.extend(MOAN_POOL.get(i - 1, []))
    return pool


def get_speech_pool(bubble_type: str, theme: str = "", intensity: int = 3) -> list:
    """タイプとテーマに応じたセリフプールを返す"""
    theme_lower = theme.lower() if theme else ""
    is_forced = any(k in theme_lower for k in ["forced", "陵辱", "レイプ", "reluctant", "暴行", "強制"])

    if bubble_type == "thought":
        if "ntr" in theme_lower or "寝取" in theme:
            return THOUGHT_POOL["ntr"]
        elif is_forced:
            # forced: 専用プール + reluctantの混合で幅を持たせる
            pool = list(THOUGHT_POOL.get("forced", []))
            pool.extend(THOUGHT_POOL["reluctant"])
            return pool
        elif "純愛" in theme or "vanilla" in theme_lower:
            return THOUGHT_POOL["vanilla"]
        elif "堕落" in theme or "催眠" in theme or "調教" in theme or "corruption" in theme_lower:
            return THOUGHT_POOL["corruption"]
        elif "嫌" in theme or "無理" in theme or "抵抗" in theme:
            return THOUGHT_POOL["reluctant"]
        return THOUGHT_POOL["general"]
    elif bubble_type == "speech":
        pool = []
        if is_forced:
            # 暴行/強制テーマ: 合意セリフ(acceptance/ecstasy)は使わない
            pool.extend(SPEECH_FEMALE_POOL.get("denial", []))
            pool.extend(SPEECH_FEMALE_POOL.get("embarrassed", []))
            if intensity >= 4:
                pool.extend(SPEECH_FEMALE_POOL.get("plea", []))
            return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
        # 通常テーマ: intensity連動で適切なカテゴリを選択
        if intensity <= 2:
            pool.extend(SPEECH_FEMALE_POOL.get("denial", []))
            pool.extend(SPEECH_FEMALE_POOL.get("embarrassed", []))
        elif intensity == 3:
            pool.extend(SPEECH_FEMALE_POOL.get("plea", []))
            pool.extend(SPEECH_FEMALE_POOL.get("acceptance", []))
            pool.extend(SPEECH_FEMALE_POOL.get("embarrassed", []))
        elif intensity == 4:
            pool.extend(SPEECH_FEMALE_POOL.get("acceptance", []))
            pool.extend(SPEECH_FEMALE_POOL.get("plea", []))
            pool.extend(SPEECH_FEMALE_POOL.get("ecstasy", []))
        else:
            pool.extend(SPEECH_FEMALE_POOL.get("ecstasy", []))
            pool.extend(SPEECH_FEMALE_POOL.get("submissive", []))
            pool.extend(SPEECH_FEMALE_POOL.get("plea", []))
        return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
    return []


def get_male_speech_pool_for_theme(theme: str = "", intensity: int = 3) -> list:
    """テーマとintensityに応じた男性セリフプールを返す"""
    t = theme.lower() if theme else ""
    pool = []
    if any(k in t for k in ["ntr", "寝取", "夜這", "村", "レイプ", "陵辱", "調教", "奴隷"]):
        pool.extend(SPEECH_MALE_POOL.get("command", []))
        pool.extend(SPEECH_MALE_POOL.get("dirty", []))
    elif any(k in t for k in ["純愛", "ラブ", "恋人", "カップル"]):
        pool.extend(SPEECH_MALE_POOL.get("gentle", []))
        pool.extend(SPEECH_MALE_POOL.get("praise", []))
    else:
        if intensity >= 4:
            pool.extend(SPEECH_MALE_POOL.get("command", []))
            pool.extend(SPEECH_MALE_POOL.get("dirty", []))
        else:
            pool.extend(SPEECH_MALE_POOL.get("dirty", []))
            pool.extend(SPEECH_MALE_POOL.get("praise", []))
    return pool if pool else [v for sp in SPEECH_MALE_POOL.values() for v in sp]


def get_female_speech_pool(situation: str = "") -> list:
    """状況に応じた女性セリフプールを返す"""
    if situation in SPEECH_FEMALE_POOL:
        return SPEECH_FEMALE_POOL[situation]
    combined = []
    for pool in SPEECH_FEMALE_POOL.values():
        combined.extend(pool)
    return combined


def get_male_speech_pool(male_type: str = "") -> list:
    """タイプに応じた男性セリフプールを返す"""
    if male_type in SPEECH_MALE_POOL:
        return SPEECH_MALE_POOL[male_type]
    combined = []
    for pool in SPEECH_MALE_POOL.values():
        combined.extend(pool)
    return combined


# ============================================================================
# 男性セリフ短縮辞書（長文→8文字以内の命令形/断定形に変換）
# ============================================================================
MALE_SHORT_REPLACEMENTS = {
    # 描写的な長文 → 短い命令形/断定形
    "こんなに締まってんぞ": "締まるな",
    "こんなに締まって": "締まりすぎだ",
    "すごくいい…締まってる": "いい締まりだ",
    "こんな膣": "最高だ",
    "ずっと待ってたんだ": "待たせたな",
    "本当は感じてんだろ": "感じてんだろ",
    "本当はほしいんだろ": "欲しいんだろ",
    "勝手に動いてんぞ": "腰振ってんぞ",
    "抵抗できてねぇ": "無駄だよ",
    "抵抗できてない": "無駄だ",
    "我慢できなくなってんな": "もう無理だろ",
    "我慢できてねぇんだろ": "もう無理だろ",
    "身体が素直に反応してんな": "正直だな",
    "声漏れてんぞ": "声出てんぞ",
    "もう限界だな": "限界だな",
    "完全に堕ちちゃってるな": "堕ちたな",
    "逃げられねぇぞ": "逃がさねえ",
    "おくまでぐちゃぐちゃだ": "ぐちゃぐちゃだ",
    "もう隠すなよ": "隠すなよ",
    "全部出してやる": "全部出すぞ",
    "声出てんぞ…抵抗できてねぇ": "声出てんぞ",
    "声、我慢できなくなってんな": "もう無理だろ",
    "もう我慢できてねぇんだろ": "もう無理だろ",
    "おく…ぐちゃぐちゃになってんぞ": "ぐちゃぐちゃだ",
    "膣、こんなに締まってんぞ…最高だ": "締まるな",
    "腰が勝手に動いてんぞ…本当はほしいんだろ": "欲しいんだろ",
    "限界だな…もう堪えられてねぇ": "限界だろ",
    "もう限界だな…声漏れてんぞ": "漏れてんぞ",
    "いい顔になってんな": "いい顔だ",
    "もう逃げられねぇ": "逃がさねえ",
}


def shorten_male_speech(text: str, max_len: int = 15) -> str:
    """男性セリフを最大max_len文字に短縮する。
    1. MALE_SHORT_REPLACEMENTS辞書で既知の長文を変換
    2. それでも長ければ最初の句切り（…）までをカット
    3. max_len以下ならそのまま返す（強制切り詰めしない）
    """
    if len(text) <= max_len:
        return text

    # 辞書マッチ（部分一致: 長い方を優先）
    for long_form, short_form in sorted(MALE_SHORT_REPLACEMENTS.items(),
                                         key=lambda x: len(x[0]), reverse=True):
        if long_form in text:
            return short_form

    # …で区切って先頭部分のみ取得
    if "…" in text:
        first_part = text.split("…")[0]
        if 2 <= len(first_part) <= max_len:
            return first_part

    # 強制切り詰めはしない（意味が壊れるため）
    return text
