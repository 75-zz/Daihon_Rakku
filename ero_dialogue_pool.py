"""エロセリフプール v8.0: 重複置換用の大量セリフ辞書（CG集吹き出し用）

合計5500+エントリー + STORY_PATTERN_LIBRARY(46パターン/690 key_lines):
  MOAN_POOL: 5 intensity × 160 = 800（v8.0: 80→160に倍増、500シーン耐性）
  SPEECH_FEMALE_POOL: 44 categories = 1140
    v6.0: +first_time/nakadashi/water_scene/sleep_react/ojou_formal/fantasy_react/multi_partner
    v7.0: +oral_react 25 +afterglow 25 +teasing 25 +size_react 20
          +anger 20 +praise_react 20 +bondage_react 20
    v8.0: +paizuri_react 20 +anal_react 20 +footjob_react 15 +toy_react 20
          +fingering_react 20 +deepthroat_react 15 +cum_react 20 +multiple_orgasm 20
  THOUGHT_POOL: 32 categories = 781
    v6.0: +first_time_thought/water_thought/sleep_thought
    v7.0: +pleasure_denial 20 +addiction 20 +rage 15 +resignation 20
          +confusion 15 +guilt 20
    v8.0: +anal_thought 15 +toy_thought 15 +oral_thought 15 +orgasm_thought 20
          +sensitivity 15
  SPEECH_MALE_POOL: 23 categories = 525
    v6.0: +fantasy_hero/ojisan/doctor/delinquent
    v7.0: +teacher 20 +yakuza 20 +classmate 20 +stepfather 20
    v8.0: +anal 15 +foreplay 15 +cum_announce 15
  ONOMATOPOEIA_POOL: 22 categories = 504（v8.0: +footjob/paizuri/finger/grinding/toy_insertion、全サブカテゴリ8-12個に拡充）
  NEUTRAL_POOL: 2 categories = 75 (非エロシーン用)
  AFTERMATH_POOL: 2 categories = 75 (事後シーン用)
  MALE_SHORT_REPLACEMENTS: 男性セリフ短縮辞書 = 50+
  STORY_PATTERN_LIBRARY: 46パターン（+15: isekai/onsen/medical/idol/sleep等 汎用テーマ対応）
"""
import random


# ============================================================================
# 喘ぎ声プール（intensity別、各160エントリー）
# ============================================================================
MOAN_POOL = {
    # Intensity 1: 低感度・恥じらい（控えめ、♡なし）
    1: [
        "んっ…",
        "はぁ…",
        "ふぅ…",
        "くっ…",
        "うっ…",
        "ひっ…",
        "んぅ…",
        "はっ…",
        "ふっ…",
        "ぅん…",
        "んん…",
        "くぅ…",
        "ひぅ…",
        "うぅ…",
        "はぅ…",
        "んはっ…",
        "ふぁ…",
        "くぅっ…",
        "ぁ…",
        "んはぅ…",
        "ひぁ…",
        "はふ…",
        "ふんっ…",
        "うん…",
        "ぅあ…",
        "んぁ…",
        "ふはっ…",
        "ひぁぅ…",
        "はんっ…",
        "ぅぁ…",
        "んふっ…",
        "くんっ…",
        "ふぅん…",
        "はぁん…",
        "ひんっ…",
        "うはっ…",
        "んはぁ…",
        "はぁぅ…",
        "ふわ…",
        "ぅんっ…",
        "はぅっ…",
        "ふわっ…",
        "んんっ…",
        "ぁっ…",
        "ん…っ",
        "はっ…っ",
        "はふっ…",
        "ひゃっ…",
        "んぅぁ…",
        "ふぅっ…",
        "あふ…",
        "うぁっ…",
        "ぅはっ…",
        "あひっ…",
        "ぅはぅ…",
        "ふんぅ…",
        "ひゃぅ…",
        "くぅん…",
        "うんっ…",
        "んぅっ…",
        "はぁっ…",
        "ふぁっ…",
        "ふぅ…っ",
        "あ…っ",
        "んっ…っ",
        "んふぅ…",
        "はんぅ…",
        "はぁ…っ",
        "くぁ…",
        "うぅっ…",
        "ぅうっ…",
        "んはっ",
        "はぅん…",
        "ふはぁ…",
        "んぁぅ…",
        "くぅぅ…",
        "うはぁ…",
        "んぅん…",
        "はふぅ…",
        "ふぁぅ…",
        # v8.0追加 (81-160)
        "あぅ…",
        "はんぅっ…",
        "ふぅぁ…",
        "んはぁん…",
        "くんぅ…",
        "ひぁっ…",
        "うぅん…",
        "はっ…ん…",
        "ふんっ…っ",
        "んん…っ",
        "くっ…ん…",
        "ひゅっ…",
        "うはっ…っ",
        "はぁ…ん…",
        "ぅんん…",
        "んふ…",
        "はぅぅ…",
        "ふぅん…っ",
        "ぁぅ…",
        "んぅ…っ",
        "ひぁん…",
        "くっ…っ…",
        "うんぅ…",
        "はっ…はっ…",
        "ふっ…ぅ…",
        "んはぅ…っ",
        "ぅふっ…",
        "あっ…",
        "ひぅっ…",
        "くぅっ…っ",
        "うあっ…",
        "はぁぅ…っ",
        "ふあっ…",
        "んぁっ…",
        "ぅあっ…",
        "ひっ…ん…",
        "くぅぁ…",
        "うふっ…",
        "はふっ…っ",
        "ふぅぁ…っ",
        "んっはっ…",
        "ぅっ…",
        "ひぁ…っ",
        "はんぅ…っ",
        "ふわぁ…",
        "くんっ…っ",
        "うはぅ…",
        "んふっ…っ",
        "あぅっ…",
        "ひゃ…",
        "はっ…ふ…",
        "ふんぅ…っ",
        "ぅはぁ…",
        "んぅはっ…",
        "くぅっ…ん",
        "うんはっ…",
        "はぅ…っ",
        "ふっ…はっ…",
        "んんぅ…",
        "ぁっ…ん…",
        "ひんぅ…",
        "くはっ…",
        "うぁ…",
        "はふぁ…",
        "ふぅ…ん…",
        "んぁ…っ",
        "ぅんはっ…",
        "ひゃっ…っ",
        "くっ…ぅ…",
        "うぅ…ん…",
        "はっ…ぁ…",
        "ふはぁ…っ",
        "んはんっ…",
        "ぁぅっ…",
        "ひぁぅ…っ",
        "くぅん…っ",
        "うっ…はっ…",
    ],

    # Intensity 2: 感じ始め（声が漏れ始める、♡付き）
    2: [
        "あっ♡",
        "やぁ…♡",
        "ひゃっ♡",
        "んあっ♡",
        "あぁ…",
        "やっ…",
        "ふあっ♡",
        "んんっ♡",
        "はあっ…",
        "ひあっ♡",
        "あんっ♡",
        "やぁん…",
        "くあっ…",
        "ふあぁ…♡",
        "んやっ♡",
        "あはっ♡",
        "ひゃぁ…♡",
        "やんっ…",
        "はあぁ…♡",
        "あふっ…",
        "んはっ♡",
        "ふやっ♡",
        "ひあぁ…",
        "あっ…んっ…",
        "やぁっ♡",
        "くあぁ…♡",
        "んあぁ…",
        "はやっ♡",
        "あぁん♡",
        "ふぁんっ♡",
        "ひんっ…♡",
        "やあっ…",
        "あやっ♡",
        "んふあっ♡",
        "くぅぁっ…",
        "はあんっ♡",
        "ふあんっ…",
        "あひっ♡",
        "ひやっ…♡",
        "やぁっ…",
        "んっあっ…",
        "あんぅ…♡",
        "はぁぁ…♡",
        "あぁ…♡",
        "ふやぁ…♡",
        "んぅっ…♡",
        "やあぁ…♡",
        "あはぁ…♡",
        "んにゃっ♡",
        "はやぁ…",
        "はぅ…♡",
        "あぅっ♡",
        "ひぁ…♡",
        "ひあんっ♡",
        "やぁぅっ…♡",
        "んあんっ…",
        "はにゃっ♡",
        "あやぁ…♡",
        "ふぅあっ…",
        "ひやぁ…",
        "やぁ…っ♡",
        "あんはっ♡",
        "くぅあっ♡",
        "んやぁ…♡",
        "はぁんっ…",
        "ふぁっ…♡",
        "あぅぅ…",
        "ひゃんっ♡",
        "やはっ…",
        "んあはっ…",
        "くぅあぁ…♡",
        "んぁっ…♡",
        "あひゃ…♡",
        "ふやんっ♡",
        "ひゃっ…♡",
        "やぁん…♡",
        "あふぅ…♡",
        "んやんっ…",
        "はぅっ…♡",
        "くあんっ♡",
        # v8.0追加 (81-160)
        "あぁっ…♡",
        "やぁぁ…♡",
        "ひぁんっ…♡",
        "んっ…あっ♡",
        "あやっ…♡",
        "やんぅ…♡",
        "ふぁっ♡",
        "んにゃぁ…♡",
        "はぁっ♡",
        "ひやんっ♡",
        "あにゃ…♡",
        "やっ…♡",
        "くぅっ…♡",
        "ふあっ…♡",
        "んはぁ…♡",
        "あはんっ♡",
        "ひあっ…♡",
        "やぁっ…♡",
        "はあっ♡",
        "あんっ…♡",
        "ふやぁっ♡",
        "んあぁっ♡",
        "ひゃぁん♡",
        "やぁんっ♡",
        "くあぁっ♡",
        "あぁはっ♡",
        "はにゃぁ…♡",
        "ふぁあっ♡",
        "んやっ…♡",
        "ひゃっんっ♡",
        "あっ…やぁ♡",
        "やにゃ…♡",
        "はぁっ…♡",
        "ふんっ♡",
        "んぁあっ♡",
        "あひぁ…♡",
        "くぅんっ♡",
        "ひぁっ…♡",
        "やあっ♡",
        "はやんっ♡",
        "あぅっ…♡",
        "ふあぁっ♡",
        "んっ♡",
        "あっ…はぁ♡",
        "やぅっ♡",
        "ひにゃ…♡",
        "はぁあっ♡",
        "くあっ♡",
        "あんにゃ…♡",
        "ふやっ…♡",
        "んはっ…♡",
        "やはぁ…♡",
        "ひあっ♡",
        "あやぁっ♡",
        "はんっ♡",
        "ふぁんっ…♡",
        "んぅあっ♡",
        "くぅはっ♡",
        "やぁはっ♡",
        "あはっ…♡",
        "ひやにゃ♡",
        "はぁやっ♡",
        "ふぅっ♡",
        "んっやぁ…♡",
        "あにゃっ♡",
        "やぁっんっ♡",
        "ひぁはっ♡",
        "はぅあっ♡",
        "くにゃ…♡",
        "ふあにゃっ♡",
        "あっはぁ…♡",
        "んあにゃっ♡",
        "やぁ…はっ♡",
        "ひゃ…ぁ…♡",
        "はあやっ♡",
        "あやにゃ♡",
        "ふはっ♡",
        "んやにゃ♡",
        "やっあっ♡",
        "あっやっ♡",
    ],

    # Intensity 3: 前戯・本番開始（♡♡も登場）
    3: [
        "あぁっ♡",
        "んはぁっ♡",
        "ひぁっ♡♡",
        "あんっ♡♡",
        "やぁっ♡♡",
        "はぁんっ♡",
        "ふあぁっ♡",
        "んあぁっ♡♡",
        "あひぃっ♡",
        "くぅっ♡♡",
        "やあぁっ♡♡",
        "ひゃあっ♡♡",
        "あぁあっ♡",
        "んんぅっ♡♡",
        "はあぁっ♡♡",
        "ふぁぁっ♡",
        "あやぁっ♡♡",
        "くあぁっ♡",
        "ひぁぁっ♡♡",
        "やんっ♡♡",
        "んはあっ♡♡",
        "あふぁっ♡",
        "はぁぃっ♡♡",
        "ふぁあっ♡♡",
        "ひやぁっ♡♡",
        "あぁぅっ♡♡",
        "やぁぃっ♡♡",
        "んあっ♡♡",
        "くぁぁっ♡♡",
        "はあんっ♡♡",
        "あぁんっ♡♡",
        "ふぁぁっ♡♡",
        "あへぅっ♡♡",
        "やあんっ♡♡",
        "んやぁっ♡♡",
        "あはぁっ♡♡",
        "んほぅ…♡♡",
        "はふぁっ♡♡",
        "ふやぁっ♡♡",
        "ひあぁっ♡♡",
        "あぁひっ♡",
        "やぁぅっ♡♡",
        "んふあっ♡♡",
        "はやぁっ♡♡",
        "くあんっ♡♡",
        "ふあんっ♡♡",
        "ひゃんっ♡♡",
        "あんはっ♡♡",
        "やふぁっ♡♡",
        "んぁあっ♡♡",
        "はぅぅっ♡♡",
        "あやんっ♡♡",
        "ふぅあっ♡♡",
        "くぅんっ♡♡",
        "ひゃぁっ♡♡",
        "やあぁん♡♡",
        "んあはっ♡♡",
        "あふぅっ♡♡",
        "はぅぁっ♡♡",
        "くぅあっ♡♡",
        "おほっ…♡♡",
        "ひやんっ♡♡",
        "あへっ…♡♡",
        "やひゃっ♡♡",
        "んはぁっ♡♡",
        "はあひっ♡♡",
        "あひゃっ♡♡",
        "んほぅっ♡♡",
        "ふあひっ♡♡",
        "おほぅっ♡♡",
        "やんはっ♡♡",
        "んあやっ♡♡",
        "はんあっ♡♡",
        "あぁふっ♡♡",
        "んほっ…♡♡",
        "ふやんっ♡♡",
        "ひあんっ♡♡",
        "やぁふっ♡♡",
        "んはやっ♡♡",
        "あぁはっ♡♡",
        # v8.0追加 (81-160)
        "あぁっ♡♡",
        "んあぁっ♡",
        "やぁあっ♡♡",
        "ひゃっ♡♡",
        "あんあっ♡♡",
        "はぁっ♡♡",
        "ふあぁんっ♡♡",
        "んはぁんっ♡♡",
        "あひっ♡♡",
        "やぁんぅっ♡♡",
        "くぅぁっ♡♡",
        "ひあっ♡♡",
        "あはぁんっ♡♡",
        "んやぁんっ♡♡",
        "はやぁっ♡",
        "ふぁんっ♡♡",
        "あぁやっ♡♡",
        "やぁひっ♡♡",
        "んぁっ♡♡",
        "くあぁんっ♡♡",
        "ひぁんっ♡♡",
        "あやぁんっ♡♡",
        "はあぁんっ♡♡",
        "ふあひぃっ♡♡",
        "んはぁぃっ♡♡",
        "やあぁっ♡",
        "あへぅんっ♡♡",
        "ひゃぁんっ♡♡",
        "くぅあぁっ♡♡",
        "はぁあっ♡♡",
        "ふやぁんっ♡♡",
        "んあやっ♡",
        "あぁぁっ♡♡",
        "やふぁんっ♡♡",
        "ひあぁんっ♡♡",
        "はにゃぁっ♡♡",
        "あんやっ♡♡",
        "くぅっ♡",
        "ふぁぁんっ♡♡",
        "んほぅんっ♡♡",
        "やにゃっ♡♡",
        "あはっ♡♡",
        "ひやぁんっ♡♡",
        "はぅんっ♡♡",
        "あんぅっ♡♡",
        "ふぅぁっ♡♡",
        "んにゃっ♡♡",
        "やぁぁっ♡♡",
        "くぁっ♡♡",
        "あぁんぅっ♡♡",
        "ひぁはっ♡♡",
        "はやんっ♡♡",
        "おほぅんっ♡♡",
        "あやはっ♡♡",
        "ふはぁっ♡♡",
        "んあぁんっ♡♡",
        "やはぁっ♡♡",
        "あへぅぁっ♡♡",
        "ひやはっ♡♡",
        "はぁやんっ♡♡",
        "くぅやっ♡♡",
        "あぁひゃっ♡♡",
        "ふやはっ♡♡",
        "んぁやっ♡♡",
        "やあはっ♡♡",
        "あんはぁっ♡♡",
        "ひゃぁはっ♡♡",
        "はんやっ♡♡",
        "おほっ♡♡",
        "あぁにゃっ♡♡",
        "ふぁはっ♡♡",
        "んほっ…♡",
        "やぁにゃっ♡♡",
        "あやぁはっ♡♡",
        "ひぁにゃっ♡♡",
        "はぁふっ♡♡",
        "くぅにゃっ♡♡",
        "あっ…あっ♡♡",
        "ふにゃっ♡♡",
        "んやはっ♡♡",
    ],

    # Intensity 4: 激しい・理性崩壊（延音・破裂音、♡♡）
    4: [
        "あぁあっ♡♡",
        "おぉっ♡♡",
        "ひぎぃっ♡♡",
        "んんっ♡♡",
        "あぁっぅ♡♡",
        "んほぉっ♡♡",
        "おぉぉっ♡♡",
        "ひぎっ♡♡",
        "あぁぁっぅ♡♡",
        "んんんっ♡♡",
        "んほっ♡♡",
        "おぉほっ♡♡",
        "ひぎぃ♡♡",
        "あぁはっぅ♡♡",
        "んんぁっ♡♡",
        "んほぉぉ♡♡",
        "おぉあっ♡♡",
        "ひぎぃん♡♡",
        "あぁんっぅ♡♡",
        "んんはっ♡♡",
        "ぐあっ♡♡",
        "おぉぅっ♡♡",
        "ひぎゃっ♡♡",
        "あぁぅっぅ♡♡",
        "んんふっ♡♡",
        "ぐぅっ♡♡",
        "おぉおっ♡♡",
        "ひぎあっ♡♡",
        "あぁあぁっ♡♡",
        "んんぅっぅ♡♡",
        "おほぉっ♡♡",
        "おぉひぃ♡♡",
        "ひぎぃぃ♡♡",
        "あぁひっ♡♡",
        "んんあっ♡♡",
        "おほっ♡♡",
        "おぉぉぉ♡♡",
        "ひぎゅっ♡♡",
        "あぁふっぅ♡♡",
        "んんおっ♡♡",
        "ぐあぁっ♡♡",
        "おぉぃっ♡♡",
        "ひぎんっ♡♡",
        "あぁあんっ♡♡",
        "んんひっ♡♡",
        "あへぇっ♡♡",
        "おぉはっ♡♡",
        "ひぎぁっ♡♡",
        "あぁぁぁ♡♡",
        "んんぅんっ♡♡",
        "あへっ♡♡",
        "おぉんっ♡♡",
        "んんぁぃっ♡♡",
        "あぁおっ♡♡",
        "んんやっ♡♡",
        "あへぇぇ♡♡",
        "おぉぁっ♡♡",
        "おぉぅぁっ♡♡",
        "あぁやっぅ♡♡",
        "んんぁぁっ♡♡",
        "んほぉんっ♡♡",
        "おぉぉぅっ♡♡",
        "ひぎぃぅっ♡♡",
        "あぁくっ♡♡",
        "んんぐっ♡♡",
        "ぐぅぅっ♡♡",
        "おぉひっ♡♡",
        "ひぎぃぁ♡♡",
        "あぁぐっ♡♡",
        "んんあぁっ♡♡",
        "ぐぅぁっ♡♡",
        "んほぁっ♡♡",
        "おぉぉんっ♡♡",
        "ひぎぅっ♡♡",
        "あぁぃっ♡♡",
        "んんおぉっ♡♡",
        "ぐはぁっ♡♡",
        "おぉあぁっ♡♡",
        "ひぎぁぁっ♡♡",
        "あぁんぅっぅ♡♡",
        # v8.0追加 (81-160)
        "あぁぁぁっ♡♡",
        "おぉぉぉっ♡♡",
        "ひぎぃっん♡♡",
        "んんはぁっ♡♡",
        "あぁあんぅっ♡♡",
        "おほぉぅっ♡♡",
        "ぐぅんっ♡♡",
        "んんんはっ♡♡",
        "あへぇぅっ♡♡",
        "おぉぅぅっ♡♡",
        "ひぎぃはっ♡♡",
        "あぁはぁっ♡♡",
        "んんぅはっ♡♡",
        "おほぅっ♡♡",
        "ぐぁぁっ♡♡",
        "あぁぉっ♡♡",
        "おぉほぅっ♡♡",
        "ひぎあぁ♡♡",
        "んんやぁっ♡♡",
        "あへぅっ♡♡",
        "ぐっ♡♡",
        "おぉあんっ♡♡",
        "ひぎんっ…♡♡",
        "あぁぁんっ♡♡",
        "んんおぅっ♡♡",
        "おほぁっ♡♡",
        "ぐぅはっ♡♡",
        "あぁぅぁっ♡♡",
        "おぉぉはっ♡♡",
        "ひぎぁんっ♡♡",
        "んんはんっ♡♡",
        "あへぁっ♡♡",
        "ぐあんっ♡♡",
        "おぉぅんっ♡♡",
        "あぁおぅっ♡♡",
        "ひぎゅんっ♡♡",
        "んんぁおっ♡♡",
        "おほんっ♡♡",
        "ぐぅぅんっ♡♡",
        "あぁぅおっ♡♡",
        "おぉほんっ♡♡",
        "ひぎぃおっ♡♡",
        "んんおんっ♡♡",
        "あへぅんっ♡♡",
        "ぐはんっ♡♡",
        "おぉはんっ♡♡",
        "あぁはんっ♡♡",
        "ひぎんぅっ♡♡",
        "んんぁはっ♡♡",
        "おほはっ♡♡",
        "ぐぅおっ♡♡",
        "あぁおんっ♡♡",
        "おぉおんっ♡♡",
        "んんぐぅっ♡♡",
        "あへはっ♡♡",
        "ひぎはんっ♡♡",
        "ぐおっ♡♡",
        "あぁやんっ♡♡",
        "おぉやっ♡♡",
        "んんはぅっ♡♡",
        "おほぅんっ♡♡",
        "ぐぅやっ♡♡",
        "あぁはおっ♡♡",
        "ひぎおっ♡♡",
        "んんおはっ♡♡",
        "あへおっ♡♡",
        "おぉぉやっ♡♡",
        "ぐはぅっ♡♡",
        "あぁおはっ♡♡",
        "んんはおっ♡♡",
        "おほぉはっ♡♡",
        "ひぎぅんっ♡♡",
        "ぐぅぁんっ♡♡",
        "あぁぅやっ♡♡",
        "おぉおはっ♡♡",
        "んんやんっ♡♡",
        "あへやっ♡♡",
        "ぐやっ♡♡",
        "ひぎやんっ♡♡",
        "おぉやんっ♡♡",
    ],

    # Intensity 5: 絶頂・汚喘ぎ（♡♡♡、崩壊発声）
    5: [
        "いぐぅっ♡♡♡",
        "あぁあぁあぁっ♡♡",
        "おぉほぉっ♡♡♡",
        "ひぎぃぃっ♡♡♡",
        "んほぉっ♡♡♡",
        "いぃっ♡♡♡",
        "あぁあぁっ♡♡♡",
        "おぉほっ♡♡♡",
        "いぐっ♡♡♡",
        "ひぎぃぁっ♡♡♡",
        "んほぉぉっ♡♡♡",
        "いぃぐっ♡♡♡",
        "あぁあぁぁっ♡♡♡",
        "おぉほぉぉ♡♡♡",
        "ひぎぃんっ♡♡♡",
        "いぐぅぅっ♡♡♡",
        "おほぉぉっ♡♡♡",
        "いぃいぃっ♡♡♡",
        "あぁあぁんっ♡♡♡",
        "おぉほぅっ♡♡♡",
        "ひぎゃあっ♡♡♡",
        "いぐんっ♡♡♡",
        "あへぇっ♡♡♡",
        "いぃくっ♡♡♡",
        "あぁあぁはっ♡♡♡",
        "おぉほぉんっ♡♡♡",
        "ひぎぃぃぃ♡♡♡",
        "いぐぅんっ♡♡♡",
        "あへぇぇっ♡♡♡",
        "いぃぃっ♡♡♡",
        "あぁあぁふっ♡♡♡",
        "おぉほぁっ♡♡♡",
        "ひぎゅぅっ♡♡♡",
        "いぐあっ♡♡♡",
        "んほぉぉぉ♡♡♡",
        "いぃあっ♡♡♡",
        "あぁあぁぅっ♡♡♡",
        "おぉほぅぅっ♡♡♡",
        "ひぎあぁっ♡♡♡",
        "おぉんほっ♡♡♡",
        "おほぉんっ♡♡♡",
        "いぃぁっ♡♡♡",
        "あぁあぁぅぁっ♡♡♡",
        "おぉほぉぁ♡♡♡",
        "んほぉぅっ♡♡♡",
        "いぐはぁっ♡♡♡",
        "あへぇんっ♡♡♡",
        "いぃんっ♡♡♡",
        "あぁあぁおっ♡♡♡",
        "おぉほぉっん♡♡♡",
        "ひぎぃぁぁっ♡♡♡",
        "いぐぅはっ♡♡♡",
        "んほっ♡♡♡",
        "いぃひっ♡♡♡",
        "あぁあぁひっ♡♡♡",
        "おぉほぅぅ♡♡♡",
        "ひぎぃぅっ♡♡♡",
        "いぐぅぁっ♡♡♡",
        "おほっ♡♡♡",
        "いぃぁぁっ♡♡♡",
        "あぁあぁやっ♡♡♡",
        "おぉほぉぃっ♡♡♡",
        "ひぎぃぃんっ♡♡♡",
        "いぐぁっ♡♡♡",
        "あへっ♡♡♡",
        "いぃくぅっ♡♡♡",
        "あぁあぁぁぁ♡♡♡",
        "おぉほぉはっ♡♡♡",
        "ひぎぃぃぁっ♡♡♡",
        "いぐぅぅぁっ♡♡♡",
        "んほぉはっ♡♡♡",
        "いぃぐぅっ♡♡♡",
        "あぁあぁぐっ♡♡♡",
        "おぉほんっ♡♡♡",
        "ひぎぃやっ♡♡♡",
        "いぃぃぃっ♡♡♡",
        "おほぉはっ♡♡♡",
        "いぃはっ♡♡♡",
        "あぁあぁあぁぁ♡♡♡",
        "おぉほぉぅっ♡♡♡",
        # v8.0追加 (81-160)
        "いぐぅぅんっ♡♡♡",
        "あぁあぁあっ♡♡♡",
        "おぉほぉぉっ♡♡♡",
        "ひぎぃぃっ♡♡",
        "んほぉんっ♡♡♡",
        "いぃっ…♡♡♡",
        "あぁあぁはぁっ♡♡♡",
        "おぉほっ…♡♡♡",
        "いぐはっ♡♡♡",
        "ひぎぃぁっ♡♡",
        "んほぉぉんっ♡♡♡",
        "いぃぐはっ♡♡♡",
        "あぁあぁぁんっ♡♡♡",
        "おぉほぉはっ♡♡",
        "ひぎゃぁっ♡♡♡",
        "いぐぅはぁっ♡♡♡",
        "おほぉっ♡♡♡",
        "いぃいぃぃっ♡♡♡",
        "あぁあぁんぅっ♡♡♡",
        "おぉほぅはっ♡♡♡",
        "ひぎゃんっ♡♡♡",
        "いぐんはっ♡♡♡",
        "あへぇはっ♡♡♡",
        "いぃくはっ♡♡♡",
        "あぁあぁはんっ♡♡♡",
        "おぉほぉぉんっ♡♡♡",
        "ひぎぃぃはっ♡♡♡",
        "いぐぅんはっ♡♡♡",
        "あへぇぇんっ♡♡♡",
        "いぃぃはっ♡♡♡",
        "あぁあぁふはっ♡♡♡",
        "おぉほぁんっ♡♡♡",
        "ひぎゅぅんっ♡♡♡",
        "いぐあはっ♡♡♡",
        "んほぉぉはっ♡♡♡",
        "いぃあはっ♡♡♡",
        "あぁあぁぅはっ♡♡♡",
        "おぉほぅんっ♡♡♡",
        "ひぎあはっ♡♡♡",
        "おぉんほはっ♡♡♡",
        "おほぉんはっ♡♡♡",
        "いぃぁんっ♡♡♡",
        "あぁあぁぅぁんっ♡♡♡",
        "おぉほぉぁんっ♡♡♡",
        "んほぉぅんっ♡♡♡",
        "いぐはぁんっ♡♡♡",
        "あへぇんはっ♡♡♡",
        "いぃんはっ♡♡♡",
        "あぁあぁおんっ♡♡♡",
        "おぉほぉんはっ♡♡♡",
        "ひぎぃぁんっ♡♡♡",
        "いぐぅはんっ♡♡♡",
        "んほんっ♡♡♡",
        "いぃひはっ♡♡♡",
        "あぁあぁひんっ♡♡♡",
        "おぉほぅはっ♡♡",
        "ひぎぃぅんっ♡♡♡",
        "いぐぅぁんっ♡♡♡",
        "おほんっ♡♡♡",
        "いぃぁはっ♡♡♡",
        "あぁあぁやんっ♡♡♡",
        "おぉほぉぃんっ♡♡♡",
        "ひぎぃんはっ♡♡♡",
        "いぐぁんっ♡♡♡",
        "あへんっ♡♡♡",
        "いぃくぅんっ♡♡♡",
        "あぁあぁぁぅんっ♡♡♡",
        "おぉほぉはんっ♡♡♡",
        "ひぎぃぃぁんっ♡♡♡",
        "いぐぅぅぁんっ♡♡♡",
        "んほぉはんっ♡♡♡",
        "いぃぐぅんっ♡♡♡",
        "あぁあぁぐんっ♡♡♡",
        "おぉほんはっ♡♡♡",
        "ひぎぃやんっ♡♡♡",
        "いぃぃぃんっ♡♡♡",
        "おほぉはんっ♡♡♡",
        "いぃはんっ♡♡♡",
    ],
}


# ============================================================================
# 女性セリフプール（状況別）
# ============================================================================
SPEECH_FEMALE_POOL = {
    # denial: 否定・抵抗
    "denial": [
        "やだ…",
        "だめ…",
        "いや…っ",
        "むり…",
        "やめ…",
        "離して…",
        "やめて…",
        "触んないで",
        "いやっ…",
        "だめっ…",
        "嫌…っ",
        "やだぁ…",
        "やめてよ…",
        "やだってば",
        "さわらないで",
        "だめだって…",
        "無理だよ…",
        "いやぁっ…",
        "来ないで…",
        "放して…",
        "嫌だってば",
        "やめろ…",
        "だめぇ…",
        "入れないで…",
        "そこはだめ…",
        "やだやだ…",
        "ほんとやめて",
        "近寄らないで",
        "いやだ…",
        "なにすんの",
        "やめなさい…",
        "しないで…",
        "ひどい…",
        "こわい…",
        "痛い…っ",
        "いたい…",
        "何するの…",
        "やめてって…",
        "嘘でしょ…",
        "信じらんない",
        "ありえない…",
        "最低…",
        "無理無理…",
        "やだよぉ…",
        "いやなの…",
        "だめだってば",
        "そこだめ…っ",
        "こないで…",
        "嫌なの…っ",
        "なんで…っ",
    ],

    # embarrassed: 恥ずかしい
    "embarrassed": [
        "見ないで…",
        "はずかし…",
        "そこ…だめ…",
        "見ちゃだめ…",
        "やだ…見える",
        "恥ずかしぃ…",
        "えっちだよ…",
        "こんなの…",
        "声…出ちゃう",
        "聞かないで…",
        "言わないで…",
        "そんな目で…",
        "みないでよぉ",
        "はずかしい…",
        "変な声…出る",
        "そこ…やだ…",
        "濡れてない…",
        "感じてないし",
        "みないで…そこ…",
        "見えちゃう…",
        "照れちゃう…",
        "変態…",
        "あつい…",
        "聞こえちゃう",
        "顔…見ないで",
        "どこ見てるの",
        "だめ…そこぉ",
        "やだ…変な音",
        "え…なにこれ",
        "顔あつい…",
        "声やばい…",
        "こんなかっこ",
        "自分で見えて",
        "ばか…えっち",
        "音…やだ…",
        "そこ見ないで",
        "なに見てるの",
        "やだ…声が…",
        "照れるから…",
        "やだ…恥ずかし",
        "体あつい…",
        "こんな姿…",
        "恥ずかしすぎ",
        "変態さん…",
        "エッチ…",
        "やだ…顔熱い",
        "見すぎ…",
        "声出さないで",
        "目…そらして",
        "電気消して…",
    ],

    # plea: 懇願
    "plea": [
        "お願い…",
        "許して…",
        "もう許して♡",
        "もうだめ…",
        "もう無理…",
        "たすけて…",
        "お願い…♡",
        "許して…♡",
        "もうやだ…♡",
        "やすませて…",
        "休んで…♡",
        "まって…♡",
        "おねがい…♡",
        "これ以上は…",
        "勘弁して…",
        "もう限界…♡",
        "壊れちゃう♡",
        "頭おかしくなる",
        "頭…まわらない",
        "もうむり…♡",
        "ゆるして…♡",
        "待って…♡",
        "ちょっと待って",
        "やすんで…♡",
        "時間ちょうだい",
        "息できない…",
        "体もたない…",
        "もう耐えらん",
        "限界なの…♡",
        "腰…もう…",
        "足閉じさせて",
        "死んじゃう…",
        "ほんとに無理",
        "もうゆるして",
        "少し休ませて",
        "一回やめて…",
        "体おかしい…",
        "溶けちゃう♡",
        "頭ぐるぐる…",
        "ダメになる♡",
        "感覚やばい…",
        "もう立てない",
        "体ぴくぴく…",
        "意識とぶ…♡",
        "これ以上むり",
        "腰くだける…",
        "力はいらない",
        "もうだめぇ♡",
        "お願いだから",
        "壊れちゃうよ",
    ],

    # acceptance: 受容・快楽
    "acceptance": [
        "いい…♡",
        "もっと…♡",
        "すき…♡",
        "きもちぃ…♡",
        "すごい…♡",
        "奥…いい♡",
        "気持ちいい♡",
        "そこぉ…♡",
        "もっとして♡",
        "ほしい…♡",
        "いいよ…♡",
        "中…いい♡",
        "好き…♡♡",
        "やばい…♡",
        "入ってる…♡",
        "あったかい♡",
        "すきぃ…♡",
        "奥まで…♡",
        "全部ほしい♡",
        "抱いて…♡",
        "離さないで♡",
        "もっと奥…♡",
        "いっぱい…♡",
        "大きい…♡",
        "触って…♡",
        "きて…♡",
        "ちょうだい♡",
        "もっと強く♡",
        "そこ…いい♡",
        "このまま…♡",
        "ぜんぶ…♡",
        "だいすき…♡",
        "中あったかい",
        "動いて…♡",
        "深い…♡",
        "感じる…♡",
        "いい…もっと",
        "幸せ…♡♡",
        "つながってる",
        "ぎゅってして♡",
        "奥に当たる♡",
        "抱きしめて♡",
        "キスして…♡",
        "嬉しい…♡",
        "ずっとこのまま",
        "好きすぎる♡",
        "最高…♡",
        "溶ける…♡",
        "もっと深く♡",
        "ぴったり…♡",
    ],

    # ecstasy: 快楽絶頂
    "ecstasy": [
        "イっちゃう♡",
        "もうだめ♡♡",
        "おかしくなる",
        "イく…♡♡",
        "イっちゃ♡♡",
        "とんじゃう♡",
        "しんじゃう♡",
        "だめ…イく♡",
        "もうイく♡♡",
        "イきたい…♡",
        "頭とぶ…♡♡",
        "何も考えらん",
        "止まんない♡",
        "またイく♡♡",
        "連続でイく♡",
        "やば…イく♡",
        "壊れる…♡♡",
        "もう何回目…",
        "イっちゃった",
        "だめイっちゃ",
        "おかしい…♡",
        "あっイく…♡",
        "イくイく♡♡",
        "やだイっちゃ",
        "イきそう…♡",
        "また…イく♡",
        "奥でイく♡♡",
        "中でイく…♡",
        "だめもうイく",
        "頭まっしろ♡",
        "なにもみえない",
        "意識とぶ♡♡",
        "ぶっとぶ…♡",
        "すごいイく♡",
        "全身びくびく",
        "腰とまんない",
        "ぐちゃぐちゃ",
        "もうわかんない",
        "おかしくなっちゃ",
        "体ビクビク♡",
        "とまんない♡",
        "目の前真っ白",
        "何回イった…",
        "また…きちゃう",
        "だめ…きちゃう",
        "イった…♡♡",
        "こわれちゃう",
        "ああイく♡♡",
        "びくっ…♡♡",
        "やだまたイく",
    ],

    # post: 事後
    "post": [
        "はぁ…はぁ…",
        "もう…むり…",
        "すごかった…",
        "まだ…ドキドキ",
        "動けない…",
        "足…がくがく",
        "ふぅ…♡",
        "びっくりした",
        "もう…ばか…",
        "中…あつい…",
        "抜かないで…",
        "幸せ…♡",
        "とろけた…♡",
        "力…入んない",
        "ぼーっとする",
        "頭ふわふわ…",
        "まだびくびく",
        "疲れた…♡",
        "気持ちよかった",
        "すごかった♡",
        "またしたい…",
        "もうむり…",
        "腰が…♡",
        "意識飛んでた",
        "何回イったの",
        "夢みたい…♡",
        "まだ震えてる",
        "体あつい…♡",
        "ぐったり…♡",
        "余韻…すごい",
        "立てない…♡",
        "目がとろとろ",
        "大好きだよ♡",
        "このままいたい",
        "もう一回…♡",
        "あったかい…",
        "まだ感じてる",
        "体とろとろ…",
        "ちょっと休憩…",
        "出てきてる…",
    ],

    # provoke: 挑発・煽り
    "provoke": [
        "できるの？",
        "もう終わり？",
        "それだけ？",
        "足りない♡",
        "かかってきて",
        "遅い♡",
        "もっとできる？",
        "全然平気♡",
        "こんなもの？",
        "つまんない♡",
        "物足りない♡",
        "まだまだ♡",
        "弱いなぁ♡",
        "へたくそ♡",
        "もっと激しく",
        "その程度？",
        "本気出して♡",
        "元気ないね♡",
        "全然足りない",
        "もっとできるよ",
        "まだいけるよ♡",
        "手加減してる？",
        "余裕だよ♡",
        "ぜんぜん♡",
        "こっちおいで♡",
        "逃げないで♡",
        "捕まえて♡",
        "ほらもっと♡",
        "早くして♡",
        "焦らさないで",
        "待ちきれない",
        "ほしくないの？",
        "怖いの？♡",
        "ほら…おいで",
        "欲しいんでしょ",
        "ねぇまだ？♡",
        "もう降参？♡",
        "だらしないね",
        "限界？♡",
        "ざーこ♡",
    ],

    # insertion: 挿入リアクション（挿入の瞬間〜直後）
    "insertion": [
        "あ…入って…♡",
        "おっきい…♡",
        "きつい…♡",
        "入った…♡♡",
        "奥まで…♡",
        "うそ…全部…♡",
        "ひっ…♡",
        "あつい…♡",
        "広がってる…♡",
        "いたっ…♡",
        "んっ…♡♡",
        "すごい…中…♡",
        "いっぱい…♡",
        "深い…♡♡",
        "当たってる…♡",
        "え…もう…♡",
        "ゆっくり…♡",
        "はいってく…♡",
        "ぎゅって…♡",
        "動かないで…♡",
        "感じる…中…♡",
        "きもちぃ…♡",
        "もっと…奥まで♡",
        "はまってる…♡",
        "あ…あ…♡♡",
        "つながった…♡",
        "ぬるっと…♡",
        "ずるい…一気に",
        "まって…大きい",
        "中あったかい♡",
    ],

    # beg: おねだり・催促
    "beg": [
        "ほしい…♡",
        "入れて…♡",
        "もっと…♡",
        "はやく…♡",
        "ちょうだい♡",
        "おねがい…♡",
        "動いて…♡",
        "じらさないで",
        "中に…ほしい♡",
        "奥まで…して♡",
        "もっと激しく♡",
        "止めないで…♡",
        "はやくして…♡",
        "触って…♡",
        "キス…して♡",
        "抱きしめて♡",
        "ぜんぶして♡",
        "ここ…して♡",
        "もう一回…♡",
        "ずっとして…♡",
        "深くして…♡",
        "強くして♡♡",
        "お願い…もっと",
        "中に出して♡",
        "全部ちょうだい",
    ],

    # submissive: 従順・奉仕
    "submissive": [
        "なんでもします",
        "ご主人様…♡",
        "使って…♡",
        "言う通りに…",
        "お好きに…♡",
        "従います…♡",
        "命令して…♡",
        "ご奉仕します",
        "好きにして♡",
        "はい…♡",
        "わかりました♡",
        "あなたのもの♡",
        "逆らわない♡",
        "なんでもする♡",
        "全部あげる♡",
        "捧げます…♡",
        "犬になります",
        "飼って…♡",
        "どうぞ…♡",
        "されるがまま♡",
        "言うこと聞く♡",
        "壊していいよ♡",
        "お仕置きして",
        "もっと虐めて♡",
        "褒めて…♡",
        "頑張ります♡",
        "ぺろぺろ…♡",
        "舐めていい？♡",
        "味…します♡",
        "奉仕するね♡",
        "もっと汚して♡",
        "マーキングして",
        "印つけて…♡",
        "独占して…♡",
        "所有して…♡",
        "体…全部…♡",
        "おねだり…♡",
        "ください…♡",
        "服従します♡",
        "忠誠…♡♡",
    ],

    # receiving_climax: 射精を受ける女性のセリフ（中出し/外出し/懇願）
    "receiving_climax": [
        "あ…出てる…♡♡",
        "中…あつい…♡♡",
        "いっぱい…♡♡♡",
        "あふれ…てる…♡♡",
        "奥…あつい…♡♡",
        "お腹…あったかい♡♡",
        "とまんない…♡♡",
        "ぜんぶ…受け止める♡♡",
        "まだ出てる…♡♡",
        "すごい量…♡♡",
        "中…ドクドク…♡♡♡",
        "あ…感じる…♡♡",
        "注がれてる…♡♡",
        "体の中…♡♡♡",
        "ぬくい…♡♡",
        "溢れちゃう…♡♡",
        "抜かないで…♡♡",
        "もっと…出して♡♡♡",
        "ぜんぶちょうだい♡♡",
        "中に…♡♡♡",
    ],

    # position_change: 体位変更時のリアクション
    "position_change": [
        "え…この体勢…♡",
        "恥ずかし…♡",
        "見えちゃう…♡",
        "あ…深い…♡♡",
        "さっきより…♡♡",
        "角度…やば…♡♡",
        "え…後ろから…♡",
        "上なの…♡",
        "こんな格好…♡",
        "奥…届く…♡♡",
        "あ…当たる…♡♡",
        "全然違う…♡♡",
        "ひろげないで…♡",
        "顔…見ないで…♡",
        "こっちのが…♡♡",
    ],

    # ntr_comparison: NTR比較表現
    "ntr_comparison": [
        "彼より…おっきい…♡♡",
        "こんなの…彼じゃ…♡♡",
        "全然…ちがう…♡♡",
        "彼のじゃ…もう…♡♡",
        "上書き…されちゃう…♡♡",
        "比べちゃだめ…♡♡",
        "彼に…ごめん…♡♡",
        "彼より…すごい…♡♡",
        "もう…戻れない…♡♡",
        "彼のこと…忘れそう…♡♡",
        "知らなかった…こんなの♡♡",
        "体が…覚えちゃう…♡♡",
        "こっちのが…♡♡♡",
        "彼じゃ…足りない…♡♡",
        "もう…あの人じゃ…♡♡",
    ],

    # round2: 2回戦・連続行為
    "round2": [
        "まだするの…♡",
        "もう…3回目…♡♡",
        "体…覚えちゃった…♡♡",
        "さっきより…感じる…♡♡",
        "すぐイっちゃう♡♡",
        "まだ足りないの…♡",
        "もう…立てない…♡♡",
        "休ませて…♡",
        "またイっちゃ…♡♡",
        "何回目…♡♡",
        "体…敏感になって…♡♡",
        "もう…無理なのに…♡♡",
        "すぐイっちゃう…♡♡",
        "また…奥に…♡♡",
        "もう…とまらない…♡♡",
    ],

    # hypnosis: 催眠・洗脳テーマ
    "hypnosis": [
        "はい…♡",
        "わかり…ました…♡",
        "なんでも…します…♡",
        "ぼーっと…♡",
        "ふわふわ…♡",
        "あたま…からっぽ…♡",
        "きもちぃ…♡",
        "言うこと…聞きます♡",
        "逆らえない…♡",
        "ご命令…♡♡",
        "もっと…かけて…♡",
        "とろとろ…♡♡",
        "考えられない…♡",
        "はい…もっと…♡♡",
        "お人形さん…♡",
    ],

    # public: 痴漢・公共場所（声を我慢する状況）
    "public": [
        "声…出せない…",
        "バレちゃう…",
        "こんなとこで…",
        "ん…んぅ…っ",
        "やめ…人が…",
        "だめ…ここ…",
        "誰か来たら…",
        "我慢…しなきゃ…",
        "口…塞いで…",
        "声…漏れちゃ…",
        "静かにしなきゃ…",
        "見られたら…",
        "あ…っ…ん…っ",
        "電車…なのに…",
        "隣の人…気づいて…",
    ],

    # anal: アナル特化リアクション
    "anal": [
        "そこ…違う…",
        "おしり…だめ…",
        "入って…くる…",
        "奥まで…ぁ…",
        "きつい…無理…",
        "変な感じ…",
        "そこやめ…て…",
        "お腹…押される…",
        "抜いて…お願い…",
        "慣れちゃ…だめ…",
        "おかしくなる…",
        "両方は…むり…",
        "ぅあ…広がって…",
        "初めて…なのに…",
        "痛い…けど…",
        "ここも…感じる…",
        "お尻で…イきそ…",
        "壊れちゃう…",
        "もっと奥…♡",
        "お尻…気持ちい♡",
        "そこ…好き…♡",
        "抜かないで…♡",
        "お尻もっと♡♡",
        "ここもう…♡♡",
        "中で…出して♡♡",
    ],

    # degradation: 堕落懇願・自己卑下系
    "degradation": [
        "もっと酷くして",
        "私…壊して…",
        "もう戻れない…",
        "ごめんなさい…♡",
        "使って…ください…",
        "道具でいいから",
        "捨てないで…",
        "何でもします…",
        "もっと…汚して…",
        "惨めにして…♡",
        "ダメな子で…♡",
        "言う通りにする",
        "逆らわない…",
        "全部…受け入れる",
        "恥ずかしい…♡",
        "見られたい…♡",
        "ダメって…知ってる",
        "壊れてもいい…",
        "お願い…もっと♡",
        "ご褒美…ください♡",
        "罰…ください…♡",
        "犬みたいに…♡",
        "堕ちてく…♡♡",
        "もうまともじゃ♡♡",
        "壊れちゃった♡♡",
    ],

    # sibling: 義兄妹/近親系セリフ
    "sibling": [
        "お兄ちゃん…だめ",
        "兄妹なのに…",
        "ばれたら…",
        "お兄ちゃんので…",
        "血繋がってない…",
        "家族なのに…",
        "親に…言えない…",
        "妹で…ごめん…",
        "お兄ちゃん好き…",
        "秘密にして…ね",
        "お姉ちゃん…",
        "義理だから…いい？",
        "こんなの…ダメ…",
        "家で…しないで…",
        "隣の部屋に…",
        "声…聞こえちゃう",
        "お兄…もっと…♡",
        "妹じゃダメ…？♡",
        "一緒のお布団…♡",
        "ずっと好きだった♡",
        "内緒だよ…♡♡",
        "お兄ちゃん♡♡",
        "また…してね♡♡",
        "妹にしてほしい♡♡",
        "一番好き…♡♡",
    ],

    # pain_pleasure: 痛気持ちいい系
    "pain_pleasure": [
        "痛い…っ",
        "いたいのに…きもちぃ…♡",
        "やめ…痛…っ",
        "裂けちゃう…",
        "痛い…けど…♡",
        "なんで…気持ちい",
        "痛いの…好き…",
        "もっと強く…",
        "噛んで…",
        "跡つけて…",
        "乱暴にして…",
        "痛くして…♡",
        "叩いて…♡",
        "締めつけて…",
        "苦しい…けど♡",
        "痛い…のに…♡",
        "泣いちゃう…♡",
        "耐えられ…ない♡",
        "もっと痛くして♡",
        "痛い…好き…♡♡",
        "壊れそう…♡♡",
        "限界…なのに♡♡",
        "痛気持ちい♡♡",
        "涙出ちゃう♡♡",
        "もっともっと♡♡",
    ],

    # double_penetration: 複数挿入リアクション
    "double_penetration": [
        "両方…むり…",
        "二人は…っ",
        "同時に…だめ…",
        "どっちも…ぁ…",
        "体…裂ける…",
        "多すぎ…っ",
        "全部入って…",
        "お腹…いっぱい",
        "前も後ろも…",
        "二本…同時…",
        "頭…おかしく…",
        "もう…限界…",
        "体中…感じる…",
        "全部…埋まって…",
        "挟まれて…",
        "交互に…来る…",
        "同時はやば…♡",
        "二人分…♡♡",
        "もっと…入れて♡",
        "全部受け入れる♡",
        "詰め込んで♡♡",
        "溢れちゃう♡♡",
        "体中…♡♡♡",
        "両方で…イく♡♡",
        "もう…何人でも♡♡",
    ],

    # chikan: 痴漢・公共場所での声を抑える系
    "chikan": [
        "声…出したら…",
        "バレる…っ",
        "ここで…だめ…",
        "もし見られたら…",
        "我慢しなきゃ…",
        "声…漏れちゃう…",
        "聞こえちゃう…",
        "人が…いるのに…",
        "助けて…って…言えない…",
        "足…動かない…",
        "逃げなきゃ…なのに…",
        "声出したら…終わり…",
        "唇…噛んでなきゃ…",
        "外に…聞こえる…",
        "ドアの向こう…人が…",
        "黙ってなきゃ…",
        "バレたら…どうしよ…",
        "泣いたら…気づかれる…",
        "壁…薄いのに…",
        "知らない人に…こんな…",
        "汚い…ここ…嫌…",
        "トイレで…最低…",
        "誰にも…言えない…",
        "こんなとこで…やだ…",
        "足音が…怖い…",
    ],

    # first_time: 初体験リアクション
    "first_time": [
        "優しくして…",
        "痛い…でも…もう少し",
        "入って…る…？",
        "こんなの…知らなかった",
        "奥まで…来てる…",
        "ゆっくり…お願い…",
        "思ってたのと…違う…",
        "怖い…けど…やめないで",
        "血…出てる…？",
        "全部…入った…？",
        "動かないで…まだ…",
        "慣れるまで…待って",
        "少しだけ…動いて…",
        "変な感じ…",
        "奥…押されてる…",
        "初めてが…あなたで…",
        "もっと…奥…行ける…？",
        "痛くない…もう…大丈夫",
        "あ…なんか…気持ちい…",
        "感じてる…♡",
        "ちゃんと…受け止める…",
        "繋がってる…♡",
        "もう少し…激しく♡",
        "初めて…よかった…♡",
        "また…してほしい…♡",
    ],

    # nakadashi: 中出し/妊娠系
    "nakadashi": [
        "中はだめ…！",
        "危ない日なのに…",
        "抜いて…お願い…",
        "中に出されたら…",
        "あふれて…くる…",
        "お腹…あつい…",
        "ゴム…してないのに…",
        "中に…出さないで…",
        "奥に…当たって…",
        "子宮に…来てる…",
        "中で膨らんで…",
        "全部…入ってきた…",
        "抜いて…間に合わない…",
        "中…ドクドクしてる…",
        "お腹いっぱい…",
        "あふれてる…♡",
        "奥まで…注がれて…♡",
        "妊娠しちゃう…♡",
        "中に…もっと…♡",
        "赤ちゃん…できちゃう♡",
        "全部受け止める…♡",
        "子宮で…感じてる…♡♡",
        "注いで…もっと…♡♡",
        "お腹…パンパン…♡♡",
        "何回…出すの…♡♡♡",
    ],

    # water_scene: 水中/入浴シーン
    "water_scene": [
        "お湯の中で…やだ…",
        "水の中なのに…感じる…",
        "滑って…力入らない…",
        "湯気で…見えない…？",
        "お湯が…入ってくる…",
        "浮力で…体が…",
        "お湯のせい…",
        "水着…ずれて…",
        "プールの中で…だめ…",
        "水の音で…ごまかして…",
        "お風呂なのに…",
        "シャワーの音で…",
        "泡で…見えないから…",
        "温泉で…こんなこと…",
        "水面が…揺れちゃう…",
        "湯船から…出られない…",
        "水の中…気持ちい…♡",
        "お湯と…混ざって…♡",
        "ぬるぬる…♡",
        "水音…やらしい…♡",
    ],

    # sleep_react: 半覚醒リアクション
    "sleep_react": [
        "ん…んん…",
        "夢…？",
        "まだ…寝てるのに…",
        "起きちゃ…だめ…",
        "ねむ…い…んん…",
        "なに…してるの…",
        "夢じゃ…ない…？",
        "起きたら…入ってた…",
        "寝てる間に…",
        "声…出ちゃう…",
        "まだ…半分寝て…",
        "体だけ…起きてる…",
        "ぼんやり…してるのに…",
        "意識が…もうろう…",
        "夢の中で…感じてた…",
        "目が…開けられない…",
        "夢だと思って…♡",
        "寝たふり…できない…♡",
        "起きちゃった…♡",
        "朝から…♡",
    ],

    # ojou_formal: お嬢様崩壊
    "ojou_formal": [
        "おやめくださ…あっ",
        "はしたない…わたくし…",
        "お許しを…",
        "声が…出てしまい…",
        "このような…行為…",
        "お父様に…知られたら…",
        "品位が…保てませ…あっ",
        "わたくしが…こんな…",
        "こんな…下品な…",
        "習ってません…",
        "あるまじき…",
        "知りません…こんなの…",
        "使用人に…見られたら…",
        "淑女が…こんな声…",
        "恥ずかしゅう…♡",
        "お許し…くださいま…♡",
        "もっと…おしえてくだ…♡",
        "壊れてしまい…♡",
        "下品で…結構ですわ…♡",
        "お嬢様…やめます…♡♡",
        "もう…敬語…むり…♡♡",
        "ことば…でません…♡♡",
        "いやらしい…♡♡",
        "さらけ出します♡♡♡",
        "壊して…♡♡♡",
    ],

    # fantasy_react: 異世界リアクション
    "fantasy_react": [
        "魔法で…こんな…",
        "こうなの…？",
        "人間の体って…",
        "勇者なのに…",
        "転生したら…こんな…",
        "魔王に…負けたから…",
        "スキルが…効かない…",
        "ステータス…下がってる…",
        "異世界で…処女を…",
        "ギルドに…言えない…",
        "体が…動かない…",
        "触手が…やだ…",
        "モンスターに…こんな…",
        "エルフの体は…敏感で…",
        "回復魔法で…何度も…",
        "奴隷の…紋章が…疼く…",
        "魔力が…吸われて…♡",
        "快楽…すごい…♡",
        "冒険者失格…♡",
        "魔王様…もっと…♡",
        "勇者やめます…♡♡",
        "奴隷で…いいです…♡♡",
        "異世界最高…♡♡",
        "帰りたく…ない…♡♡",
        "レベルアップ♡♡♡",
    ],

    # multi_partner: 複数相手
    "multi_partner": [
        "同時に…むり…",
        "二人とも…やめて…",
        "どっちも…感じちゃう…",
        "交代しないで…",
        "一人ずつ…にして…",
        "前と後ろ…同時に…",
        "三人…相手…むり…",
        "代わる代わる…",
        "休ませて…次の人…",
        "何人目…もう…わかんない…",
        "全員…相手するの…？",
        "終わらない…",
        "二人がかりで…ずるい…",
        "口と…下…同時…",
        "両方…塞がれて…",
        "次から次へと…",
        "もう…何人目…♡",
        "全員…受け止める…♡",
        "まだ…終わらないの…♡",
        "みんなの…♡♡",
        "何回イっても…次が…♡♡",
        "全員分…♡♡",
        "もっと…来て…♡♡",
        "何人でも…♡♡♡",
        "壊れるまで…♡♡♡",
    ],
    # oral_react: フェラ・クンニのリアクション（25エントリー）
    "oral_react": [
        "おっきい…口に…",
        "喉…奥まで…",
        "苦しい…でも…",
        "舌…絡ませて…",
        "味…すごい…",
        "咥えきれない…",
        "のど…きつ…",
        "先っぽ…口の中で…",
        "飲んで…いいの…？",
        "口いっぱい…",
        "ビクってした…♡",
        "舐めるの…恥ずかしい…",
        "こんなに硬い…",
        "喉に…当たって…ん…",
        "顎…疲れた…",
        "奥まで…えずいちゃう…",
        "口から…溢れて…♡",
        "ごくん…♡",
        "ぜんぶ…出して…♡",
        "精液…あつい…♡",
        "喉で…感じる…♡",
        "おくちに…ちょうだい…♡",
        "もっと…奥まで…♡",
        "飲み干した…♡♡",
        "おいしい…♡♡",
    ],
    # afterglow: 余韻・甘え（事後ではなく行為直後の甘い反応）（25エントリー）
    "afterglow": [
        "すき…",
        "あったかい…",
        "なかに…いっぱい…♡",
        "抜かないで…",
        "このまま…♡",
        "心臓…ばくばく…",
        "きもちよかった…♡",
        "離れたくない…",
        "また…してね…",
        "中…あついの…わかる…",
        "ぎゅってして…",
        "幸せ…♡",
        "夢じゃないよね…",
        "もう一回…だめ…？",
        "腰…まだ震えてる…",
        "とろけちゃった…♡",
        "出されたの…わかる…♡",
        "いっぱい…注がれた…♡",
        "離れないで…♡",
        "まだ…ドキドキしてる…",
        "こんなの…初めて…",
        "寝たい…このまま♡",
        "全身…ぽかぽか…♡",
        "涙出た…♡",
        "このままがいい♡",
    ],
    # teasing: からかい・挑発（25エントリー）
    "teasing": [
        "そんなに見たいの…？",
        "もう固くなってる…♡",
        "焦んないでよ…",
        "触りたいんでしょ…♡",
        "おあずけ…♡",
        "ここ…触ってほしいの…♡",
        "我慢できないんだ…♡",
        "ねぇ…こっち見て…♡",
        "どこから…する…？",
        "脱がせてよ…♡",
        "ブラ…外していいよ…♡",
        "もっと…じらして…",
        "まだ…入れちゃだめ…♡",
        "欲しがり…♡",
        "えっち…♡",
        "濡れてるの…♡",
        "反応…かわいい…♡",
        "触るだけ…だからね…？",
        "もう限界でしょ…♡",
        "先っぽだけ…♡",
        "ねぇ…欲しくないの…？♡",
        "もっと…おねだりして…♡",
        "いじわる…されたい…♡",
        "もう…入れていいよ…♡♡",
        "全部…あげる…♡♡",
    ],
    # size_react: サイズ反応（20エントリー）
    "size_react": [
        "おっきい…",
        "入る…の…？",
        "むり…こんなの…",
        "裂ける…っ",
        "お腹…出っ張って…",
        "奥…突き上げられ…",
        "太い…♡",
        "いっぱい…いっぱい…",
        "奥まで…届いてる…♡",
        "お腹…ぽこって…♡",
        "形…わかる…♡",
        "きつい…でも…♡",
        "ぱんぱんに…♡",
        "中…広げられ…♡",
        "子宮…押されてる…♡",
        "こんなの…初めて…♡♡",
        "壊れちゃう…♡♡",
        "奥…突かれて…♡♡",
        "全部…入った…♡♡",
        "もう…抜けない…♡♡",
    ],
    # anger: 怒り反応（20エントリー）
    "anger": [
        "ふざけんな…",
        "殺す…",
        "最低…っ",
        "地獄に落ちろ…",
        "覚えてろ…",
        "触んな…っ",
        "ぶっ殺す…",
        "死ね…",
        "クズ…",
        "許さない…",
        "気持ち悪い…",
        "汚い…",
        "二度と近寄んな…",
        "恨んでやる…",
        "この…変態…",
        "バカにすんな…",
        "なめんな…",
        "ちくしょう…",
        "あんたなんか…",
        "いつか…絶対…",
    ],
    # praise_react: 褒められリアクション（20エントリー）
    "praise_react": [
        "そんなこと…言わないで…",
        "恥ずかしい…っ",
        "嘘…",
        "お世辞…でしょ…",
        "見ないで…そんな目で…",
        "なにも出ないよ…",
        "やだ…照れる…",
        "そういうの…弱い…",
        "嬉しい…♡",
        "もっと…言って…♡",
        "ほんと…？♡",
        "力…抜ける…♡",
        "その声で…言われたら…♡",
        "えっちな目…♡",
        "そこ…褒めないで…♡♡",
        "いい子って…言って…♡",
        "もっと…見て…♡♡",
        "褒めて…もっと…♡♡",
        "締まっちゃう…♡♡",
        "好きって…言って…♡♡",
    ],
    # bondage_react: 拘束リアクション（20エントリー）
    "bondage_react": [
        "手…動かせない…",
        "縛らないで…",
        "痛い…きつい…",
        "逃げられない…",
        "外して…お願い…",
        "目隠し…怖い…",
        "見えない…何するの…",
        "身動きできない…",
        "こんな格好…やだ…",
        "吊られて…足つかない…",
        "縄…食い込んで…",
        "力入んない…",
        "好きにして…もう…",
        "抵抗…できない…♡",
        "感じちゃう…♡",
        "全部…されるがまま…♡",
        "拘束…感じやすい…♡",
        "興奮する…♡♡",
        "もっと…きつく縛って…♡♡",
        "縛られてイく…♡♡♡",
    ],
    # paizuri_react: パイズリリアクション（20エントリー）
    "paizuri_react": [
        "挟まってる…♡",
        "大きい…胸の間…",
        "こんなので…♡",
        "先っぽ…見える…♡",
        "胸で…気持ちいい？♡",
        "動くよ…♡♡",
        "ぬるぬる…してきた…♡",
        "挟むの…恥ずかしい…",
        "出していいよ…♡",
        "こぼれちゃう…♡",
        "もっと押しつけて…♡",
        "硬い…胸の間で…♡",
        "ここ…気持ちいい？",
        "谷間…すごいことに…♡",
        "びくびくしてる…♡♡",
        "舐めながら…♡♡",
        "もっと挟んであげる♡",
        "おっぱいで…イって♡",
        "ぎゅってする…♡♡",
        "いっぱい出して…♡♡",
    ],
    # anal_react: アナルリアクション（20エントリー）
    "anal_react": [
        "そこだめ…っ",
        "お尻はやだ…",
        "変な感じ…♡",
        "入って…きてる…",
        "お尻…壊れちゃう…",
        "やだ…そこ汚い…",
        "ぬるぬる…入ってく…",
        "きつい…抜いて…",
        "お尻で感じるの…♡",
        "だめ…変になる…♡",
        "奥まで…来てる…",
        "両方はだめ…♡♡",
        "お尻…開いちゃう…",
        "慣れてきちゃった…♡",
        "そこ気持ちいい…♡♡",
        "お尻…ひくひく…♡",
        "抜かないで…♡♡",
        "中…熱い…♡♡",
        "もっと奥…♡♡♡",
        "お尻でイっちゃう…♡♡",
    ],
    # footjob_react: 足コキリアクション（15エントリー）
    "footjob_react": [
        "足で…するの？",
        "ぬるぬる…♡",
        "足の裏…熱い…",
        "挟んだら…動いてる…",
        "こんなので感じるの…",
        "足…汚れちゃう…♡",
        "指の間…入ってきた…",
        "ぐにぐにする…♡",
        "足で…イかせるの？♡",
        "太もも…挟むね♡",
        "つま先で…いい？♡",
        "すべすべでしょ…♡",
        "足…びくってした♡",
        "足の裏で感じて…♡",
        "もっと挟んであげる♡",
    ],
    # toy_react: 玩具リアクション（20エントリー）
    "toy_react": [
        "やだ…これ…♡",
        "取って…♡",
        "中で動いて…♡",
        "振動…やば…♡♡",
        "止めて…止めて…♡",
        "スイッチ切って…♡",
        "入れたまま…だめ…♡",
        "ぶるぶるして…♡♡",
        "おかしくなる…♡♡",
        "電源…消して…♡",
        "強くしないで…♡♡",
        "これ以上は…♡♡",
        "抜けない…♡♡♡",
        "お腹の中…♡♡",
        "もう無理…止めて…♡",
        "慣れてきちゃ…♡♡",
        "ここに当てないで…♡",
        "最大にしないで…♡♡",
        "頭…ぼーっとする…♡",
        "壊れちゃう…♡♡♡",
    ],
    # fingering_react: 手マンリアクション（20エントリー）
    "fingering_react": [
        "指…だめ♡",
        "中かき回さないで",
        "そこ…っ♡",
        "濡れてない…♡",
        "奥…触らないで…♡",
        "指…増やさないで…",
        "くちゅくちゅ…やだ…♡",
        "そこ当たって…♡♡",
        "指だけで…だめ…♡",
        "広げないで…♡",
        "中…ぐちゅって…♡",
        "もっと…奥…♡♡",
        "指…曲げないで…♡♡",
        "ぬるぬるしてきた…♡",
        "何本…入れるの…♡",
        "そこ…弱い…♡♡",
        "掻き回さないで…♡♡",
        "音…立てないで…♡",
        "指で…イっちゃう…♡♡",
        "もうとろとろ…♡♡♡",
    ],
    # deepthroat_react: イラマチオリアクション（15エントリー）
    "deepthroat_react": [
        "んぐっ…苦し…",
        "喉…奥まで…",
        "息…できない…",
        "おえっ…やだ…",
        "抜いて…苦し…",
        "涙…出ちゃう…",
        "口…いっぱい…",
        "喉…痛い…",
        "鼻で…息…",
        "顔…ぐちゃぐちゃ…",
        "頭…押さないで…",
        "唾液…垂れちゃう…",
        "喉奥…当たって…",
        "顎…疲れた…",
        "もう…入んない…",
    ],
    # cum_react: 射精受けリアクション（20エントリー）
    "cum_react": [
        "中はだめ…♡",
        "あったかい…♡",
        "いっぱい…出てる…♡",
        "お腹…熱い…♡",
        "溢れてきた…♡♡",
        "中に…出されちゃった♡",
        "抜かないで…まだ…♡",
        "顔に…かけないで…",
        "飲むから…♡♡",
        "とろとろ…出てくる…♡",
        "子宮に…当たって…♡♡",
        "全部…受け止める…♡",
        "垂れてきた…♡♡",
        "まだ出てる…♡♡♡",
        "お腹ぱんぱん…♡♡",
        "奥で…どくどく…♡♡",
        "ぜんぶ出して…♡♡",
        "こんなに…いっぱい…♡",
        "中…ぎゅってなる…♡",
        "抜いたら…こぼれる♡♡",
    ],
    # multiple_orgasm: 連続絶頂リアクション（20エントリー）
    "multiple_orgasm": [
        "またイく…♡♡",
        "何回目…♡",
        "もうやだ…止まんない♡",
        "また…きちゃう…♡♡",
        "休ませて…♡♡",
        "連続で…だめ…♡♡",
        "もう…数えられない♡",
        "頭おかしくなる…♡♡",
        "イきっぱなし…♡♡♡",
        "もう立てない…♡♡",
        "まだイくの…♡♡♡",
        "止まんないの…♡♡",
        "壊れちゃう…♡♡♡",
        "何回…イかせるの…♡",
        "もう無理なのに…♡♡",
        "体…びくびくして…♡♡",
        "終わんない…♡♡♡",
        "ずっとイってる…♡♡",
        "意識…飛びそう…♡♡",
        "もう…許して…♡♡♡",
    ],
}


# テーマ親和度マップ（カテゴリ×テーマ → 0.0-1.0）
# affinity >= 0.7 → 全量追加, >= 0.4 → 半量追加, < 0.4 → 追加しない
SPEECH_FEMALE_THEME_AFFINITY = {
    "denial":           {"forced": 0.9, "reluctant": 0.9, "bondage": 0.8, "vanilla": 0.3, "love": 0.2},
    "embarrassed":      {"vanilla": 0.8, "love": 0.7, "first_time": 0.9, "sibling": 0.8, "forced": 0.4},
    "plea":             {"forced": 0.8, "reluctant": 0.8, "bondage": 0.7, "vanilla": 0.5, "love": 0.4},
    "acceptance":       {"love": 0.9, "vanilla": 0.9, "ntr": 0.6, "corruption": 0.7, "forced": 0.2},
    "ecstasy":          {"love": 0.7, "vanilla": 0.7, "corruption": 0.8, "ntr": 0.7, "forced": 0.4},
    "post":             {"love": 0.8, "vanilla": 0.8, "ntr": 0.5, "forced": 0.3},
    "provoke":          {"love": 0.6, "teasing": 0.9, "vanilla": 0.5, "ntr": 0.7, "forced": 0.2},
    "insertion":        {"vanilla": 0.7, "love": 0.7, "first_time": 0.9, "forced": 0.5},
    "beg":              {"forced": 0.7, "reluctant": 0.7, "love": 0.5, "bondage": 0.8},
    "submissive":       {"training": 0.9, "bondage": 0.8, "hypnosis": 0.8, "forced": 0.6, "love": 0.3},
    "receiving_climax": {"love": 0.7, "vanilla": 0.7, "ntr": 0.8, "corruption": 0.8},
    "position_change":  {"vanilla": 0.6, "love": 0.6, "forced": 0.4},
    "ntr_comparison":   {"ntr": 1.0, "love": 0.1},
    "hypnosis":         {"hypnosis": 1.0, "corruption": 0.6},
    "public":           {"public": 1.0, "chikan": 0.9, "idol": 0.7},
    "anal":             {"anal": 1.0, "training": 0.6, "forced": 0.5},
    "degradation":      {"training": 0.9, "forced": 0.7, "corruption": 0.8, "love": 0.1},
    "sibling":          {"sibling": 1.0, "stepfather": 0.7, "love": 0.3},
    "pain_pleasure":    {"forced": 0.8, "training": 0.8, "bondage": 0.9, "anal": 0.7, "love": 0.3},
    "double_penetration": {"gangbang": 0.9, "training": 0.6},
    "chikan":           {"chikan": 1.0, "public": 0.8},
    "first_time":       {"first_time": 1.0, "vanilla": 0.6, "love": 0.7},
    "nakadashi":        {"love": 0.7, "vanilla": 0.7, "ntr": 0.8, "corruption": 0.6, "forced": 0.5},
    "water_scene":      {"onsen": 1.0, "swimsuit": 0.9},
    "sleep_react":      {"sleep": 1.0},
    "ojou_formal":      {"ojou": 1.0},
    "fantasy_react":    {"isekai": 1.0, "fantasy": 0.9},
    "multi_partner":    {"gangbang": 1.0},
    "oral_react":       {"vanilla": 0.6, "forced": 0.5, "training": 0.7},
    "afterglow":        {"love": 0.9, "vanilla": 0.8, "ntr": 0.4},
    "teasing":          {"love": 0.7, "vanilla": 0.6, "teasing": 0.9},
    "size_react":       {"vanilla": 0.6, "first_time": 0.8, "love": 0.5},
    "anger":            {"forced": 0.9, "reluctant": 0.8, "love": 0.1},
    "praise_react":     {"love": 0.8, "vanilla": 0.7},
    "bondage_react":    {"bondage": 1.0, "training": 0.7, "forced": 0.6},
    "paizuri_react":    {"vanilla": 0.6, "love": 0.5, "training": 0.5},
    "anal_react":       {"anal": 1.0, "training": 0.7},
    "footjob_react":    {"vanilla": 0.5, "training": 0.6},
    "toy_react":        {"training": 0.9, "bondage": 0.7},
    "fingering_react":  {"vanilla": 0.7, "love": 0.6, "first_time": 0.8},
    "deepthroat_react": {"forced": 0.8, "training": 0.7},
    "cum_react":        {"love": 0.6, "ntr": 0.8, "vanilla": 0.6, "corruption": 0.7},
    "multiple_orgasm":  {"training": 0.8, "corruption": 0.8, "ntr": 0.7, "love": 0.5},
    "round2":           {"love": 0.7, "vanilla": 0.7, "ntr": 0.6, "corruption": 0.7, "training": 0.5},
}


def _extend_with_affinity(pool: list, category: str, theme_key: str, full_list: list):
    """SPEECH_FEMALE_THEME_AFFINITYに基づいてプールを拡張"""
    affinity_map = SPEECH_FEMALE_THEME_AFFINITY.get(category, {})
    score = affinity_map.get(theme_key, 0.0)
    if score >= 0.7:
        pool.extend(full_list)
    elif score >= 0.4:
        pool.extend(full_list[::2])  # 半量（偶数インデックスのみ）


# ============================================================================
# 心の声プール（テーマ別）
# ============================================================================
THOUGHT_POOL = {
    # general: 汎用（70エントリー - 感覚・感情が主語。部位ラベル冒頭禁止）
    "general": [
        "やば…",
        "なにこれ…",
        "おかしい…",
        "真っ白…なにも…",
        "嘘でしょ…",
        "うそ…でしょ…",
        "ふわふわする…",
        "止まらない…",
        "変になる…",
        "どしよ…",
        "感じすぎ…",
        "こんなの初めて",
        "声…出ちゃう",
        "やばいやばい",
        "もうだめかも",
        "なんで…",
        "こわい…",
        "くらくらする…",
        "理性が…",
        "意識が…",
        "知らない…",
        "嫌なのに…",
        "勝手に…動いちゃう",
        "なにも…わかんない",
        "ぐちゃぐちゃ",
        "溶ける…",
        "力が…抜ける",
        "目の前が…",
        "奥がきゅって…",
        "全身…びりびり",
        "何されてるの",
        "わからない…",
        "息ができない",
        "ぼーっとする…",
        "力…入んない…",
        "聞こえてる…",
        "ぐるぐるする…",
        "熱い…中が…",
        "ふるえ…てる",
        "思考が…飛ぶ",
        "深い…奥まで",
        "痺れてる…",
        "ドキドキ…はやい…",
        "声が…勝手に",
        "あつい…中から…",
        "ぐらぐらする…",
        "ぞくっとした…",
        "うそ…これ…",
        "呼吸が…乱れ",
        "限界…近い…",
        # v3.5追加: 多様な先頭パターン（だめ/やだ以外）
        "こんな声…",
        "勝手に…うごく…",
        "とまんない…",
        "ぞくぞくする…",
        "奥…響いてる",
        "もう…わかんない",
        "ぐるぐる…",
        "びくってした…",
        "ぴくぴくする…",
        "あたし…変…",
        "なんか…へん…",
        "ずっと…ずっと…",
        "ここ…弱い…",
        "震えてる…",
        "視界が…ぼやけ",
        "なにも聞こえない…",
        "とけちゃう…",
        "言うこときかない…",
        "がくがくする…",
        "きゅってなる…",
        "つま先まで…",
    ],

    # awakening: 快感覚醒・目覚め（初体験/初感覚の新鮮な反応）
    "awakening": [
        "はじめての…感覚",
        "知らない…感覚",
        "こんなの初めて",
        "体が…変…",
        "怖い…きもちいい",
        "なんか…へん…",
        "もっと…欲しい…",
        "止められない…",
        "初めて…こんな",
        "どうなってるの",
        "意思と…違う…",
        "熱い…中から…",
        "目覚めちゃう…",
        "スイッチ入った",
        "もう戻れない…",
        "知っちゃった…",
        "こんな気持ち…",
        "体が…震えて…",
        "火がついた…",
        "もっと知りたい",
        "新しい感覚…",
        "ぞくぞく…する",
        "覚えちゃう…",
        "奥が…疼く…",
        "全身が…敏感…",
        "理性が…溶ける",
        "抑えられない…",
        "体が…求めてる",
        "頭が…ぼうっと",
        "壊れちゃう…",
    ],

    # body_awareness: 身体感覚実況型（エロ漫画のリアルタイム体感描写）
    # body_awareness: 感覚実況型（感覚が主語。部位ラベル「胸…」「太もも…」冒頭禁止）
    "body_awareness": [
        "奥に…当たって…",
        "熱い…お腹の中…",
        "ぎゅって…なる…",
        "勝手に…腰が…",
        "開いてく…奥が…",
        "全部…敏感…",
        "ビリビリする…",
        "ゾクって…した…",
        "ピクって…した…",
        "力…入んない…",
        "ぐちゃぐちゃ…",
        "奥が…疼いて…",
        "広がってく…",
        "ここ…弱い…ダメ…",
        "熱くなってく…",
        "きゅって…なる…",
        "立てない…",
        "音が…とおい…",
        "ぼやけて…る…",
        "とけてく…",
    ],

    # contradiction: 矛盾型（口と心の乖離）
    "contradiction": [
        "嫌なのに…体が…",
        "なんで気持ちいいの",
        "こんなの嫌…でも…",
        "ダメって言いたいのに",
        "嫌いなのに体は…",
        "抵抗したいのに…",
        "頭は拒否してるのに",
        "泣いてるのに感じて",
        "怒ってるはずなのに",
        "許せないのに…体が",
        "最低…なのに止まらん",
        "認めたくない…けど",
        "こんな奴に…なのに",
        "拒否してるのに腰が",
        "声が…勝手に…嘘…",
    ],

    # self_surprise: 感じてしまう自分への驚き
    "self_surprise": [
        "嘘…感じてる…",
        "なんで…こんなので",
        "ありえない…反応して",
        "こんなの…初めて…",
        "自分の声…信じれない",
        "え…なに…この感じ",
        "嘘でしょ…体が…",
        "おかしい…こんなはず",
        "なんでこんなに…",
        "私の体…どうなって",
        "止められない…なんで",
        "敏感すぎる…なんで",
        "信じたくない…でも",
        "こんなので…イきそう",
        "体が正直すぎて…",
        "わからない…この感覚",
        "知らなかった…こんな",
        "声が…出ちゃう…嘘",
        "反応してる…嫌なのに",
        "認めたくないけど…",
    ],

    # hypnosis: 催眠・洗脳テーマの心の声
    "hypnosis": [
        "あれ…わたし…なにして…",
        "頭の中…ぼんやり…",
        "逆らえない…なんで…",
        "体が…勝手に…",
        "意識が…遠く…",
        "考えがまとまらない…",
        "なんで…言いなりに…",
        "ふわふわして…気持ちいい…",
        "目が…覚めない…",
        "声が…自分のじゃない…",
        "止まれない…体が…",
        "おかしい…でも…きもちぃ…",
        "わかってるのに…動けない…",
        "あたま…とろとろ…",
        "気づいたら…こんなことに…",
        "夢みたい…でも…",
        "抵抗しなきゃ…でも…",
        "操られてる…のに…",
        "目が合うと…従いたく…",
        "もう…自分じゃない…",
    ],

    # public: 痴漢・公共場所の心の声
    "public": [
        "声出しちゃだめ…",
        "バレたらどうしよう…",
        "なんでこんなとこで…",
        "周りの人…気づいてない…？",
        "叫びたい…でも…",
        "誰か…助けて…",
        "降りなきゃ…でも…体が…",
        "隣の人…こっち見てる…？",
        "我慢…我慢…っ",
        "顔に出てる…絶対…",
        "足が…震えてる…バレる…",
        "こんなとこで…感じちゃ…",
        "止まらない…ここなのに…",
        "息…荒くなってる…",
        "次の駅まで…持たない…",
    ],

    # forced: 強制・暴行テーマ専用
    "forced": [
        "やめて…",
        "離して…",
        "いたい…のに…",
        "なんで…あたし…",
        "たすけて…",
        "こんなの…嫌…",
        "体が…裏切る",
        "やだ…感じて…",
        "抵抗できない…",
        "力が…入らない",
        "逃げたいのに…",
        "怖い…でも…",
        "声…出さない…",
        "誰か…たすけ…",
        "嫌なのに体が…",
        "頭は拒否…でも",
        "涙…止まらない",
        "動けない…",
        "こんな場所で…",
        "屈辱的…",
        "なのに腰が…",
        "悔しい…",
        "こんな奴に…",
        "惨めだ…",
        "なんで反応…",
        "勝手に濡れて…",
        "心は拒否してる",
        "もう…耐えられ",
        "体だけ…勝手に",
        "やだ…やだよ…",
    ],

    # ntr: NTR・寝取られ
    "ntr": [
        "彼より…",
        "もう…戻れない",
        "ごめん…",
        "彼氏に…",
        "ごめんね…",
        "嫌いなのに…",
        "こんな男に…",
        "負けてる…",
        "彼を裏切って",
        "最低だ…私",
        "バレたら…",
        "でも止めらん",
        "比べちゃだめ",
        "彼で満足…",
        "嘘…こっちが",
        "こんな体に…",
        "彼の前では…",
        "知られたら…",
        "もう彼には…",
        "浮気…してる",
        "私…最低…",
        "全然違う…",
        "慣れちゃった",
        "彼じゃだめ…",
        "ごめん…好き",
        "覚えちゃってる…",
        "彼に申し訳…",
        "ほんとは嫌…",
        "なのに体が…",
        "待ってる人が",
        "彼の顔が浮ぶ",
        "忘れたい…",
        "裏切り者だ…",
        "帰りたい…",
        "でも…気持ち…",
        "約束したのに",
        "上書きされる",
        "もう嘘つけない",
        "彼には見せれ",
        "この体…汚い",
        "なのに求めて",
        "どっちが本当",
        "元に戻れない",
        "秘密が増える",
        "彼より深く…",
        "合わせる顔が",
        "染まっていく",
        "隠し通せない",
        "もう正妻面…",
        "消えない記憶",
    ],

    # vanilla: 純愛
    "vanilla": [
        "好き…",
        "幸せ…",
        "ずっと一緒…",
        "大好き…",
        "嬉しい…",
        "あったかい…",
        "繋がってる…",
        "いかないで…",
        "愛してる…",
        "もっと近くに",
        "夢みたい…",
        "安心する…",
        "いっぱい…",
        "溶けちゃう…",
        "もっとほしい",
        "ずっとこのまま",
        "とろけちゃう…",
        "一つになれた",
        "きゅんとする",
        "宝物みたい",
        "触れてほしい",
        "包まれてる…",
        "あなたの匂い",
        "みたされてく…",
        "世界で一番…",
        "居場所がある",
        "温もりが好き",
        "ここが安全…",
        "全部あげたい",
        "二人だけの…",
        "時間止まって",
        "もっと深く…",
        "声聞きたい…",
        "名前呼んで…",
        "涙が出そう…",
        "抱きしめたい",
        "この人だけ…",
        "ぜんぶ…触れてる",
        "唇が離せない",
        "ドキドキ…聞こえちゃう",
        "ぜんぶ受け止",
        "ずっと感じて",
        "甘い匂い…",
        "一緒に…いたい",
        "守ってくれる",
        "同じ気持ち…",
        "特別な夜…",
        "最高に幸せ",
        "ここにいたい",
        "あふれてくる…",
    ],

    # corruption: 堕落・快楽落ち
    "corruption": [
        "もう…壊れる",
        "従いたい…",
        "もっと欲しい",
        "堕ちてく…",
        "快楽に…負けた",
        "もう…だめ…",
        "頭おかしく…",
        "中が…疼いて…",
        "欲しくて…",
        "めちゃくちゃに…",
        "もう…どうでも",
        "なんでもいいから",
        "支配されたい",
        "私…変態…",
        "止められない",
        "もっとください",
        "依存してる…",
        "逆らえない…",
        "言いなりに…",
        "ご主人様…",
        "お願い…もっと",
        "壊して…",
        "ぜんぶ…堕ちた",
        "心も…堕ちた",
        "もう普通に…",
        "快楽しか…",
        "ぐちゃぐちゃ…もう",
        "自分じゃない",
        "理性なんか…",
        "恥も捨てた…",
        "おかしくなる",
        "もう獣みたい",
        "なんも考えらんない",
        "人でなくなる",
        "こんな姿…",
        "もっと壊して",
        "戻りたくない",
        "全部…どうでも",
        "中毒になった",
        "考えるのやめ",
        "抵抗…無意味",
        "最低…でも好き",
        "何回でも…",
        "飼われたい…",
        "どこまで堕ち",
        "快感が正義…",
        "プライドなんか",
        "溺れていたい",
        "帰れなくなる",
        "もう…家畜…",
    ],

    # reluctant: 不本意な感覚
    "reluctant": [
        "嫌なはず…",
        "なんで感じて",
        "認めたくない",
        "こんなの嫌…",
        "体が裏切る…",
        "抵抗してるの",
        "拒否したいの",
        "感じちゃだめ",
        "嫌いなのに体",
        "望んでない…",
        "受け入れない",
        "でも…熱い…",
        "気持ちよくない",
        "嘘…反応して",
        "本心じゃない",
        "頭は拒否して",
        "屈しない…",
        "心は嫌がって",
        "嫌…でも体が",
        "泣きたい…",
        "なのに腰が…",
        "悔しい…",
        "こんな反応…",
        "感じるなんて",
        "勝手に声が…",
        "許せない…体",
        "否定したいの",
        "惨めだ…",
        "誰かのせいで",
        "嫌だ…好きに",
        "心が追いつか",
        "なぜ濡れて…",
        "嘘よ…こんな",
        "腰が勝手に…",
        "拒絶してるの",
        "意思と反対に",
        "涙が止まらな",
        "こんな体嫌…",
        "負けたくない",
        "でも…声が…",
    ],

    # jealousy: 嫉妬・独占欲
    "jealousy": [
        "他の人には…",
        "私だけの…",
        "見ないで…他の人",
        "渡さない…",
        "独り占めしたい",
        "嫉妬してる…",
        "他の女と…？",
        "取られたく…",
        "私じゃ…ダメ？",
        "浮気…許さない",
        "離れたくない…",
        "他に行かないで",
        "私だけ見てて",
        "全部…私のもの",
        "奪い返す…",
        "消えればいいのに",
        "独占したい…",
        "誰にも渡さない",
        "ずっと一緒に…",
        "私以外…知らない",
    ],

    # submission: 服従・Mの自覚
    "submission": [
        "従うしか…ない",
        "逆らえ…ない",
        "言われた通りに",
        "もう…抵抗できな",
        "従うの…好き…",
        "支配されてる…",
        "命令して…",
        "ご主人様の…",
        "奴隷みたい…",
        "飼われてる…",
        "もう自分じゃ…",
        "操られてる…",
        "言いなり…",
        "服従が…気持ちい",
        "逆らう気…ない",
        "もっと縛って…",
        "自由いらない…",
        "この人の…もの",
        "何でもする…",
        "壊されたい…",
    ],

    # pain_pleasure: 痛みと快感の混在（思考）
    "pain_pleasure": [
        "痛いのに…なぜ",
        "痛みが…快感に",
        "おかしい…痛いの",
        "体が…間違えて",
        "痛いのに濡れて",
        "泣いてるのに…",
        "苦しいのに求め",
        "壊れる…のに…",
        "限界超えてる…",
        "痛みが…癖に…",
        "正常じゃない…",
        "なんで気持ちい",
        "涙と快感が…",
        "痛みなしじゃ…",
        "体がおかしく…",
        "痛い方が…いい",
        "もう普通じゃ…",
        "何されても…",
        "快感と区別が…",
        "壊れてく…♡",
    ],

    # sibling_guilt: 近親の罪悪感
    "sibling_guilt": [
        "兄妹なのに…",
        "家族として…ダメ",
        "親にバレたら…",
        "こんなの普通じゃ",
        "血の繋がり…",
        "義理でも…家族…",
        "罪悪感が…",
        "いけない事…",
        "誰にも言えない",
        "家族を裏切って",
        "でも…好きだから",
        "兄妹じゃなければ",
        "許されない関係",
        "隠さなきゃ…",
        "普通の兄妹には",
        "戻れない…もう",
        "禁断って…分かっ",
        "罪深い…でも…",
        "この気持ちは…",
        "秘密にしなきゃ",
    ],

    # public_shame: 公共場所での羞恥・恐怖の心理
    "public_shame": [
        "外に聞こえてる…",
        "バレたら…人生終わる…",
        "こんなとこで…最低…",
        "声…抑えなきゃ…",
        "誰かに見られたら…",
        "足音…近づいてる…",
        "助けを呼びたい…でも…",
        "こんな姿…誰にも…",
        "涙が…止まらない…",
        "トイレの匂い…最悪…",
        "知らない人に…犯されてる…",
        "汚い手で…触られて…",
        "逃げ出したい…のに体が…",
        "ドアが開いたら…",
        "誰か来て…でも来ないで…",
        "こんなとこで感じるなんて…",
        "壁越しに…人がいる…",
        "声出したら…終わり…",
        "恥ずかしい…のに…体が…",
        "もう…元に戻れない…",
    ],

    # chikan_resistance: 痴漢への抵抗・葛藤の心理
    "chikan_resistance": [
        "体が…動かない…",
        "怖い…のに…感じて…",
        "嫌なのに…声が…",
        "抵抗しなきゃ…",
        "なんで…力入らない…",
        "こんなおじさんに…",
        "汚い…触らないで…",
        "助けて…誰か…",
        "手が…止められない…",
        "なんで…濡れてるの…",
        "嫌…なのに…体は…",
        "逃げなきゃ…脚が…",
        "どうして…抵抗できない…",
        "知らない男に…",
        "最低…なのに体が…",
        "押し返せない…",
        "力の差が…",
        "男の人の手…大きくて…",
        "こんなの初めて…やだ…",
        "怖い…でも…声が…",
    ],

    # first_time_thought: 初体験心理
    "first_time_thought": [
        "初めて…なのに…感じる…",
        "これが…大人の…",
        "想像と全然違う…もっと…",
        "本で読んだのと…違う…",
        "こんなに…大きいの…入るの…",
        "痛いはずなのに…気持ちい…",
        "体が…自分のじゃないみたい",
        "初めてを…この人に…",
        "もう…後戻りできない…",
        "大人になっちゃった…",
        "友達に…言えない…",
        "こんなに…気持ちいいなんて…",
        "怖いけど…もっと欲しい…",
        "知らない自分が…出てくる…",
        "体の奥が…疼いてる…",
        "処女じゃ…なくなった…",
        "初めてが…こんな形で…",
        "もっと…早く知りたかった…",
        "次は…自分から…したい…",
        "体が…覚えちゃった…",
    ],

    # water_thought: 水中/入浴心理
    "water_thought": [
        "お湯の中で…こんなこと…",
        "湯船の中なのに…体が反応してる",
        "水着…ずれてる…",
        "水の中…バレない…はず…",
        "お湯と…あの液…混ざって…",
        "水中で…声出せない…",
        "温泉に来ただけなのに…",
        "シャワーの音に…紛れて…",
        "プールで…まさか…",
        "水の浮力で…体が勝手に…",
        "裸で…逃げられない…",
        "お風呂場だから…密室…",
        "水蒸気で…ぼんやりして…",
        "水温のせいで…体が火照って…",
        "濡れてるのは…お湯のせい…嘘…",
        "水着の隙間から…",
        "海の中で…こんなことされたら…",
        "湯あたり…じゃない…これ…",
        "お湯が…中に…入ってくる…",
        "水の音が…いやらしく聞こえる…",
    ],

    # sleep_thought: 半覚醒心理
    "sleep_thought": [
        "夢…？現実…？",
        "寝てるふりを…したほうが…",
        "体が…勝手に反応してる…",
        "起きたら…終わるかな…",
        "意識がもうろうとして…",
        "寝ぼけてるのに…感じてる…",
        "目を開けたら…怖い…",
        "夢の中みたいに…気持ちい…",
        "起きてること…バレたかな…",
        "寝息…合わせなきゃ…",
        "体は正直に…反応して…",
        "起きたいのに…体が動かない…",
        "こんな時間に…誰が…",
        "布団の中で…手が…",
        "眠いのに…体が熱い…",
        "朝まで…このまま…？",
        "目覚ましが…鳴る前に…",
        "夢だと思えば…いいの…？",
        "寝てる間に…全部されてた…",
        "起きたくない…このまま…",
    ],

    # pleasure_denial: 快感否定の内心（20エントリー）
    "pleasure_denial": [
        "気持ちよくない…嘘…",
        "感じてない…感じてないのに…",
        "こんなの…ただの刺激…",
        "体が…勝手に…心は拒否してる…",
        "認めたくない…でも…",
        "気のせい…気のせいだから…",
        "演技…してるだけ…",
        "こんな男に…感じるわけない…",
        "嘘…体が裏切ってる…",
        "頭では嫌なのに…下が…",
        "これは反射…ただの反射…",
        "感じるわけない…こんなことで…",
        "嘘…こんなの…嘘…",
        "体が嘘つき…嫌なのに…",
        "認めた瞬間…終わる…",
        "快感じゃない…痛みのせい…",
        "声が…出るのは…苦しいから…",
        "濡れてるのは…違う理由…",
        "こんなので…イくはずない…",
        "感じてるって…思いたくない…",
    ],

    # addiction: 快感中毒・依存（20エントリー）
    "addiction": [
        "また…欲しくなってる…",
        "一回じゃ…足りない…",
        "体が…覚えちゃったから…",
        "あの快感が…忘れられない…",
        "中毒みたい…また…したい…",
        "普通のじゃ…もう満足できない…",
        "自分で触っても…あれには…",
        "毎日…考えてしまう…",
        "体が…勝手に求めてる…",
        "やめられない…止まらない…",
        "あの感覚…また味わいたい…",
        "依存してる…完全に…",
        "禁断症状…みたい…",
        "他のことが…手につかない…",
        "あの人の…じゃないと…",
        "もっと…もっと強いの…",
        "一日我慢しただけで…こんなに…",
        "体が…あの形を覚えてる…",
        "堕ちた…完全に…",
        "もう…戻れないんだ…",
    ],

    # rage: 怒りの内心（15エントリー）
    "rage": [
        "絶対…許さない…",
        "殺してやる…いつか…",
        "クズが…覚えてろ…",
        "復讐…してやる…",
        "なんで…あたしが…",
        "こいつ…地獄に…",
        "悔しい…殺したいくらい…",
        "泣くもんか…負けてたまるか…",
        "あたしの体…勝手に…汚すな…",
        "いつか…立場逆転させてやる…",
        "怒りで…震えてるのに…",
        "この屈辱…忘れない…",
        "歯を食いしばれ…あたし…",
        "涙は…怒りの涙…",
        "絶対に…屈しない…",
    ],

    # resignation: 諦め（20エントリー）
    "resignation": [
        "もう…いいや…",
        "好きにすれば…",
        "抵抗しても…無駄…",
        "諦めた…全部…",
        "どうでもいい…もう…",
        "考えるの…やめた…",
        "されるがまま…でいいや…",
        "もう…なにも感じない…",
        "壊れてもいい…",
        "体…好きに使えば…",
        "心…閉じちゃった…",
        "にんぎょうみたいに…なれたらいいのに…",
        "終わるまで…耐えるだけ…",
        "逃げ場…ない…",
        "笑えてくる…こんな状況…",
        "かんかくが…とおくなってく…",
        "魂…抜けてく感じ…",
        "体が…あたしのじゃない…",
        "空っぽ…になっちゃった…",
        "なにされても…もう…",
    ],

    # confusion: 混乱（15エントリー）
    "confusion": [
        "なにが…起きてるの…",
        "わかんない…全部…",
        "頭が…追いつかない…",
        "夢…？ほんとに…？",
        "理解できない…",
        "え…なんで…こんなことに…",
        "現実味がない…",
        "パニック…頭が…",
        "状況が…飲み込めない…",
        "混乱してる…体だけ勝手に…",
        "思考が…止まった…",
        "何が正しいか…わかんない…",
        "嫌なのか…気持ちいいのか…",
        "自分が…自分じゃないみたい…",
        "考えちゃだめ…感じちゃだめ…",
    ],

    # guilt: 罪悪感（20エントリー）
    "guilt": [
        "ごめんなさい…ごめんなさい…",
        "彼氏に…顔向けできない…",
        "最低…あたし…最低…",
        "裏切ってる…今…この瞬間…",
        "バレたら…終わる…",
        "こんなことしてる自分が…",
        "誰にも…知られたくない…",
        "ゆるされない…あたし…",
        "ほんとにさいてい…あたし…",
        "嘘つき…あたし…嘘つき…",
        "好きな人がいるのに…",
        "約束…破ってる…",
        "ごめん…ゆるして…",
        "あの人を…裏切った…",
        "合わせる顔がない…",
        "こんな体…見せられない…",
        "秘密…増えていく…",
        "あたしのせい…全部…",
        "でも…止められない…最低…",
        "全部…あたしが悪い…",
    ],
    # anal_thought: アナル心理（15エントリー）
    "anal_thought": [
        "お尻…変な感じ…",
        "こんなとこで…",
        "だめ…おかしく…",
        "そこは…違う…",
        "慣れちゃいけない…",
        "きもちいい…はず…ない…",
        "なんで…感じてる…",
        "もう戻れない…",
        "恥ずかしすぎる…",
        "こっちのが…感じる…",
        "体…勝手に…力抜けて…",
        "やだ…奥が…",
        "知らなかった…こんなの…",
        "もう…どうでもいい…",
        "ここで…イくなんて…",
    ],
    # toy_thought: 玩具心理（15エントリー）
    "toy_thought": [
        "これ…やばい…",
        "止まんない…",
        "機械に…負けて…",
        "自分で…止められない…",
        "振動…頭まで…",
        "ずっと…イかされて…",
        "もう…考えられない…",
        "スイッチ…誰か…",
        "体…勝手に…反応して…",
        "おかしくなりそう…",
        "慣れちゃった…やだ…",
        "もう…道具に…負けた…",
        "ぜんぶ…電気で…",
        "意思…関係なく…",
        "何も…できない…",
    ],
    # oral_thought: フェラ/口内心理（15エントリー）
    "oral_thought": [
        "口の中…いっぱい…",
        "味…してる…",
        "飲まなきゃ…",
        "舌…しびれて…",
        "息…苦しい…",
        "顎…もう限界…",
        "飲み込むしか…",
        "匂い…くらくら…",
        "ちゃんと…できてる？…",
        "喉…焼けるみたい…",
        "こんなの…慣れたくない…",
        "涙…止まんない…",
        "上手って…思われたい…",
        "頭…真っ白…",
        "ぜんぶ…受け止めなきゃ…",
    ],
    # orgasm_thought: イキ際心理（20エントリー）
    "orgasm_thought": [
        "あ…イく…",
        "頭…真っ白…",
        "もう…だめ…",
        "飛びそう…",
        "限界…超えた…",
        "体…ぜんぶ…",
        "もう…止まれない…",
        "きもちいい…だめ…",
        "意識…もうない…",
        "このまま…壊れても…",
        "ぜんぶ…持っていかれる…",
        "我慢…できなかった…",
        "最奥が…ぎゅって…",
        "体…ぴくぴくして…",
        "声…止まんない…",
        "もう…何回目…",
        "とろけ…ちゃう…",
        "力…ぜんぶ抜けた…",
        "だめ…イっちゃう…",
        "あたまの中…ぐちゃぐちゃ…",
    ],
    # sensitivity: 敏感すぎる心理（15エントリー）
    "sensitivity": [
        "触っただけで…",
        "敏感すぎ…",
        "ちょっとので…",
        "ぴくって…なった…",
        "風が当たるだけで…",
        "もう…触らなくても…",
        "指一本で…こんな…",
        "息かかっただけで…",
        "見られるだけで…感じる…",
        "服が擦れるだけで…",
        "声…聞くだけで…",
        "先っぽ…当たっただけ…",
        "こすれるだけで…だめ…",
        "近づくだけで…体が…",
        "もう…全身…感じる…",
    ],
}


# ============================================================================
# 男性セリフプール（タイプ別）
# ============================================================================
SPEECH_MALE_POOL = {
    # command: 命令・支配
    "command": [
        "逃がさねぇよ",
        "おとなしくしろ",
        "脱げ",
        "見せろ",
        "開け",
        "動くな",
        "声出せ",
        "こっち向け",
        "逆らうな",
        "黙ってろ",
        "力抜け",
        "受け入れろ",
        "泣いても無駄",
        "四つん這いだ",
        "もっと開けろ",
        "逃げんなよ",
        "咥えろ",
        "舐めろ",
        "言う通りにしろ",
        "腰振れよ",
        "顔上げろ",
        "こっち来い",
        "立つな",
        "寝転がれ",
        "足開け",
        "奥まで入れろ",
        "離すなよ",
        "自分でやれ",
        "見ろよ",
        "止まんな",
        "耐えろ",
        "跨がれ",
        "飲み込め",
        "触るな",
        "声我慢すんな",
        "そのまま動け",
        "全部出せ",
        "顔見せろ",
        "両手上げろ",
        "俺だけ見ろ",
    ],

    # dirty: 言葉責め（命令/挑発/煽り。観察実況「～だな」禁止）
    "dirty": [
        "感じてんだろ",
        "すげえ締まる",
        "もう濡れてる",
        "もっと鳴け",
        "もう我慢すんな",
        "正直になれよ",
        "ここ好きだろ",
        "すげえ顔してる",
        "欲しがってんだろ",
        "我慢できねぇか",
        "もうイきそうか",
        "欲しいんだろ",
        "締めんなよ",
        "何回目だ？",
        "名前呼んでみろ",
        "もう堕ちてんだろ",
        "たまんねえ",
        "腰止まんねえだろ",
        "腰引くなよ",
        "もう戻れねえぞ",
        "もっと締めろ",
        "認めろよ",
        "もっと声出せ",
        "ぐちょぐちょだぞ",
        "堕ちたな",
        "もう慣れたか",
        "自分で動いてみろ",
        "隠すなよ",
        "素直になれ",
        "もっと欲しがれ",
        "自覚あんだろ",
        "顔真っ赤だぞ",
        "相当好きだろ",
        "自分で動けよ",
        "どこが一番だ",
        "奥まで入れてやる",
        "止まんねぇだろ",
        "声漏れてるぞ",
        "泣き叫べ",
        "ほら自分で言え",
    ],

    # gentle: 優しめ
    "gentle": [
        "気持ちいい？",
        "もっと聞かせて",
        "大丈夫だよ",
        "可愛いよ",
        "力抜いて",
        "ゆっくりでいい",
        "好きだよ",
        "痛くない？",
        "もう少しだけ",
        "綺麗だよ",
        "任せて",
        "離さないよ",
        "感じてくれた？",
        "もっとしたい",
        "愛してるよ",
        "怖くないよ",
        "無理しないで",
        "ここにいるよ",
        "そのままでいい",
        "俺を見て",
        "一緒にいこう",
        "泣いてもいいぞ",
        "嫌なら言えよ",
        "抱きしめるぞ",
        "ずっと一緒だ",
        "声聞かせろ",
        "近くに来い",
        "全部受け止める",
        "安心しろ",
        "目閉じていい",
        "いい子だ",
        "焦るなよ",
        "温かいよ",
        "触るぞ",
        "このままだ",
        "そばにいるぞ",
        "幸せにする",
        "お前だけだ",
        "何度でもいい",
        "ぎゅっとしろ",
    ],

    # climax: 射精宣言・絶頂
    "climax": [
        "出すぞ",
        "イケ",
        "中に出す",
        "もらえ",
        "受け取れ",
        "一緒にイケ",
        "限界だ",
        "出る…っ",
        "全部出すぞ",
        "イくぞ",
        "奥に出す",
        "中で出すぞ",
        "止まんねぇ",
        "もう出る",
        "搾り取れ",
        "食らえ",
        "飲み込め",
        "ほら出すぞ",
        "全部受け取れ",
        "最後まで出す",
        "一滴も残すな",
        "しがみつけ",
        "抜かねぇぞ",
        "このまま出す",
        "そのまま受けろ",
        "奥で受け止めろ",
        "出してやる",
        "ほら…出るぞ",
        "もう止められん",
        "一緒にいくぞ",
    ],

    # praise: 褒め・称賛（短い感嘆/肯定。観察実況「～だな」禁止）
    "praise": [
        "最高だよ",
        "いい子だ",
        "かわいすぎる",
        "たまらない",
        "すごいよ",
        "上手いぞ",
        "えらいな",
        "よく耐えた",
        "素直でいい",
        "最高だ",
        "もっと聞かせろ",
        "よくできた",
        "綺麗だよ",
        "たまんねぇ",
        "完璧だよ",
        "もっとくれ",
        "かわいい",
        "よく頑張った",
        "ご褒美だ",
        "もっと見せろ",
        "ほんと好きだ",
        "凄くいいぞ",
        "堪能させろ",
        "もう最高だ",
        "愛おしいよ",
        "こんなの初めてだ",
    ],

    # breath: 男性の短い息遣い・唸り（♡禁止）
    "breath": [
        "くっ…",
        "ぐっ…",
        "はぁ…",
        "ふぅ…",
        "ちっ…",
        "くそ…",
        "っ…",
        "ん…",
        "はっ…",
        "ぐ…っ",
    ],

    # gentle_dom: 優しい支配・誘導
    "gentle_dom": [
        "いい子だ",
        "上手だよ",
        "もっと見せて",
        "怖がらなくていい",
        "楽にしろ",
        "大丈夫だから",
        "急がなくていい",
        "そう…いい子",
        "感じていいよ",
        "我慢しなくていい",
        "声出していい",
        "気持ちいいだろ？",
        "素直になれ",
        "俺に任せろ",
        "あと少しだ",
        "逃がさないから",
        "可愛いな",
        "動くな…いい子だ",
        "俺を見ろ",
        "もう逃がさない",
    ],

    # jealousy: 嫉妬・独占宣言
    "jealousy": [
        "俺だけのもんだ",
        "触らせるな",
        "誰にも渡さねえ",
        "俺以外見んな",
        "忘れさせてやる",
        "体に覚えさせる",
        "印つけてやる",
        "二度と離さねえ",
        "俺のだ",
        "他のこと考えんな",
        "全部消してやる",
        "俺だけ見てろ",
        "独り占めだ",
        "返さねえぞ",
        "浮気は許さねえ",
        "俺以外知るな",
        "俺色に染めてやる",
        "逃がすかよ",
        "もう遅えよ",
        "お前は俺のもんだ",
    ],

    # degradation: 屈辱系命令
    "degradation": [
        "自分で言え",
        "お願いしろ",
        "乞え",
        "惨めだろ",
        "泣いてんのか",
        "いい顔だ",
        "もっと堕ちろ",
        "認めろよ",
        "嫌だと言ってみろ",
        "体は正直だろ",
        "どこまで落ちる",
        "犬かよ",
        "戻れねぇだろ",
        "自分から腰振れ",
        "もっと惨めに",
        "声出して乞え",
        "恥ずかしがんな",
        "嫌がるなよ今更",
        "お前の本性だろ",
        "もう終わりだ",
    ],

    # chikan: 痴漢・公共場所での支配セリフ
    "chikan": [
        "声出すなよ",
        "バレたいのか",
        "静かにしろ",
        "騒ぐな",
        "誰か来るぞ",
        "ほら我慢しろ",
        "黙って受けろ",
        "逃げられねぇよ",
        "こんなとこでな",
        "人が来るぞ",
        "顔赤くなってんぞ",
        "声殺せよ",
        "立ってられねぇか",
        "膝笑ってんぞ",
        "ほら掴まってろ",
        "逃げられねえぞ",
        "汚ねえ場所でな",
        "言えねえだろ",
        "口閉じてろ",
        "ドア薄いぞ",
        "足音聞こえるな",
        "ばれたらどうする",
        "もう遅えよ",
        "鍵かけてやったぞ",
        "出さねえぞ",
    ],

    # taunt: 嘲笑・煽り・挑発
    "taunt": [
        "泣けよ",
        "情けねえ顔",
        "抵抗しろよ",
        "嫌がるフリか",
        "もう諦めたか",
        "いい鳴き方だ",
        "震えてやがる",
        "目が潤んでんぞ",
        "かわいい抵抗だ",
        "無駄だよ",
        "声堪えてんのか",
        "顔見せてみろ",
        "ほらどうした",
        "終わんねえよ",
        "まだまだだ",
        "楽しませろよ",
        "もう力入んねえか",
        "ぐったりしやがって",
        "涙拭いてやるよ",
        "お前のせいだぞ",
    ],

    # public: 公共場所の声抑制・緊張系
    "public": [
        "外に聞こえるぞ",
        "静かにしてろ",
        "足音したな",
        "ドアの向こうに人",
        "声抑えろ",
        "人来るかもな",
        "ここでやるぞ",
        "バレたら終わりだ",
        "壁薄いんだよ",
        "もう少しで終わる",
        "我慢しとけ",
        "ほら聞こえるだろ",
        "人の気配がする",
        "今出たらバレるぞ",
        "おとなしくしてろ",
        "見つかりてえのか",
        "こんな場所でな",
        "通報されっぞ",
        "黙って耐えろ",
        "もうすぐ終わる",
    ],

    # fantasy_hero: 異世界男性セリフ
    "fantasy_hero": [
        "俺の奴隷だろ",
        "魔法は効かねぇ",
        "勇者がこの姿か",
        "世界のルールだ",
        "エルフの体…感じろ",
        "丈夫な体だ",
        "魔力回復してやるよ",
        "紋が反応してる",
        "逆らえない体だろ",
        "魔王様の命令だ",
        "何度でもいける",
        "ステータス見ろ",
        "レベル差だ",
        "俺の戦利品だ",
        "勇者を堕とすか",
        "異世界人か…珍しい",
        "体に刻んでやる",
        "甲斐があったな",
        "魔力最高だ",
        "従え…命令だ",
    ],

    # ojisan: おじさん系セリフ
    "ojisan": [
        "教えてやるよ",
        "いい子だね…",
        "若い体…最高だ",
        "おじさん好き？",
        "パパって呼んでみ",
        "小遣いやるよ",
        "任せなさい",
        "おじさんでいい？",
        "若いっていいぞ",
        "言うこと聞ける？",
        "大人にしてやるよ",
        "優しくするよ",
        "怖がるなよ",
        "守ってやる",
        "いい匂いだ",
        "肌すべすべだ",
        "練習させてやる",
        "お嬢ちゃん…いいね",
        "我慢できないよ",
        "また来てくれる？",
    ],

    # doctor: 医者/専門職セリフ
    "doctor": [
        "診察を続けますね",
        "力抜いて…そう",
        "異常なしです…",
        "患者の義務ですよ",
        "深呼吸して…",
        "ここは痛みますか？",
        "反応ありますね…",
        "治療の一環ですから",
        "先生を信じてください",
        "もう少し奥を…診ますね",
        "健康な証拠です",
        "脈が上がってますね",
        "ここも検査しましょう",
        "声出しても大丈夫",
        "リラックスして",
        "刺激ありますよ",
        "秘密ですよ",
        "特別な治療です",
        "責任持ちます",
        "また来てください",
    ],

    # delinquent: 不良/ヤンキーセリフ
    "delinquent": [
        "けっ、素直になれよ",
        "逃げんなよ",
        "声出せよ",
        "もっと鳴けよ",
        "俺に逆らうのか？",
        "ツレに見せてやろうか",
        "ビビんなよ",
        "お前の負けだよ",
        "泣いてもやめねぇよ",
        "嫌がんのも飽きたろ",
        "暴れんな",
        "可愛いじゃん",
        "口答えすんな",
        "俺のもんだろ",
        "調子乗んな",
        "ガキじゃねぇんだ",
        "力じゃ無理だろ",
        "二度と逆らうなよ",
        "やるじゃん",
        "また遊んでやるよ",
    ],
    # teacher: 先生/教師系（20エントリー）
    "teacher": [
        "補習だ",
        "居残りだな",
        "答えろ",
        "まだ終わってない",
        "成績…上げてやる",
        "お前だけ特別だ",
        "口外するなよ",
        "これも勉強だ",
        "先生を信じろ",
        "いい生徒だ",
        "静かにしろ",
        "真面目にやれ",
        "赤点消してやる",
        "教師と生徒だぞ",
        "放課後…残れ",
        "将来のためだ",
        "内申点…どうする？",
        "誰にも言うな",
        "卒業まで…な",
        "いい子にしてろ",
    ],
    # yakuza: ヤクザ・極道系（20エントリー）
    "yakuza": [
        "わかってんだろ",
        "逆らうなよ",
        "組に逆らう気か",
        "借りは体で返せ",
        "気に入ったぞ",
        "ケジメだ",
        "覚悟しろ",
        "泣いても知らねぇ",
        "俺の女だ",
        "黙って従え",
        "親父の代わりだ",
        "売り飛ばすぞ",
        "気に入った",
        "一生面倒見てやる",
        "舐めた口きくな",
        "組長が待ってる",
        "逃げ場はねぇ",
        "お前で遊ぶか",
        "文句あんのか",
        "飼ってやるよ",
    ],
    # classmate: 同級生・同世代系（20エントリー）
    "classmate": [
        "バレたらやばいぞ",
        "黙ってろよ",
        "気になってた",
        "かわいいな…",
        "もっと声出せよ",
        "お前…感じてんだろ",
        "初めてか？",
        "力抜けって",
        "放課後…来いよ",
        "秘密な",
        "お前だけだよ",
        "誰にも言うなよ",
        "ずっと…したかった",
        "彼氏に言うなよ",
        "教室で…やべぇな",
        "音…立てんなよ",
        "学校で…興奮する",
        "体育倉庫…鍵かけた",
        "帰り…うちこいよ",
        "お前…エロいぞ",
    ],
    # stepfather: 義父系（20エントリー）
    "stepfather": [
        "ママには内緒だ",
        "言うこと聞けるな？",
        "いい子だ",
        "パパって呼べ",
        "お前の母親が悪い",
        "家族だろ",
        "養ってやってんだ",
        "逆らえねぇよな",
        "お前もその気だろ",
        "言えねぇよな",
        "毎晩…行くからな",
        "母親にそっくりだ",
        "おやすみのキスだ",
        "小遣い…欲しいだろ",
        "二人だけの秘密だ",
        "帰る前にな",
        "もう大人だろ",
        "お前のせいだ",
        "この家出てくか？",
        "素直でいい子だ",
    ],
    # anal: アナル男性セリフ（15エントリー）
    "anal": [
        "こっちの穴も",
        "締まりがいい",
        "初めてか？",
        "ほぐしてやる",
        "力抜けよ",
        "奥まで入るぞ",
        "こっちも慣らす",
        "両方使うぞ",
        "ここも開発する",
        "いい反応だ",
        "もっと緩めろ",
        "中…熱いな",
        "ケツで感じてる",
        "もう戻れねぇな",
        "イっていいぞ",
    ],
    # foreplay: 前戯男性セリフ（15エントリー）
    "foreplay": [
        "まだ入れないぞ",
        "焦んなよ",
        "ここか？",
        "もう濡れてる",
        "反応いいぞ",
        "声…出すなよ",
        "感じてきた",
        "もっと開け",
        "ここ…好きだろ",
        "まだまだだ",
        "じらすの好きだろ",
        "我慢しろ",
        "もう限界か？",
        "自分から腰振るな",
        "まだ指だけだ",
    ],
    # cum_announce: 射精宣言バリエーション（15エントリー）
    "cum_announce": [
        "中に出すぞ",
        "受け取れ",
        "全部飲め",
        "出るぞ",
        "もう限界だ",
        "いくぞ…覚悟しろ",
        "奥に出す",
        "ぜんぶ注いでやる",
        "そのまま受けろ",
        "顔にかけてやる",
        "腹ん中出す",
        "抜かねぇぞ",
        "一滴も残さねぇ",
        "そこで受けろ",
        "たっぷり出す",
    ],
}


# ============================================================================
# 中立セリフプール（非エロシーン用・文脈保護）
# ============================================================================
NEUTRAL_POOL = {
    "female": [
        "うん…", "ん…", "え…", "あ、はい", "そう…", "ふぅ…", "えっと…",
        "あの…", "なんだろ", "そっか…", "わかった", "ありがと", "大丈夫…",
        "そうなんだ", "ここ…?", "静かだね", "きれい…", "落ち着く…",
        "不思議…", "怖い…", "緊張する", "どうしよ", "変な感じ",
        "なにか…", "待って…",
        # v7.0追加
        "ねぇ…", "あのね…", "どこ行くの…", "今日は…",
        "帰りたい…", "疲れた…", "お腹すいた…", "寒い…",
        "暗い…", "やだな…", "ここ初めて…", "どうしよう…",
        "なんとなく…", "行こっか…", "遅くなった…",
    ],
    "male": [
        "ああ", "そうか", "来い", "行くぞ", "どうした", "ほら", "こっちだ",
        "座れ", "待ってろ", "黙れ", "いいから", "聞けよ", "わかった",
        "問題ない", "さあな", "ついて来い", "落ち着け", "心配すんな",
        "急ぐぞ", "見てろ", "準備しろ", "ったく", "やれやれ", "おい",
        "へえ",
        # v7.0追加
        "静かにしろ", "急げ", "時間だ", "飲むか",
        "なんだ", "話がある", "起きろ", "寝ろ",
        "二人きりだぞ", "帰るぞ",
    ],
}


# ============================================================================
# 事後セリフプール（aftermath用）
# ============================================================================
AFTERMATH_POOL = {
    "female": [
        "もう…むり", "動けない…", "ぼーっと…", "からだ重い…", "震えてる…",
        "夢みたい…", "ごめん…", "なにこれ…", "頭まっしろ", "力入んない",
        "息できない", "涙が…", "どしよ…", "戻れない…", "ふわふわ…",
        "全身痺れて", "立てない…", "声出ない…", "意識が…", "熱い…",
        "汗すごい…", "まだ震えて", "ぐったり…", "目が回る", "指先痺れ",
        # v7.0追加（+15）
        "腰…砕けた…", "中…あったかい…", "流れてくる…", "お腹…ぱんぱん…",
        "精液…止まらない…", "意識…飛んでた…", "何回イったか…わかんない…",
        "体…ビクビクする…", "口…開けっぱなし…", "涎…垂れてた…",
        "白目…むいてたかも…", "足…閉じれない…", "穴…閉じない…",
        "使われた…", "壊された…",
    ],
    "male": [
        "もういいぞ", "帰れ", "次もな", "よくやった", "最高だった",
        "片付けろ", "寝てろ", "覚えとけ", "また来るぞ",
        "じゃあな", "疲れたろ", "もう朝だぞ", "起きろ",
        "ったく", "休憩だ", "水飲め", "立てるか",
        "終わりだ", "さっさと帰れ", "もう用はない",
        "忘れるんだな", "誰にも言うなよ", "黙ってろ", "行くぞ",
        # v7.0追加（+10）
        "明日もだぞ", "たっぷり出した", "写真撮っとくか",
        "いい顔だ", "もう立てねぇか", "壊れちまったか",
        "掃除しとけ", "今日は許してやる", "お前…最高だ",
        "癖になりそうだ",
    ],
}


# ============================================================================
# オノマトペプール（行為別・intensity連動）
# ============================================================================
ONOMATOPOEIA_POOL = {
    "insertion": {
        "gentle": ["ずるっ", "ぬるっ", "にゅ…", "ずぷ…", "にゅるっ", "とろっ…", "ぬる…", "するっ…", "にゅぅ…", "ぬめっ…"],
        "normal": ["ずぷっ", "ぬぷっ", "にゅぷ", "ずるん", "ぐぷっ", "ずぷん", "にゅるん", "ぬぷん", "ぐにゅっ", "ずぷぷ"],
        "hard":   ["ずぶっ", "ずぼっ", "ぐぷぅ", "ずぶぶ", "ぐちゅっ", "ずぶぅっ", "ずぼぼっ", "ぐぷぷっ", "ずぱんっ", "ずぶりっ"],
    },
    "piston": {
        "slow":    ["ずちゅ…", "ぬちゅ…", "ぐちゅ…", "にゅちゅ", "ずる…ずる…", "ぬぷ…ぬぷ…", "ずりゅ…", "くちゅ…ん", "ぬる…ぬる…", "ずぅ…ずぅ…"],
        "normal":  ["ぱんっ", "ぱちゅ", "ずちゅずちゅ", "ぬぷぬぷ", "ぐちゅぐちゅ", "ぱんぱん", "ずぷずぷ", "にゅぷにゅぷ", "ぬちゅぬちゅ", "ぐにゅぐにゅ"],
        "fast":    ["ぱんぱんぱん", "ずちゅずちゅずちゅ", "ぱんっぱんっ", "ぐちゅんぐちゅん", "ぱぱぱぱん", "ずっぱんずっぱん", "ぬちゃぬちゃぬちゃ", "ぱんぱんぱんっ", "ぐっちゅぐっちゅ"],
        "violent": ["ぱぁんぱぁん", "ばちんばちん", "ぱんぱんぱんぱん", "ずっぱぁん", "ずぶずぶずぶ", "ぱぁんぱぁんぱぁん", "ばんばんばん", "どんっどんっ", "ぱぁぁんぱぁぁん"],
    },
    "wet": {
        "light":  ["くちゅ…", "ちゅ…", "とろ…", "じゅわ…", "ぴちゃ…", "くちゅ…ん", "にちゃ…", "ぬめ…", "とろ…ん", "じわ…"],
        "normal": ["くちゅくちゅ", "ぐちゅ", "ぬちゃ", "とろとろ", "ぴちゃ", "じゅる", "ぬちゅ", "くちゃくちゃ", "とろぉ", "ぐちゅん"],
        "heavy":  ["ぐちょぐちょ", "ぬちゃぬちゃ", "じゅぷじゅぷ", "びちゃびちゃ", "ぐっちょぐっちょ", "ぐしょぐしょ", "ぬるぬる", "びちょびちょ", "じゅぶじゅぶ", "ぐちゃぐちゃ"],
    },
    "ejaculation": {
        "normal":   ["どぷっ", "びゅるっ", "どくん", "びゅっ", "どぷん", "どくっ", "びゅるん", "どくどく", "びゅっびゅっ", "どぴゅ"],
        "heavy":    ["どぴゅっ", "びゅるるっ", "どっぷどっぷ", "びゅるびゅる", "どくどくどく", "どぴゅるっ", "びゅびゅびゅ", "どばどば", "どぴゅぴゅ", "びゅるるるっ"],
        "overflow": ["どぷぷぷ", "びゅるるるっ", "たぷ…たぷ…", "どばっ", "どぷどぷどぷ", "どばぁっ", "だばぁ", "たぷたぷ", "どろどろ", "ぶちゅぅ"],
    },
    "oral": {
        "lick": ["ちゅ…", "ぺろ", "れろ…", "ちろ…", "ぺろん", "れろれろ", "ぺろぺろ", "ちろちろ", "ぺちゅ…", "れろ…ん", "ぺろっ"],
        "suck": ["ちゅぱっ", "じゅるる", "ちゅる…", "じゅぷっ", "じゅるじゅる", "ちゅぱちゅぱ", "ちゅるるる", "じゅっ", "ちゅぶっ", "じゅるぅ"],
        "deep": ["んぐっ", "ごくっ", "じゅるるる", "ぐぷっ", "んぐぅ", "じゅぽっ", "ごぷっ", "ぐぷぐぷ", "んぐんぐ", "じゅぽじゅぽ"],
    },
    "body": {
        "breast":    ["ぷるん", "たぷん", "むにゅ", "ぽよん", "もみゅ", "ぽよぽよ", "たぷたぷ", "ぷるるん", "むにゅむにゅ", "たゆん"],
        "skin_slap": ["ぱちん", "ぱしっ", "ぺちん", "ぴしゃ", "ぱちぱち", "ぱしぱし", "ぺちぺち", "ぴたん", "ぱんぺちん", "ぱしん"],
        "tremble":   ["びくっ", "ぴくぴく", "ぶるっ", "がくがく", "ビクンビクン", "ぶるぶる", "びくびく", "がくっ", "ビクッ", "ぷるぷる", "わなわな"],
        "squeeze":   ["きゅっ", "ぎゅっ", "きゅうっ", "むぎゅ", "きゅぅっ", "ぎゅぅっ", "きゅんっ", "ぎゅむ", "きゅきゅっ", "ぎゅぎゅ"],
    },
    "kiss": {
        "light": ["ちゅっ", "ちゅ…", "んちゅ…", "ぺちゅ", "ちゅぅ…", "ちゅん…", "ふちゅ…", "ん…ちゅ", "こつん…ちゅ", "ちゅ…ん"],
        "deep":  ["ちゅぷ…", "じゅるっ", "んちゅるる", "れろ…ちゅ…", "ちゅぷちゅぷ", "じゅるじゅる", "れろんちゅぷ", "んちゅぅ…", "ちゅるるる", "じゅぶっ"],
    },
    "anal": {
        "gentle": ["ぬるっ…", "むにゅ…", "つぷ…", "きゅむ…", "ぬめっ…", "にゅ…っ", "とろっ…", "ぬるん…", "くにゅ…", "むにっ…"],
        "normal": ["ずぷっ", "きゅぷっ", "ぬぷぷ", "ぐぷっ…", "にゅるん", "みちっ", "きゅぅぷ", "ぬちゅ…", "ずぐっ", "ずぷぷっ"],
        "hard":   ["ずぼっ", "ぐぱっ", "ぐりゅっ", "ずぷぷっ", "ずぼぼっ", "ぐぷぷぅ", "ずぐぐっ", "ぐりぐり", "みちみちっ", "ずぶぶっ"],
    },
    "throat": {
        "shallow": ["くぷっ", "ちゅぷ…", "こくん", "くぷ…ん", "こくこく", "ぷちゅ…", "くちゅ…", "こくっ…", "くぷくぷ", "ちゅぷん"],
        "deep":    ["んぐぅ…", "ごぼっ", "おえっ…", "ぐぷぅ…", "じゅるるる", "んぐんぐ", "ごぷごぷ", "ずぶっ…", "ぐぽぐぽ", "じゅぽっ…"],
        "gag":     ["ごほっ", "けほっ", "うぇっ", "んぐぐ…", "ごぼごぼ", "うぇぇ…", "おぇぇ…", "げほっ", "ぐぇっ…", "ごぷっ…"],
    },
    "spanking": {
        "light":  ["ぱしっ", "ぺちん", "ぱちっ", "ぱん", "ぱしん", "ぺちっ", "ぱっ", "ぺしっ", "ぱちん", "たんっ"],
        "normal": ["ぱぁん", "ばちん", "ぱしぃん", "ばちっ", "ぱぁんっ", "ばしぃん", "ぱちぃん", "ばしっ", "ぱんぱん", "ばちばち"],
        "hard":   ["ばちぃん", "ぱぁぁん", "ばっちぃん", "ばぁぁん", "ばしぃぃん", "ぱぁんっっ", "ばぎゃん", "ばっちん", "ばたぁん", "ぱぁぁんっ"],
    },
    "breathing": {
        "light": ["はぁ…はぁ…", "すぅ…はぁ…", "ふぅ…ふぅ…", "は…ぁ…", "すぅ…すぅ…", "ふ…ぅ…", "はっ…はっ…", "ふはっ…", "はぁ…ん", "ん…はぁ…"],
        "heavy": ["はぁはぁはぁ", "ぜぇぜぇ", "ひゅーひゅー", "はっはっはっ", "ぜぇ…はぁ…", "はぁっはぁっ", "ふぅはぁはぁ", "ぜーはーぜー", "はぁはぁっ", "ぜぇっぜぇっ"],
    },
    "heartbeat": ["どきどき", "どくんどくん", "ばくばく", "どくっ…どくっ…", "どきっ", "ばくんばくん", "どっくんどっくん", "どきどきどき", "とくとく", "ばくっ…"],
    "vibrator": ["ぶーん", "ぶぃぃ…", "ぴぴぴ", "ぶるるる", "ぶーんぶーん", "うぃんうぃん", "ぶぶぶ…", "ヴヴヴ…", "ぶるぶる", "ういぃん"],
    "dripping": ["ぽたっ", "たらー", "ぽたぽた", "つー…", "とろー", "すぅー", "たらたら", "ぽたぽたぽた", "つぅー…", "とろとろ…", "しずく…"],
    "suppressed": ["んんっ…", "ぅ…っ", "んぐっ…", "くっ…ん", "ん…ん…", "ぅぅ…っ", "んむっ…", "んっ…んっ…", "むぐっ…", "ん…ぅ…", "くぅ…っ", "んんんっ…"],
    "crying": ["ひっく…", "ぐすっ…", "えぐっ…", "うっ…ぅ…", "しくしく", "ぐすん…", "ひっく…ひっく…", "えぐ…えぐ…", "ぐすぐす…", "うぅ…っ", "ひくっ…"],
    # v7.0追加カテゴリ
    # v8.0追加カテゴリ
    "footjob": {
        "gentle": ["するする…", "すりすり…", "くにくに…", "にゅる…", "さわさわ…", "するん…", "つるつる…", "ふにふに…"],
        "normal": ["するっする", "すりすりすり", "くにゅくにゅ", "にゅるにゅる", "ぐにぐに", "もにゅもにゅ", "ぬるぬるっ", "くちゅくちゅ"],
    },
    "paizuri": {
        "gentle": ["むにゅ…", "ぷにゅ…", "ふにゅ…", "むにむに…", "たぷ…ん", "もにゅ…", "ぷにっ…", "ふわ…っ"],
        "normal": ["むにゅむにゅ", "ぱふぱふ", "ぬるぬる", "たぷんたぷん", "むにゅんむにゅん", "もみもみ", "ぷにぷに", "ぬちゅぬちゅ"],
    },
    "finger": {
        "gentle": ["くちゅ…", "ぬる…", "つぷ…", "にゅ…っ", "くに…", "ぬめ…っ", "ちゅく…", "とろ…っ"],
        "normal": ["くちゅくちゅ", "ぬるぬる", "にゅぷにゅぷ", "くにくに", "ぬちゅぬちゅ", "ぐちゅぐちゅ", "くちゃくちゃ", "にゅるにゅる"],
        "fast":   ["くちゅくちゅくちゅ", "ぐちゅぐちゅぐちゅ", "ぬちゃぬちゃぬちゃ", "くちゅんくちゅん", "ぐちょぐちょぐちょ", "びちゃびちゃびちゃ", "じゅぷじゅぷじゅぷ", "くちゅっくちゅっ"],
    },
    "grinding": {
        "slow":   ["ぬるぅ…", "すりっ…", "くちゅ…ん", "ぬめぬめ…", "するん…", "にゅる…っ", "ぐにっ…", "ぬちゅ…ん"],
        "normal": ["ぬるぬるっ", "すりすりっ", "くちゅくちゅ", "ぐりぐり", "ぬちゃぬちゃ", "にゅるにゅるっ", "すりっすりっ", "ぐにゅぐにゅ"],
    },
    "toy_insertion": {
        "gentle": ["にゅ…ぷ", "ぬるっ…", "くぷ…っ", "ずぷ…ん", "にゅるっ…", "むにゅ…っ", "つぷ…ん", "ぬめっ…"],
        "normal": ["ずぷっ", "にゅぷっ", "ぐぷっ", "ぬぷぬぷ", "ずぷずぷ", "にゅぷにゅぷ", "くぷくぷ", "ぐぷぐぷ"],
        "hard":   ["ずぶっ", "ぐぷぅっ", "ずぼっ", "ぐりゅっ", "ずぶぶっ", "ぐぱっ", "ずぷぷぅ", "にゅぐっ"],
    },
    "ambient": {
        "bed":   ["きしっ", "ぎしぎし", "きしみ…", "がたん", "ぎぃぎぃ", "みしみし", "がたがた", "きしきし"],
        "water": ["ちゃぷ", "ぱしゃ", "じゃぶ", "ちゃぽん", "ざぱっ", "ぱしゃぱしゃ", "じゃぶじゃぶ", "ちゃぷちゃぷ"],
        "cloth": ["するっ", "ぱさっ", "しゅるる", "ぽとっ", "するする", "かさっ", "はらっ", "しゅるっ"],
    },
}

# intensity別オノマトペ推奨マップ（sub_fallback: プライマリsub未発見時の代替リスト）
ONOMATOPOEIA_INTENSITY_MAP = {
    1: {"categories": ["heartbeat", "kiss", "breathing"], "sub": "light", "sub_fallback": ["gentle", "shallow"], "count": (0, 1)},
    2: {"categories": ["wet", "kiss", "body", "breathing", "finger"], "sub": "light", "sub_fallback": ["gentle", "slow"], "count": (1, 1)},
    3: {"categories": ["insertion", "wet", "piston", "oral", "finger", "paizuri"], "sub": "normal", "sub_fallback": ["normal", "suck"], "count": (1, 2)},
    4: {"categories": ["piston", "wet", "body", "anal", "finger", "toy_insertion"], "sub": "normal", "sub_fallback": ["fast", "hard", "normal"], "count": (2, 3)},
    5: {"categories": ["piston", "ejaculation", "body", "wet", "dripping", "toy_insertion"], "sub": "heavy", "sub_fallback": ["violent", "hard", "heavy", "overflow", "fast"], "count": (2, 4)},
}


def get_onomatopoeia_pool(intensity: int, action: str = "") -> list:
    """intensity と行為に応じたオノマトペプールを返す（3段階フォールバック）"""
    i = max(1, min(5, intensity))
    guide = ONOMATOPOEIA_INTENSITY_MAP.get(i, ONOMATOPOEIA_INTENSITY_MAP[3])
    pool = []
    primary_sub = guide.get("sub", "normal")
    fallback_subs = guide.get("sub_fallback", [])
    for cat in guide["categories"]:
        cat_data = ONOMATOPOEIA_POOL.get(cat, {})
        if isinstance(cat_data, dict):
            # 1. primary_sub で取得
            if primary_sub in cat_data:
                pool.extend(cat_data[primary_sub])
            else:
                # 2. fallback_subs を順に試す
                found = False
                for fb_sub in fallback_subs:
                    if fb_sub in cat_data:
                        pool.extend(cat_data[fb_sub])
                        found = True
                        break
                # 3. いずれも見つからなければ全subをマージ
                if not found:
                    for v in cat_data.values():
                        pool.extend(v)
        elif isinstance(cat_data, list):
            pool.extend(cat_data)
    # action指定がある場合はそのカテゴリも追加
    if action and action in ONOMATOPOEIA_POOL:
        act_data = ONOMATOPOEIA_POOL[action]
        if isinstance(act_data, dict):
            for v in act_data.values():
                pool.extend(v)
        elif isinstance(act_data, list):
            pool.extend(act_data)
    return pool


# ============================================================================
# ユーティリティ関数
# ============================================================================

def pick_replacement(pool_list: list, used_set: set, normalize_fn=None,
                     max_len: int = 25, avoid_suffix: str = "",
                     intensity: int = 3) -> str:
    """プールからused_setに含まれない未使用エントリーをランダムに選択。
    normalize_fnがあれば正規化後の値でも重複判定する。
    max_len: 文字数上限（デフォルト25、感情表現を含む自然なセリフ長）
    avoid_suffix: 避けるべき語尾構造パターン（例: "し…"）。直近と同じ語尾を避ける
    intensity: シーンintensity（♡数制限に使用。1-5）
    500シーン耐性: used_setがプールの70%超で自動スライディングウィンドウ"""
    # v8.6: intensity別♡数上限
    _MAX_HEARTS = {1: 0, 2: 0, 3: 1, 4: 2, 5: 99}
    _heart_limit = _MAX_HEARTS.get(intensity, 1)
    # v8.6: 語尾構造パターン判定用
    import re as _re
    _SUFFIX_PAT = _re.compile(r'(し…|る♡|の…|て…|く…|で…|に…|だし|よ…|か…|ない|った|って)$')

    def _ok_suffix(t):
        """avoid_suffixと同じ語尾パターンでないかチェック"""
        if not avoid_suffix:
            return True
        m = _SUFFIX_PAT.search(t.rstrip())
        return not m or m.group(1) != avoid_suffix

    def _ok_hearts(t):
        """♡数がintensity上限以内かチェック"""
        return t.count("♡") <= _heart_limit

    pool_size = len(pool_list)
    # スライディングウィンドウ: used_setがプールの70%超えたら古い半分を忘れる
    if pool_size > 0 and len(used_set) > pool_size * 0.7:
        keep = set(random.sample(list(used_set), len(used_set) // 2))
        used_set.clear()
        used_set.update(keep)
    if normalize_fn:
        used_normalized = {normalize_fn(t) for t in used_set}
        candidates = [t for t in pool_list
                      if t not in used_set
                      and normalize_fn(t) not in used_normalized
                      and len(t) <= max_len
                      and _ok_suffix(t) and _ok_hearts(t)]
    else:
        candidates = [t for t in pool_list
                      if t not in used_set
                      and len(t) <= max_len
                      and _ok_suffix(t) and _ok_hearts(t)]
    if candidates:
        return random.choice(candidates)
    # avoid_suffix制約を緩和して再試行（語尾制約のみ外す）
    if normalize_fn:
        candidates = [t for t in pool_list
                      if t not in used_set
                      and normalize_fn(t) not in used_normalized
                      and len(t) <= max_len and _ok_hearts(t)]
    else:
        candidates = [t for t in pool_list
                      if t not in used_set
                      and len(t) <= max_len and _ok_hearts(t)]
    if candidates:
        return random.choice(candidates)
    # max_len制限も緩和して再試行
    if normalize_fn:
        candidates = [t for t in pool_list if t not in used_set and normalize_fn(t) not in used_normalized and _ok_hearts(t)]
    else:
        candidates = [t for t in pool_list if t not in used_set and _ok_hearts(t)]
    if candidates:
        return random.choice(candidates)
    # 全て使用済みなら、バリエーション生成で重複回避（intensity考慮）
    if pool_list:
        base = random.choice(pool_list)
        # v8.6: intensity別バリアントリスト
        _VARIANT_BY_INTENSITY = {
            1: ["…", "っ…", "…っ", "ぅ…", "ぁ…"],
            2: ["…", "っ…", "…っ", "ぅ…", "ぁ…"],
            3: ["…", "♡", "…♡", "っ…", "…っ", "ぅ…", "ぁ…"],
            4: ["…", "♡", "…♡", "♡♡", "…♡♡", "っ…", "…っ", "ぅ…", "ぁ…"],
            5: ["♡", "…♡", "っ♡", "…", "♡♡", "っ…", "…っ", "♡…",
                "っ♡♡", "…♡♡", "ぅ…♡", "ん♡", "っ…♡", "ぁ♡", "…っ♡"],
        }
        _variants = _VARIANT_BY_INTENSITY.get(intensity, _VARIANT_BY_INTENSITY[3])
        for v in _variants:
            candidate = base.rstrip("♡…っ。") + v
            if candidate not in used_set and (not normalize_fn or normalize_fn(candidate) not in used_normalized):
                return candidate
        return base  # 最終手段: バリエーション不可なら元を返す
    return ""


def get_all_moan_normalized() -> set:
    """MOAN_POOL全エントリーの正規化テキストセットを返す。
    正規化: ♡♥…っー゛゜と結合濁点を除去。
    LLM生成moanがプール内に存在するか判定するために使用。"""
    normalized = set()
    for entries in MOAN_POOL.values():
        for text in entries:
            t = text.replace("♡", "").replace("♥", "").replace("…", "")
            t = t.replace("っ", "").replace("ー", "").strip()
            t = t.replace("\u309B", "").replace("\u309C", "")
            t = t.replace("\u3099", "").replace("\u309A", "")
            t = t.replace("゛", "").replace("゜", "")
            if t:
                normalized.add(t)
    return normalized


def get_moan_pool(intensity: int, expand: bool = True) -> list:
    """intensity(1-5)に応じた喘ぎ声プールを返す。
    expand=Trueの場合、隣接intensityからも補充して枯渇を防ぐ。
    500シーン耐性: ±1は全量、±2は半量混合"""
    i = max(1, min(5, intensity))
    pool = list(MOAN_POOL.get(i, MOAN_POOL[3]))
    if expand:
        # ±1 intensity: 全量混合
        if i + 1 <= 5:
            pool.extend(MOAN_POOL.get(i + 1, []))
        if i - 1 >= 1:
            pool.extend(MOAN_POOL.get(i - 1, []))
        # ±2 intensity: 半量混合（500シーン対応の追加バッファ）
        if i + 2 <= 5:
            far_pool = MOAN_POOL.get(i + 2, [])
            pool.extend(far_pool[::2])  # 偶数indexのみ（半量）
        if i - 2 >= 1:
            far_pool = MOAN_POOL.get(i - 2, [])
            pool.extend(far_pool[::2])  # 偶数indexのみ（半量）
    return pool



def infer_phase(intensity: int, scene_index: int, total_scenes: int) -> str:
    """intensityとシーン位置からフェーズを推定（サブフェーズ対応）
    戻り値例: foreplay_early, foreplay_late, penetration_early, penetration_late, climax_early, climax_late"""
    ratio = scene_index / max(total_scenes, 1)
    if intensity <= 1:
        return "intro"
    elif intensity == 2:
        return "approach"
    elif intensity == 3:
        if ratio < 0.35:
            return "foreplay_early"
        elif ratio < 0.5:
            return "foreplay_late"
        else:
            return "penetration_early"
    elif intensity == 4:
        if ratio < 0.5:
            return "penetration_early"
        elif ratio < 0.7:
            return "penetration_late"
        else:
            return "climax_early"
    else:
        if ratio < 0.85:
            return "climax_early"
        elif ratio < 0.95:
            return "climax_late"
        else:
            return "afterglow"


def get_speech_pool(bubble_type: str, theme: str = "", intensity: int = 3,
                    concept: str = "", phase: str = "") -> list:
    """タイプとテーマに応じたセリフプールを返す。
    concept指定時はSTORY_PATTERN_LIBRARYのkey_linesも混合。
    phase指定時はSCENE_PHASE_SPEECH_MAPからも混合（サブフェーズ→ベースフェーズのフォールバック付き）。"""
    pool = _get_speech_pool_core(bubble_type, theme, intensity)
    # パターンkey_lines混合（speechまたはthoughtのみ）
    if concept and bubble_type in ("speech", "thought") and pool:
        kl_phase = "early" if intensity <= 2 else ("late" if intensity >= 5 else "mid")
        pattern_lines = get_pattern_key_lines(theme, concept, kl_phase)
        if pattern_lines:
            pool.extend(pattern_lines)
    # フェーズ別プール混合（サブフェーズ→ベースフェーズフォールバック）
    if phase:
        phase_data = SCENE_PHASE_SPEECH_MAP.get(phase)
        if not phase_data and "_" in phase:
            base_phase = phase.rsplit("_", 1)[0]
            phase_data = SCENE_PHASE_SPEECH_MAP.get(base_phase)
        if phase_data:
            phase_pool = phase_data.get(bubble_type, [])
            if phase_pool:
                pool.extend(phase_pool)
    return pool


def _get_speech_pool_core(bubble_type: str, theme: str = "", intensity: int = 3) -> list:
    """内部: タイプとテーマに応じたセリフプールを返す"""
    theme_lower = theme.lower() if theme else ""
    is_forced = any(k in theme_lower for k in ["forced", "陵辱", "レイプ", "reluctant", "暴行", "強制"])
    is_hypnosis = any(k in theme_lower for k in ["催眠", "洗脳", "hypnosis", "マインド"])
    is_public = any(k in theme_lower for k in ["痴漢", "電車", "バス", "公共", "public", "chikan"])
    is_ntr = "ntr" in theme_lower or "寝取" in theme
    is_training = any(k in theme_lower for k in ["調教", "sm", "服従", "奴隷", "飼育"])
    is_sibling = any(k in theme_lower for k in ["近親", "義妹", "義姉", "兄妹", "姉弟", "sibling"])
    is_anal = any(k in theme_lower for k in ["anal", "アナル", "肛門"])
    is_isekai = any(k in theme_lower for k in ["isekai", "異世界", "fantasy", "ファンタジー", "勇者", "魔王", "奴隷"])
    is_onsen = any(k in theme_lower for k in ["温泉", "onsen", "入浴", "風呂", "銭湯"])
    is_swimsuit = any(k in theme_lower for k in ["水着", "プール", "海", "swimsuit", "水泳"])
    is_sleep = any(k in theme_lower for k in ["睡眠", "夜這い", "sleep", "寝", "添い寝"])
    is_gangbang = any(k in theme_lower for k in ["輪姦", "集団", "group", "gangbang", "複数", "乱交"])
    is_medical = any(k in theme_lower for k in ["医療", "診察", "doctor", "医者", "検診", "ナース"])
    is_idol = any(k in theme_lower for k in ["アイドル", "idol", "芸能", "地下アイドル"])
    is_first_time = any(k in theme_lower for k in ["初体験", "処女", "first_time", "初めて"])
    is_ojou = any(k in theme_lower for k in ["お嬢様", "令嬢", "ojou", "upper_class"])
    is_bondage = any(k in theme_lower for k in ["拘束", "緊縛", "bondage", "縛り", "監禁"])
    is_stepfather = any(k in theme_lower for k in ["義父", "stepfather", "継父", "義理の父"])
    is_teacher = any(k in theme_lower for k in ["先生", "教師", "teacher", "教授"])

    if bubble_type == "thought":
        # v6.0 新テーマルーティング
        if is_isekai:
            pool = list(THOUGHT_POOL.get("contradiction", []))
            pool.extend(THOUGHT_POOL.get("self_surprise", []))
            pool.extend(THOUGHT_POOL.get("general", []))
            return pool
        elif is_onsen or is_swimsuit:
            pool = list(THOUGHT_POOL.get("water_thought", []))
            pool.extend(THOUGHT_POOL.get("body_awareness", []))
            pool.extend(THOUGHT_POOL.get("general", []))
            return pool
        elif is_sleep:
            pool = list(THOUGHT_POOL.get("sleep_thought", []))
            pool.extend(THOUGHT_POOL.get("body_awareness", []))
            pool.extend(THOUGHT_POOL.get("general", []))
            return pool
        elif is_gangbang:
            pool = list(THOUGHT_POOL.get("contradiction", []))
            pool.extend(THOUGHT_POOL.get("forced", []))
            pool.extend(THOUGHT_POOL.get("general", []))
            return pool
        elif is_medical:
            pool = list(THOUGHT_POOL.get("contradiction", []))
            pool.extend(THOUGHT_POOL.get("body_awareness", []))
            pool.extend(THOUGHT_POOL.get("general", []))
            return pool
        elif is_idol:
            pool = list(THOUGHT_POOL.get("public_shame", []))
            pool.extend(THOUGHT_POOL.get("contradiction", []))
            pool.extend(THOUGHT_POOL.get("general", []))
            return pool
        elif is_first_time:
            pool = list(THOUGHT_POOL.get("first_time_thought", []))
            pool.extend(THOUGHT_POOL.get("body_awareness", []))
            pool.extend(THOUGHT_POOL.get("sensitivity", []))
            pool.extend(THOUGHT_POOL.get("general", []))
            return pool
        elif is_anal:
            pool = list(THOUGHT_POOL.get("anal_thought", []))
            pool.extend(THOUGHT_POOL.get("body_awareness", []))
            if intensity >= 4:
                pool.extend(THOUGHT_POOL.get("orgasm_thought", []))
            pool.extend(THOUGHT_POOL.get("general", []))
            return pool
        elif is_ntr:
            pool = list(THOUGHT_POOL["ntr"])
            if intensity >= 3:
                pool.extend(THOUGHT_POOL.get("contradiction", []))
            pool.extend(THOUGHT_POOL.get("jealousy", []))
            return pool
        elif is_hypnosis:
            pool = list(THOUGHT_POOL.get("hypnosis", []))
            pool.extend(THOUGHT_POOL.get("corruption", []))
            if intensity >= 3:
                pool.extend(THOUGHT_POOL.get("submission", []))
            return pool
        elif is_public:
            pool = list(THOUGHT_POOL.get("public", []))
            pool.extend(THOUGHT_POOL.get("public_shame", []))
            pool.extend(THOUGHT_POOL.get("chikan_resistance", []))
            if intensity >= 3:
                pool.extend(THOUGHT_POOL.get("body_awareness", []))
                pool.extend(THOUGHT_POOL.get("contradiction", []))
            return pool
        elif is_training:
            pool = list(THOUGHT_POOL.get("corruption", []))
            pool.extend(THOUGHT_POOL.get("submission", []))
            pool.extend(THOUGHT_POOL.get("toy_thought", []))
            if intensity >= 4:
                pool.extend(THOUGHT_POOL.get("pain_pleasure", []))
            return pool
        elif is_sibling:
            pool = list(THOUGHT_POOL.get("sibling_guilt", []))
            pool.extend(THOUGHT_POOL.get("guilt", []))
            pool.extend(THOUGHT_POOL.get("general", []))
            return pool
        elif is_bondage:
            pool = list(THOUGHT_POOL.get("forced", []))
            pool.extend(THOUGHT_POOL.get("resignation", []))
            pool.extend(THOUGHT_POOL.get("pleasure_denial", []))
            if intensity >= 4:
                pool.extend(THOUGHT_POOL.get("addiction", []))
            return pool
        elif is_stepfather:
            pool = list(THOUGHT_POOL.get("guilt", []))
            pool.extend(THOUGHT_POOL.get("confusion", []))
            pool.extend(THOUGHT_POOL.get("contradiction", []))
            return pool
        elif is_forced:
            # forced: 専用プール + reluctant + 矛盾型 + 怒り/諦めの混合
            pool = list(THOUGHT_POOL.get("forced", []))
            pool.extend(THOUGHT_POOL["reluctant"])
            pool.extend(THOUGHT_POOL.get("contradiction", []))
            pool.extend(THOUGHT_POOL.get("rage", []))
            pool.extend(THOUGHT_POOL.get("oral_thought", []))
            if intensity >= 3:
                pool.extend(THOUGHT_POOL.get("pleasure_denial", []))
            if intensity >= 4:
                pool.extend(THOUGHT_POOL.get("pain_pleasure", []))
                pool.extend(THOUGHT_POOL.get("resignation", []))
            return pool
        elif "純愛" in theme or "vanilla" in theme_lower:
            pool = list(THOUGHT_POOL["vanilla"])
            if intensity >= 3:
                pool.extend(THOUGHT_POOL.get("body_awareness", []))
            return pool
        elif "堕落" in theme or "催眠" in theme or "調教" in theme or "corruption" in theme_lower:
            pool = list(THOUGHT_POOL["corruption"])
            if intensity >= 3:
                pool.extend(THOUGHT_POOL.get("self_surprise", []))
                pool.extend(THOUGHT_POOL.get("addiction", []))
            return pool
        elif "嫌" in theme or "無理" in theme or "抵抗" in theme:
            pool = list(THOUGHT_POOL["reluctant"])
            pool.extend(THOUGHT_POOL.get("contradiction", []))
            pool.extend(THOUGHT_POOL.get("pleasure_denial", []))
            return pool
        # 一般テーマ: intensity連動で覚醒+身体感覚+驚き系を混合
        pool = list(THOUGHT_POOL["general"])
        if intensity >= 3:
            pool.extend(THOUGHT_POOL.get("awakening", []))
            pool.extend(THOUGHT_POOL.get("body_awareness", []))
            pool.extend(THOUGHT_POOL.get("self_surprise", []))
            pool.extend(THOUGHT_POOL.get("sensitivity", []))
        if intensity >= 4:
            pool.extend(THOUGHT_POOL.get("confusion", []))
            pool.extend(THOUGHT_POOL.get("orgasm_thought", []))
        return pool
    elif bubble_type == "speech":
        pool = []
        # v6.0 新テーマルーティング
        if is_isekai:
            pool.extend(SPEECH_FEMALE_POOL.get("fantasy_react", []))
            if intensity <= 2:
                pool.extend(SPEECH_FEMALE_POOL.get("first_time", []))
            if intensity >= 4:
                pool.extend(SPEECH_FEMALE_POOL.get("ecstasy", []))
            pool.extend(SPEECH_FEMALE_POOL.get("embarrassed", []))
            return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
        if is_onsen or is_swimsuit:
            pool.extend(SPEECH_FEMALE_POOL.get("water_scene", []))
            pool.extend(SPEECH_FEMALE_POOL.get("embarrassed", []))
            if intensity >= 4:
                pool.extend(SPEECH_FEMALE_POOL.get("ecstasy", []))
            return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
        if is_sleep:
            pool.extend(SPEECH_FEMALE_POOL.get("sleep_react", []))
            if intensity >= 3:
                pool.extend(SPEECH_FEMALE_POOL.get("acceptance", []))
            return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
        if is_gangbang:
            pool.extend(SPEECH_FEMALE_POOL.get("multi_partner", []))
            pool.extend(SPEECH_FEMALE_POOL.get("plea", []))
            pool.extend(SPEECH_FEMALE_POOL.get("ecstasy", []))
            return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
        if is_medical:
            pool.extend(SPEECH_FEMALE_POOL.get("embarrassed", []))
            pool.extend(SPEECH_FEMALE_POOL.get("denial", []))
            if intensity >= 3:
                pool.extend(SPEECH_FEMALE_POOL.get("acceptance", []))
            return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
        if is_idol:
            pool.extend(SPEECH_FEMALE_POOL.get("embarrassed", []))
            pool.extend(SPEECH_FEMALE_POOL.get("public", []))
            pool.extend(SPEECH_FEMALE_POOL.get("denial", []))
            return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
        if is_first_time:
            pool.extend(SPEECH_FEMALE_POOL.get("first_time", []))
            pool.extend(SPEECH_FEMALE_POOL.get("embarrassed", []))
            pool.extend(SPEECH_FEMALE_POOL.get("fingering_react", []))
            if intensity >= 4:
                pool.extend(SPEECH_FEMALE_POOL.get("acceptance", []))
            return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
        if is_ojou:
            pool.extend(SPEECH_FEMALE_POOL.get("ojou_formal", []))
            pool.extend(SPEECH_FEMALE_POOL.get("embarrassed", []))
            if intensity >= 4:
                pool.extend(SPEECH_FEMALE_POOL.get("ecstasy", []))
            return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
        # テーマ特化: 催眠
        if is_hypnosis:
            pool.extend(SPEECH_FEMALE_POOL.get("hypnosis", []))
            pool.extend(SPEECH_FEMALE_POOL.get("submissive", []))
            if intensity >= 4:
                pool.extend(SPEECH_FEMALE_POOL.get("ecstasy", []))
            if intensity >= 5:
                pool.extend(SPEECH_FEMALE_POOL.get("receiving_climax", []))
            return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
        # テーマ特化: 痴漢・公共
        if is_public:
            pool.extend(SPEECH_FEMALE_POOL.get("public", []))
            pool.extend(SPEECH_FEMALE_POOL.get("chikan", []))
            pool.extend(SPEECH_FEMALE_POOL.get("embarrassed", []))
            pool.extend(SPEECH_FEMALE_POOL.get("denial", []))
            if intensity >= 4:
                pool.extend(SPEECH_FEMALE_POOL.get("plea", []))
            return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
        # テーマ特化: NTR（比較表現を混合）
        if is_ntr:
            pool.extend(SPEECH_FEMALE_POOL.get("ecstasy", []))
            pool.extend(SPEECH_FEMALE_POOL.get("ntr_comparison", []))
            if intensity >= 5:
                pool.extend(SPEECH_FEMALE_POOL.get("receiving_climax", []))
            return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
        # テーマ特化: 調教/SM → 堕落懇願系
        if is_training:
            pool.extend(SPEECH_FEMALE_POOL.get("degradation", []))
            pool.extend(SPEECH_FEMALE_POOL.get("submissive", []))
            pool.extend(SPEECH_FEMALE_POOL.get("toy_react", []))
            if intensity >= 4:
                pool.extend(SPEECH_FEMALE_POOL.get("pain_pleasure", []))
                pool.extend(SPEECH_FEMALE_POOL.get("ecstasy", []))
            return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
        # テーマ特化: 近親/義妹
        if is_sibling:
            pool.extend(SPEECH_FEMALE_POOL.get("sibling", []))
            pool.extend(SPEECH_FEMALE_POOL.get("embarrassed", []))
            if intensity >= 4:
                pool.extend(SPEECH_FEMALE_POOL.get("acceptance", []))
            return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
        # テーマ特化: アナル
        if is_anal:
            pool.extend(SPEECH_FEMALE_POOL.get("anal", []))
            pool.extend(SPEECH_FEMALE_POOL.get("anal_react", []))
            if intensity >= 4:
                pool.extend(SPEECH_FEMALE_POOL.get("pain_pleasure", []))
                pool.extend(SPEECH_FEMALE_POOL.get("cum_react", []))
            if intensity >= 5:
                pool.extend(SPEECH_FEMALE_POOL.get("multiple_orgasm", []))
            return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
        if is_bondage:
            pool.extend(SPEECH_FEMALE_POOL.get("bondage_react", []))
            pool.extend(SPEECH_FEMALE_POOL.get("denial", []))
            if intensity >= 3:
                pool.extend(SPEECH_FEMALE_POOL.get("plea", []))
            if intensity >= 4:
                pool.extend(SPEECH_FEMALE_POOL.get("pain_pleasure", []))
            return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
        if is_stepfather:
            pool.extend(SPEECH_FEMALE_POOL.get("denial", []))
            pool.extend(SPEECH_FEMALE_POOL.get("embarrassed", []))
            pool.extend(SPEECH_FEMALE_POOL.get("sibling", []))
            if intensity >= 4:
                pool.extend(SPEECH_FEMALE_POOL.get("acceptance", []))
            return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
        if is_forced:
            # 暴行/強制テーマ: 合意セリフ(acceptance/ecstasy)は使わない
            pool.extend(SPEECH_FEMALE_POOL.get("denial", []))
            pool.extend(SPEECH_FEMALE_POOL.get("anger", []))
            pool.extend(SPEECH_FEMALE_POOL.get("embarrassed", []))
            pool.extend(SPEECH_FEMALE_POOL.get("deepthroat_react", []))
            if intensity >= 4:
                pool.extend(SPEECH_FEMALE_POOL.get("plea", []))
                pool.extend(SPEECH_FEMALE_POOL.get("pain_pleasure", []))
            return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
        # 通常テーマ: intensity連動で適切なカテゴリを選択
        if intensity <= 2:
            pool.extend(SPEECH_FEMALE_POOL.get("denial", []))
            pool.extend(SPEECH_FEMALE_POOL.get("embarrassed", []))
            pool.extend(SPEECH_FEMALE_POOL.get("teasing", []))
        elif intensity == 3:
            pool.extend(SPEECH_FEMALE_POOL.get("plea", []))
            pool.extend(SPEECH_FEMALE_POOL.get("acceptance", []))
            pool.extend(SPEECH_FEMALE_POOL.get("embarrassed", []))
            pool.extend(SPEECH_FEMALE_POOL.get("insertion", []))
            pool.extend(SPEECH_FEMALE_POOL.get("position_change", []))
            pool.extend(SPEECH_FEMALE_POOL.get("size_react", []))
            pool.extend(SPEECH_FEMALE_POOL.get("oral_react", []))
            pool.extend(SPEECH_FEMALE_POOL.get("fingering_react", []))
            pool.extend(SPEECH_FEMALE_POOL.get("paizuri_react", []))
        elif intensity == 4:
            pool.extend(SPEECH_FEMALE_POOL.get("acceptance", []))
            pool.extend(SPEECH_FEMALE_POOL.get("plea", []))
            pool.extend(SPEECH_FEMALE_POOL.get("ecstasy", []))
            pool.extend(SPEECH_FEMALE_POOL.get("beg", []))
            pool.extend(SPEECH_FEMALE_POOL.get("round2", []))
            pool.extend(SPEECH_FEMALE_POOL.get("size_react", []))
            pool.extend(SPEECH_FEMALE_POOL.get("praise_react", []))
            pool.extend(SPEECH_FEMALE_POOL.get("multiple_orgasm", []))
            pool.extend(SPEECH_FEMALE_POOL.get("cum_react", []))
            pool.extend(SPEECH_FEMALE_POOL.get("toy_react", []))
        else:
            pool.extend(SPEECH_FEMALE_POOL.get("ecstasy", []))
            pool.extend(SPEECH_FEMALE_POOL.get("submissive", []))
            pool.extend(SPEECH_FEMALE_POOL.get("plea", []))
            pool.extend(SPEECH_FEMALE_POOL.get("beg", []))
            pool.extend(SPEECH_FEMALE_POOL.get("receiving_climax", []))
            pool.extend(SPEECH_FEMALE_POOL.get("afterglow", []))
            pool.extend(SPEECH_FEMALE_POOL.get("nakadashi", []))
            pool.extend(SPEECH_FEMALE_POOL.get("multiple_orgasm", []))
            pool.extend(SPEECH_FEMALE_POOL.get("cum_react", []))
        # テーマ親和度による補足（一般テーマルーティング後にaffinity高カテゴリを追加）
        _theme_key = ""
        if "vanilla" in theme_lower or "純愛" in theme_lower:
            _theme_key = "vanilla"
        elif "love" in theme_lower or "恋愛" in theme_lower:
            _theme_key = "love"
        elif is_ntr:
            _theme_key = "ntr"
        elif is_forced:
            _theme_key = "forced"
        elif is_training:
            _theme_key = "training"
        elif "corruption" in theme_lower or "堕落" in theme_lower:
            _theme_key = "corruption"
        if _theme_key:
            for cat, entries in SPEECH_FEMALE_POOL.items():
                _extend_with_affinity(pool, cat, _theme_key, entries)
        return pool if pool else [v for sp in SPEECH_FEMALE_POOL.values() for v in sp]
    return []


def get_male_speech_pool_for_theme(theme: str = "", intensity: int = 3) -> list:
    """テーマとintensityに応じた男性セリフプールを返す"""
    t = theme.lower() if theme else ""
    pool = []
    # v6.0 新テーマルーティング
    if any(k in t for k in ["isekai", "異世界", "fantasy", "ファンタジー", "勇者", "魔王"]):
        pool.extend(SPEECH_MALE_POOL.get("fantasy_hero", []))
        pool.extend(SPEECH_MALE_POOL.get("command", []))
    elif any(k in t for k in ["医療", "診察", "doctor", "医者", "検診", "ナース"]):
        pool.extend(SPEECH_MALE_POOL.get("doctor", []))
        pool.extend(SPEECH_MALE_POOL.get("gentle_dom", []))
    elif any(k in t for k in ["おじさん", "ojisan", "中年", "おっさん"]):
        pool.extend(SPEECH_MALE_POOL.get("ojisan", []))
        pool.extend(SPEECH_MALE_POOL.get("dirty", []))
    elif any(k in t for k in ["先生", "教師", "teacher", "教授", "家庭教師"]):
        pool.extend(SPEECH_MALE_POOL.get("teacher", []))
        pool.extend(SPEECH_MALE_POOL.get("gentle_dom", []))
    elif any(k in t for k in ["ヤクザ", "極道", "yakuza", "組", "暴力団"]):
        pool.extend(SPEECH_MALE_POOL.get("yakuza", []))
        pool.extend(SPEECH_MALE_POOL.get("command", []))
    elif any(k in t for k in ["同級生", "クラスメイト", "classmate", "同い年"]):
        pool.extend(SPEECH_MALE_POOL.get("classmate", []))
        pool.extend(SPEECH_MALE_POOL.get("praise", []))
    elif any(k in t for k in ["義父", "継父", "stepfather", "義理の父"]):
        pool.extend(SPEECH_MALE_POOL.get("stepfather", []))
        pool.extend(SPEECH_MALE_POOL.get("gentle_dom", []))
    elif any(k in t for k in ["不良", "ヤンキー", "delinquent", "チンピラ"]):
        pool.extend(SPEECH_MALE_POOL.get("delinquent", []))
        pool.extend(SPEECH_MALE_POOL.get("command", []))
    elif any(k in t for k in ["睡眠", "夜這い", "sleep", "添い寝"]):
        pool.extend(SPEECH_MALE_POOL.get("gentle", []))
        pool.extend(SPEECH_MALE_POOL.get("command", []))
    elif any(k in t for k in ["輪姦", "集団", "gangbang", "複数", "乱交"]):
        pool.extend(SPEECH_MALE_POOL.get("command", []))
        pool.extend(SPEECH_MALE_POOL.get("dirty", []))
        pool.extend(SPEECH_MALE_POOL.get("taunt", []))
    elif any(k in t for k in ["アイドル", "idol", "芸能"]):
        pool.extend(SPEECH_MALE_POOL.get("gentle_dom", []))
        pool.extend(SPEECH_MALE_POOL.get("praise", []))
    elif any(k in t for k in ["風俗", "prostitution", "ソープ", "デリヘル"]):
        pool.extend(SPEECH_MALE_POOL.get("praise", []))
        pool.extend(SPEECH_MALE_POOL.get("gentle", []))
        pool.extend(SPEECH_MALE_POOL.get("dirty", []))
    elif any(k in t for k in ["痴漢", "chikan", "公共", "public", "電車", "train", "トイレ"]):
        pool.extend(SPEECH_MALE_POOL.get("chikan", []))
        pool.extend(SPEECH_MALE_POOL.get("taunt", []))
        pool.extend(SPEECH_MALE_POOL.get("public", []))
        pool.extend(SPEECH_MALE_POOL.get("command", []))
    elif any(k in t for k in ["anal", "アナル", "肛門"]):
        pool.extend(SPEECH_MALE_POOL.get("anal", []))
        pool.extend(SPEECH_MALE_POOL.get("command", []))
        pool.extend(SPEECH_MALE_POOL.get("dirty", []))
    elif any(k in t for k in ["ntr", "寝取", "夜這", "村", "レイプ", "陵辱"]):
        pool.extend(SPEECH_MALE_POOL.get("command", []))
        pool.extend(SPEECH_MALE_POOL.get("dirty", []))
        pool.extend(SPEECH_MALE_POOL.get("jealousy", []))
    elif any(k in t for k in ["調教", "sm", "奴隷", "飼育"]):
        pool.extend(SPEECH_MALE_POOL.get("command", []))
        pool.extend(SPEECH_MALE_POOL.get("degradation", []))
        pool.extend(SPEECH_MALE_POOL.get("dirty", []))
    elif any(k in t for k in ["催眠", "洗脳", "hypnosis"]):
        pool.extend(SPEECH_MALE_POOL.get("command", []))
        pool.extend(SPEECH_MALE_POOL.get("gentle_dom", []))
    elif any(k in t for k in ["純愛", "ラブ", "恋人", "カップル", "幼なじみ"]):
        pool.extend(SPEECH_MALE_POOL.get("gentle", []))
        pool.extend(SPEECH_MALE_POOL.get("gentle_dom", []))
        pool.extend(SPEECH_MALE_POOL.get("praise", []))
    else:
        if intensity >= 4:
            pool.extend(SPEECH_MALE_POOL.get("command", []))
            pool.extend(SPEECH_MALE_POOL.get("dirty", []))
        else:
            pool.extend(SPEECH_MALE_POOL.get("dirty", []))
            pool.extend(SPEECH_MALE_POOL.get("praise", []))
            pool.extend(SPEECH_MALE_POOL.get("gentle_dom", []))
    # intensity 1-2で前戯セリフ追加（全テーマ共通）
    if intensity <= 2:
        pool.extend(SPEECH_MALE_POOL.get("foreplay", []))
    # intensity 3+で息遣い追加（全テーマ共通）
    if intensity >= 3:
        pool.extend(SPEECH_MALE_POOL.get("breath", []))
    # intensity 4+で射精宣言バリエーション追加（全テーマ共通）
    if intensity >= 4:
        pool.extend(SPEECH_MALE_POOL.get("cum_announce", []))
    # intensity 5で射精宣言プール追加（全テーマ共通）
    if intensity >= 5:
        pool.extend(SPEECH_MALE_POOL.get("climax", []))
    return pool if pool else [v for sp in SPEECH_MALE_POOL.values() for v in sp]


def get_female_speech_pool(situation: str = "") -> list:
    """状況に応じた女性セリフプールを返す"""
    if situation in SPEECH_FEMALE_POOL:
        return SPEECH_FEMALE_POOL[situation]
    combined = []
    for pool in SPEECH_FEMALE_POOL.values():
        combined.extend(pool)
    return combined


def get_male_speech_pool(male_type: str = "") -> list:
    """タイプに応じた男性セリフプールを返す"""
    if male_type in SPEECH_MALE_POOL:
        return SPEECH_MALE_POOL[male_type]
    combined = []
    for pool in SPEECH_MALE_POOL.values():
        combined.extend(pool)
    return combined


# ============================================================================
# 男性セリフ短縮辞書（長文→8文字以内の命令形/断定形に変換）
# ============================================================================
MALE_SHORT_REPLACEMENTS = {
    # 描写的な長文 → 短い命令形/断定形（全出力をユニークに）
    "こんなに締まってんぞ": "締まるな",
    "こんなに締まって": "締まりすぎだ",
    "すごくいい…締まってる": "いい締まりだ",
    "こんな膣": "たまらんな",
    "ずっと待ってたんだ": "待たせたな",
    "本当は感じてんだろ": "感じてんだろ",
    "本当はほしいんだろ": "欲しいんだろ",
    "勝手に動いてんぞ": "腰振ってんぞ",
    "抵抗できてねぇ": "無駄だよ",
    "抵抗できてない": "抵抗すんな",
    "我慢できなくなってんな": "もう無理だろ",
    "我慢できてねぇんだろ": "我慢すんな",
    "身体が素直に反応してんな": "正直だろ",
    "声漏れてんぞ": "声出てんぞ",
    "もう限界だな": "限界だろ",
    "完全に堕ちちゃってるな": "堕ちたな",
    "逃げられねぇぞ": "逃がさねえ",
    "おくまでぐちゃぐちゃだ": "ぐちゃぐちゃだ",
    "もう隠すなよ": "隠すなよ",
    "全部出してやる": "全部出すぞ",
    "声出てんぞ…抵抗できてねぇ": "バレてんぞ",
    "声、我慢できなくなってんな": "堪えろよ",
    "もう我慢できてねぇんだろ": "もう限界だろ",
    "おく…ぐちゃぐちゃになってんぞ": "奥までだ",
    "膣、こんなに締まってんぞ…最高だ": "極上だ",
    "腰が勝手に動いてんぞ…本当はほしいんだろ": "素直だろ",
    "限界だな…もう堪えられてねぇ": "限界だろ",
    "もう限界だな…声漏れてんぞ": "漏れてんぞ",
    "いい顔になってんな": "いい顔だ",
    "もう逃げられねぇ": "もう遅え",
    # v7.0追加（+20）
    "そろそろ出しそうだ": "出すぞ",
    "中に出してやるよ": "中出しだ",
    "もっと声を出してみろよ": "声出せ",
    "こんなに濡らしやがって": "びしょ濡れだろ",
    "お前の中は最高だぜ": "最高だ",
    "もう少しで終わるからな": "もうすぐだ",
    "お前が悪いんだからな": "自業自得だ",
    "嫌と言っても体は正直だな": "正直だろ",
    "こんな顔して感じてんのか": "いい顔してんな",
    "何回イっても止まらねぇな": "止まんねぇな",
    "このまま犯してやるよ": "犯すぞ",
    "俺の言うことを聞けよ": "従え",
    "まだまだこれからだぞ": "まだまだだ",
    "お前のことが好きだったんだよ": "好きだった",
    "ずっと我慢してたんだ": "我慢の限界だ",
    "俺以外のことは忘れろ": "俺だけ見ろ",
    "もう二度と逃がしてやらない": "逃がさねえ",
    "お前は俺のものになるんだ": "俺のもんだ",
    "こんなに感じるなんて思わなかった": "感じすぎだ",
    "お前…こんな体になっちゃって": "変わっちまったな",
}


def shorten_male_speech(text: str, max_len: int = 15) -> str:
    """男性セリフを最大max_len文字に短縮する。
    1. MALE_SHORT_REPLACEMENTS辞書で既知の長文を変換
    2. それでも長ければ最初の句切り（…）までをカット
    3. max_len以下ならそのまま返す（強制切り詰めしない）
    """
    if len(text) <= max_len:
        return text

    # 辞書マッチ（部分一致: 長い方を優先）
    for long_form, short_form in sorted(MALE_SHORT_REPLACEMENTS.items(),
                                         key=lambda x: len(x[0]), reverse=True):
        if long_form in text:
            return short_form

    # …で区切って先頭部分のみ取得
    if "…" in text:
        first_part = text.split("…")[0]
        if 2 <= len(first_part) <= max_len:
            return first_part

    # 強制切り詰めはしない（意味が壊れるため）
    return text


# ============================================================================
# ストーリーパターンライブラリ（エロ漫画頻出28パターン）
# generate_outline()でプロンプトに注入し、LLM出力の整合性を向上させる
# ============================================================================

# ============================================================================
# フェーズ別セリフDB（展開の流れに沿ったセリフ選択用）
# 既存のSPEECH_FEMALE_POOL（カテゴリ別）とは別テーブルとして共存
# ============================================================================
SCENE_PHASE_SPEECH_MAP = {
    "intro": {
        # 導入（i1）- 日常・状況設定
        "speech": [
            "おはよう", "ただいま", "久しぶり…", "あ、先輩",
            "どうしたの…？", "え…なに？", "呼んだ？", "はい…",
            "ここ…？", "こんにちは", "あの…", "えっと…",
            "何か用…？", "遅かったね", "お邪魔します",
            "ここで待ってたの？", "一人…？", "静かだね…",
        ],
        "thought": [
            "なんだろう…", "ドキドキする…", "緊張する…",
            "目が合った…", "近い…かも", "どうしよう…",
            "変な空気…", "意識しちゃう…", "落ち着かない…",
            "なんか変…", "胸がざわざわ…", "気のせいかな…",
        ],
        "male": [
            "よう", "来たか", "座れよ", "こっち来い",
            "遅いぞ", "待ってた", "二人きりだぞ",
        ],
        "moan": [],
        "onomatopoeia": ["ドキッ"],
    },
    "approach": {
        # 接近（i2）- ムード構築・距離が縮まる
        "speech": [
            "え…ちょ…", "近い…", "なに…するの…", "だめ…",
            "ちょっと待って…", "離して…", "触らないで…",
            "な、なに…？", "心臓…うるさい…", "見ないで…",
            "えっ…ここで…？", "誰か来たら…", "恥ずかしい…",
            "そんな目で見ないで…", "手…冷たい…", "急に…どうしたの…",
            "嘘…本気なの…？", "やだ…そんなの…",
        ],
        "thought": [
            "ドキドキが止まらない…", "顔…近い…", "逃げなきゃ…",
            "なんでこんな…", "体が動かない…", "怖い…けど…",
            "触られてる…", "嫌なのに…動けない…", "どうしよう…",
            "まさか…本気…？", "こんなの初めて…", "息が…荒い…",
        ],
        "male": [
            "逃がさねぇよ", "嫌がるなよ", "いい匂いだ",
            "大人しくしろ", "可愛い顔すんな", "観念しろ",
            "怖がんなって", "そんな顔すんな",
        ],
        "moan": [],
        "onomatopoeia": ["ドキドキ", "ゾクッ", "サワッ"],
    },
    "foreplay": {
        # 前戯（i3）- 焦らし・愛撫
        "speech": [
            "そこ…だめ…", "あ…触らないで…", "やぁ…",
            "恥ずかしい…", "見ないで…そんなとこ…", "声…出ちゃう…",
            "だめ…感じちゃう…", "ん…そこ弱い…", "もう…やめて…",
            "変な声…出ちゃう…", "くすぐったい…", "…気持ちいい…",
            "下着…脱がさないで…", "胸…触らないで…", "敏感なの…そこ…",
            "舐めないで…", "指…入れないで…", "お願い…そこだけは…",
            "こんなの…初めて…", "ひどい…焦らさないで…",
            "体…勝手に…", "止まらない…", "もっと…触って…",
        ],
        "thought": [
            "体が…熱い…", "感じてる…自分が信じられない…",
            "声が…止まらない…", "触られるだけで…こんなに…",
            "気持ちいい…のかも…", "頭がぼーっと…",
            "抵抗しなきゃ…なのに…", "体が反応してる…",
            "こんなに濡れて…恥ずかしい…", "もう…我慢できない…",
            "指が…中で…", "奥が…疼く…", "もっと…欲しい…",
            "こんなの…おかしい…", "体が…言うこと聞かない…",
            "とろけそう…", "どうしよう…止められない…",
        ],
        "male": [
            "感じてんだろ", "正直になれよ", "もっと声出せ",
            "ほら…濡れてるぞ", "我慢すんな", "もっと開けろ",
            "脱げ", "力抜け", "逃げんなよ", "おとなしくしろ",
        ],
        "moan": [
            "ん…", "あ…", "ふぁ…", "はぁ…", "んん…",
            "あっ…", "んっ…", "ひゃっ…", "やぁ…", "きゃっ…",
            "あぁ…", "ふあ…", "はあ…", "んぁ…", "あんっ…",
        ],
        "onomatopoeia": ["サワッ", "チュッ", "ペロッ", "クチュ", "ゾクッ"],
    },
    "penetration": {
        # 挿入（i3-4）- 本番開始
        "speech": [
            "入って…くる…", "おっきい…", "奥まで…",
            "あっ…動かないで…", "ゆっくり…して…", "痛…い…",
            "んっ…気持ちいい…", "そこ…当たって…", "深い…",
            "お腹の奥…", "全部…入ってる…", "動いて…",
            "もっと…奥…", "激しく…して…", "イイ…そこ…",
            "抜かないで…", "中…すごい…", "腰…動いちゃう…",
            "だめ…こんなの…", "体…壊れちゃう…", "すごい…当たる…",
            "もっと…", "止めないで…", "ここ…好き…♡",
        ],
        "thought": [
            "奥まで…来てる…", "いっぱい…になってく…",
            "こんなの…おかしくなる…", "気持ちよすぎて…",
            "真っ白…になる…", "溶けちゃう…",
            "もう…我慢できない…", "動いてる…中で…",
            "全部…感じちゃう…", "壊れちゃう…",
            "勝手に…動いちゃう…", "もっと欲しい…",
            "こんなに気持ちいいなんて…", "やばい…止まらない…",
            "奥の奥まで…♡", "もう…だめかも…",
        ],
        "male": [
            "最高だ", "もっと締めろ", "中すげぇ",
            "もっと鳴け", "逃がさねぇ", "奥まで入れるぞ",
            "動くぞ", "もっと欲しがれ", "止まんねぇ", "堪んねぇ",
        ],
        "moan": [
            "あっあっ…", "んんっ…あっ…", "はぁっ…んっ…",
            "あぁっ…♡", "やぁっ…あっ…", "んあっ…",
            "あっ…あっ…あっ…", "はぁっ…はぁっ…", "ひぁっ…",
            "あんっ…♡", "んくっ…あっ…", "ふぁっ…あぁ…",
            "あっ…んっ…♡", "やっ…あっ…", "はあっ…あっ…",
            "んっ…んっ…♡", "あああっ…", "ひあっ…あっ…",
        ],
        "onomatopoeia": ["ズブッ", "ヌプッ", "パンパン", "グチュグチュ", "ズンッ"],
    },
    "climax": {
        # 絶頂（i4-5）- クライマックス
        "speech": [
            "イク…イっちゃう…♡", "もう…だめ…♡♡", "イっちゃう…♡",
            "中に…出して…♡", "一緒に…イって…♡", "止まらない…♡♡",
            "おかしくなる…♡", "壊れちゃう…♡♡", "全部…出して…♡",
            "気持ちいい…♡♡♡", "頭…真っ白…♡", "飛んじゃう…♡♡",
            "もう…もう…♡♡", "すごい…すごい…♡♡", "お腹…熱い…♡",
            "中…いっぱい…♡♡", "だめ…また…イく…♡♡",
            "奥…すごい…♡♡♡", "もう…何も考えられない…♡",
            "幸せ…♡♡", "全部…受け止める…♡", "離さないで…♡♡",
            "もっと…ちょうだい…♡♡", "溶けちゃう…♡♡♡",
        ],
        "thought": [
            "頭…真っ白…♡", "壊れる…♡", "もう…だめ…♡",
            "何も考えられない…♡", "お腹の中…熱い…♡",
            "気持ちよすぎて…♡", "理性が…♡", "溶ける…♡♡",
            "全部…受け入れてる…♡", "体が…自分のじゃない…♡",
            "イく…止まらない…♡", "幸せ…♡♡",
            "もう…戻れない…♡", "おかしくなっちゃう…♡♡",
        ],
        "male": [
            "イケ", "中に出すぞ", "全部受けろ",
            "もう逃がさねぇ", "搾り取れ", "出すぞ",
            "一緒にイクぞ", "出る…っ",
            "もう我慢しねぇ", "全部出す",
        ],
        "moan": [
            "あっあっあっ…♡♡", "んほぉ…♡♡", "イっ…♡♡♡",
            "あひぃっ…♡♡", "あぁぁっ…♡♡♡", "んんんっ…♡♡",
            "はぁっ…はぁっ…♡♡", "いぐっ…♡♡", "あへぇ…♡♡♡",
            "おほぉ…♡♡", "あっ…イくイくイく…♡♡♡",
            "んくぅっ…♡♡", "ひぁぁっ…♡♡♡", "あぁんっ…♡♡",
            "やぁぁっ…♡♡♡", "ふぁぁっ…♡♡", "んおっ…♡♡♡",
            "あっ…あっ…♡♡♡", "きゃあっ…♡♡", "んあぁぁっ…♡♡♡",
            "あぁっ…あぁっ…♡♡♡", "はぁぁっ…♡♡♡", "ひゃあっ…♡♡♡",
        ],
        "onomatopoeia": ["ドクドク", "ドビュッ", "ビクビクッ", "パンパンパン", "ビュルル"],
    },
    "afterglow": {
        # 余韻（i3-4）- 事後
        "speech": [
            "…すごかった…", "…まだ…ドキドキしてる…",
            "…動けない…", "もう…無理…", "…疲れた…",
            "…びっくりした…", "恥ずかしい…今の…",
            "…お腹…いっぱい…", "…もう一回…したい…",
            "…中…まだ熱い…", "…幸せ…♡", "…抱きしめて…",
            "…このまま…いたい…", "…夢みたい…",
            "…ばか…", "…好き…♡",
        ],
        "thought": [
            "…体中…ぐったり…", "…まだ余韻が…",
            "信じられない…あんなに…", "…幸せ…なのかも…",
            "…もう戻れない…", "恥ずかしい…けど…",
            "…体が覚えちゃった…", "…また…したい…",
            "…何回イったんだろう…", "…夢じゃないよね…",
            "…このひとの匂い…", "…全部…受け入れちゃった…",
        ],
        "male": [
            "お疲れ", "よかったぞ", "もう終わりか？",
            "次もあるからな", "離すなよ",
        ],
        "moan": [
            "はぁ…はぁ…", "ん…ふぅ…", "あ……", "んん……",
            "はぁ……♡",
        ],
        "onomatopoeia": ["トクン", "ギュッ"],
    },
    # === サブフェーズ（early/late）===
    "foreplay_early": {
        "speech": [
            "え…そこ…", "触らないで…", "くすぐったい…",
            "やだ…恥ずかしい…", "見ないで…そんなとこ…",
            "なんで…脱がすの…", "下着…取らないで…",
            "そこ…敏感なの…", "声…出ちゃう…",
        ],
        "thought": [
            "触られてる…", "体が…熱くなってく…",
            "こんなの…初めて…", "逃げなきゃ…でも…",
            "感じちゃだめ…なのに…", "どうして…体が…",
        ],
        "male": [
            "ここか？", "正直になれよ", "嫌がるなよ",
            "もっと見せろ", "脱げ",
        ],
        "moan": ["ん…", "あ…", "ふぁ…", "はぁ…", "んん…"],
        "onomatopoeia": ["サワッ", "チュッ", "ペロッ"],
    },
    "foreplay_late": {
        "speech": [
            "だめ…感じちゃう…", "もう…やめて…",
            "こんなに…濡れて…", "入れて…ほしい…",
            "もう…我慢できない…", "奥が…疼く…",
            "お願い…早く…", "体…勝手に…",
            "もっと…触って…", "指…もっと奥…",
        ],
        "thought": [
            "もう…限界…", "入れてほしい…って思ってる…",
            "こんなに欲しがるなんて…", "体が…求めてる…",
            "とろけそう…", "もう…抵抗できない…",
        ],
        "male": [
            "もう濡れてるぞ", "入れてほしいのか？", "我慢すんな",
            "もっと開けろ", "ほら…こんなになって",
        ],
        "moan": ["あっ…", "んっ…♡", "はぁ…♡", "あぁ…♡", "んぁ…♡", "あんっ…", "ふあ…", "やぁ…♡"],
        "onomatopoeia": ["クチュ", "ヌルッ", "トロッ", "ゾクッ"],
    },
    "penetration_early": {
        "speech": [
            "入って…くる…", "おっきい…", "ゆっくり…して…",
            "痛…い…", "奥まで…", "全部…入ってる…",
            "動かないで…まだ…", "すごい…中…",
            "ん…慣れてきた…", "もう…大丈夫…",
        ],
        "thought": [
            "中に…来てる…", "いっぱい…になってく…",
            "こんなの…初めて…", "奥まで…感じる…",
            "痛い…けど…気持ちいい…", "体が…開いてく…",
        ],
        "male": ["入れるぞ", "きつい…", "中すげぇ", "動くぞ", "奥まで入れるぞ"],
        "moan": ["んっ…あっ…", "はぁっ…", "あぁ…っ", "んん…っ", "ふぁっ…", "やっ…"],
        "onomatopoeia": ["ズブッ", "ヌプッ", "ズンッ"],
    },
    "penetration_late": {
        "speech": [
            "激しく…して…♡", "もっと…奥…♡", "イイ…そこ…♡",
            "そこ…当たって…♡", "もっと…♡", "止めないで…♡",
            "腰…動いちゃう…♡", "中…すごい…♡",
            "気持ちいい…♡♡", "だめ…こんなの…♡",
        ],
        "thought": [
            "気持ちよすぎて…♡", "頭がぼーっと…♡",
            "もっと欲しい…♡", "勝手に…動いちゃう…♡",
            "止まらない…♡", "溶けちゃう…♡",
        ],
        "male": ["最高だ", "もっと締めろ", "もっと鳴け", "逃がさねぇ", "もっと欲しがれ", "堪んねぇ"],
        "moan": [
            "あっあっ…♡", "んんっ…あっ…♡", "はぁっ…んっ…♡",
            "あぁっ…♡", "やぁっ…あっ…♡", "んあっ…♡",
            "あっ…あっ…あっ…♡", "ふぁっ…あぁ…♡",
        ],
        "onomatopoeia": ["パンパン", "グチュグチュ", "ヌプヌプ", "パンッパンッ"],
    },
    "climax_early": {
        "speech": [
            "イク…イっちゃう…♡", "もう…だめ…♡♡",
            "おかしくなる…♡", "止まらない…♡♡",
            "気持ちいい…♡♡♡", "壊れちゃう…♡♡",
            "すごい…すごい…♡♡", "もう…もう…♡♡",
            "頭…真っ白…♡", "だめ…また…イく…♡♡",
        ],
        "thought": [
            "壊れる…♡", "何も考えられない…♡",
            "イく…止まらない…♡", "理性が…♡",
            "もう…だめ…♡", "体が…自分のじゃない…♡",
        ],
        "male": ["イケ", "もう逃がさねぇ", "もう我慢しねぇ", "出すぞ", "搾り取れ"],
        "moan": [
            "あっあっあっ…♡♡", "んほぉ…♡♡", "あひぃっ…♡♡",
            "あぁぁっ…♡♡♡", "はぁっ…はぁっ…♡♡", "いぐっ…♡♡",
        ],
        "onomatopoeia": ["パンパンパン", "ドクドク", "ビクビクッ"],
    },
    "climax_late": {
        "speech": [
            "中に…出して…♡♡", "一緒に…イって…♡♡",
            "全部…出して…♡♡", "お腹…熱い…♡♡",
            "中…いっぱい…♡♡♡", "飛んじゃう…♡♡",
            "全部…受け止める…♡♡", "もっと…ちょうだい…♡♡",
            "溶けちゃう…♡♡♡", "幸せ…♡♡♡",
        ],
        "thought": [
            "お腹の中…熱い…♡♡", "溶ける…♡♡",
            "全部…受け入れてる…♡♡", "幸せ…♡♡",
            "もう…戻れない…♡♡", "おかしくなっちゃう…♡♡",
        ],
        "male": ["中に出すぞ", "全部受けろ", "全部出す", "一緒にイクぞ", "出る…っ"],
        "moan": [
            "イっ…♡♡♡", "あへぇ…♡♡♡", "おほぉ…♡♡",
            "あっ…イくイくイく…♡♡♡", "んくぅっ…♡♡",
            "ひぁぁっ…♡♡♡", "んおっ…♡♡♡",
        ],
        "onomatopoeia": ["ドビュッ", "ビュルル", "ドクドクドク", "ビクンビクン"],
    },
}


STORY_PATTERN_LIBRARY = {
    "blackmail_corruption": {
        "name": "脅迫→堕落",
        "applicable_themes": ["netorare", "corruption", "forced", "脅迫", "弱み"],
        "beats": [
            "弱みを握られ、体を差し出すことを要求される",
            "渋々服を脱ぎ、最初の屈辱的な奉仕をさせられる",
            "脅迫者に体中を好き勝手に触られ弄ばれる",
            "挿入され、抵抗する気力を奪われていく",
            "繰り返される情事で体が快感を覚え始める",
            "自ら腰を振り、完全に堕ちきる",
        ],
        "dialogue_evolution": "拒絶→屈辱→抵抗→快感→渇望→完堕ち",
        "intensity_pattern": [1, 2, 3, 4, 4, 5],
        "key_lines": {
            "early": ["やめて…脱がさないで…", "お願い…そこは…触らないで…",
                       "言うこと聞くから…挿れないで…", "服…破かないで…", "嫌…体見ないで…"],
            "mid": ["奥まで…入ってる…", "嫌なのに…体が…濡れて…",
                     "また…イかされちゃう…", "抵抗できない…気持ちいい…", "おかしくなる…こんなので…"],
            "late": ["また…犯して…♡", "あの人のじゃないと…イけない…♡♡",
                      "中に出して…孕ませて…♡", "もう普通のじゃ…物足りない…♡", "壊れるまでして…♡♡"],
        },
    },
    "childhood_friend": {
        "name": "幼なじみ再会→関係変化",
        "applicable_themes": ["vanilla", "純愛", "幼なじみ", "再会", "love"],
        "beats": [
            "久しぶりに再会した幼なじみと二人きりで飲む",
            "酔った勢いでキスし、そのまま胸を触り始める",
            "昔の距離感で遠慮なく服を脱がせ合い、互いの体を貪る",
            "幼なじみの成長した体に興奮して挿入する",
            "昔を取り戻すように何度も体位を変えて激しく突く",
            "幼なじみの中に出して、これからの関係を確信する",
        ],
        "dialogue_evolution": "驚き→意識→触る→挿入→激しく→中出し",
        "intensity_pattern": [1, 1, 2, 3, 4, 5],
        "key_lines": {
            "early": ["久しぶり…こんなに大きくなって…", "触らないで…恥ずかしい…",
                       "昔と体が全然違う…", "二人きりだと…意識しちゃう…", "お酒のせい…近いよ…"],
            "mid": ["幼なじみにこんなこと…あっ…", "昔から…この体に触りたかった…",
                     "入ってる…久しぶりなのに…きつい…", "幼なじみのが…こんなに大きいなんて…", "奥まで…届いてる…あぁ…"],
            "late": ["幼なじみに中出しされちゃった♡", "もっと…もっとして♡",
                      "昔からこうしたかった♡", "離れてた分…全部取り戻して♡", "毎日…幼なじみに抱かれたい♡"],
        },
    },
    "tutor_student": {
        "name": "家庭教師×教え子",
        "applicable_themes": ["teacher_student", "先生", "家庭教師", "教え子", "年上"],
        "beats": [
            "勉強中に教え子の体が気になり、手が伸びる",
            "胸や太ももに触れ、教え子が抵抗できずに感じ始める",
            "机の上で服をはだけさせ、前戯に移る",
            "勉強机の上で挿入し、教え子が声を殺す",
            "体位を変えて激しく突き、教え子が快感に溺れる",
            "中出しして、次の授業日を約束する",
        ],
        "dialogue_evolution": "意識→触る→前戯→挿入→激しく→中出し",
        "intensity_pattern": [1, 2, 3, 3, 4, 5],
        "key_lines": {
            "early": ["先生…手がおかしいとこに…", "そこ触ったら…集中できない…",
                       "勉強中に…脱がさないで…", "先生…胸…揉まないで…", "太もも…撫でないで…"],
            "mid": ["先生の指…中に…あっ…", "机の上で…こんなこと…",
                     "先生のが…入ってきた…", "声出たら…親にバレる…", "教え子にこんなの…ずるい…"],
            "late": ["先生…中に出して♡", "毎週…体も教えて♡♡",
                      "勉強なんかより…こっちがいい♡", "先生のでイっちゃう♡♡", "授業料…体で払う♡♡"],
        },
    },
    "drunk_mistake": {
        "name": "酔った勢い→既成事実",
        "applicable_themes": ["vanilla", "OL", "飲み会", "酔い", "上司", "同僚"],
        "beats": [
            "飲み会/宅飲みで酔いが回り、体が密着する",
            "酔った勢いでキスし、互いの服を脱がし始める",
            "酔いに任せて体中を舐め合い、前戯する",
            "酔いを言い訳に挿入し、激しく求め合う",
            "何度もイかせ合い、朝まで犯し続ける",
            "朝起きて既成事実を受け入れ、シラフでもう一回",
        ],
        "dialogue_evolution": "大胆→脱がす→舐め合い→挿入→絶頂→朝の本番",
        "intensity_pattern": [1, 2, 3, 4, 5, 3],
        "key_lines": {
            "early": ["酔ってない…けどキスしたい…", "服…脱がさないでよ…酔ってるから…",
                       "ふわふわして…抵抗できない…", "ブラ外すの…早すぎ…", "酔った体…好きにしていいよ…"],
            "mid": ["酔ってるから…こんなに濡れて…", "挿れて…酒のせいにするから…",
                     "奥…当たってる…あっ…", "酔っててもわかる…大きい…", "朝になったら忘れるから…もっと…"],
            "late": ["シラフでも…もう一回して♡", "酔ってなくても…欲しかった♡",
                      "中に出して…酔いが覚めちゃう♡", "毎晩飲んで…毎晩ヤろ♡", "お酒より…精液で酔いたい♡♡"],
        },
    },
    "massage_escalation": {
        "name": "マッサージ→エスカレート",
        "applicable_themes": ["vanilla", "massage", "マッサージ", "整体", "オイル"],
        "beats": [
            "マッサージを始め、すぐに胸や太ももに手が伸びる",
            "オイルで滑る手が際どい場所を執拗に揉みほぐす",
            "マッサージを口実に下着を外し、秘部を直接刺激する",
            "感じすぎて抵抗できない体にそのまま挿入する",
            "オイルまみれの体を何度も体位を変えて貫く",
            "全身ぬるぬるのまま中出しして終了",
        ],
        "dialogue_evolution": "触る→揉む→愛撫→挿入→激しく→中出し",
        "intensity_pattern": [1, 2, 3, 3, 4, 5],
        "key_lines": {
            "early": ["胸は…マッサージ関係ないでしょ…", "オイルが…下着の中に…",
                       "太もも…内側は…やだ…", "うつ伏せだと…胸が…", "手が…お尻に…"],
            "mid": ["そこ…マッサージじゃない…あっ…", "指が…中に…入って…",
                     "オイルで…ぬるぬるして…感じる…", "お尻…揉まないで…声出ちゃう…", "力抜けて…抵抗できない…"],
            "late": ["マッサージより…こっちがいい♡", "オイルまみれで…挿れて♡",
                      "全身ぬるぬるのまま…中出しして♡", "指じゃなくて…本物がいい♡♡", "毎日…全身マッサージして♡♡"],
        },
    },
    "caught_masturbating": {
        "name": "自慰目撃→関係発展",
        "applicable_themes": ["vanilla", "corruption", "オナニー", "目撃", "覗き"],
        "beats": [
            "自慰中を目撃され、濡れた指を見られてしまう",
            "秘密にする代わりに体を要求される",
            "恥ずかしさの中、目の前で自慰を続けさせられる",
            "見られながら感じてしまい、そのまま挿入される",
            "自慰より気持ちいい快感に溺れる",
            "わざと見つかるように自慰して誘うようになる",
        ],
        "dialogue_evolution": "羞恥→要求→露出→挿入→快感→誘惑",
        "intensity_pattern": [2, 1, 2, 3, 4, 5],
        "key_lines": {
            "early": ["見ないで…指…濡れてる…", "お願い…忘れて…見なかったことに…",
                       "こんな格好…見られちゃった…", "鍵かけたのに…最悪…", "あそこ…見ないで…"],
            "mid": ["見られながら…感じちゃう…", "自分の指より…あなたのが…",
                     "入ってる…自慰より…全然…", "見てるなら…ちゃんとして…", "一人でしてたのバカみたい…"],
            "late": ["一人でするより…全然いい♡", "わざと鍵開けた…気づいて♡",
                      "見てて…イくとこ見て♡♡", "もう指じゃ…満足できない♡", "毎日…見つけて犯して♡♡"],
        },
    },
    "bet_game": {
        "name": "賭け/ゲーム→罰ゲーム",
        "applicable_themes": ["vanilla", "harem", "ゲーム", "罰ゲーム", "王様ゲーム", "賭け"],
        "beats": [
            "賭け/ゲームで負けて罰ゲームが脱衣からスタート",
            "下着姿を見られ、次の罰で胸を触らせる",
            "エスカレートしてフェラや愛撫の罰を受ける",
            "罰ゲームを口実にそのまま挿入される",
            "ゲームなんか忘れて激しく求め合う",
            "最後は中出しで罰ゲーム完了",
        ],
        "dialogue_evolution": "脱衣→触る→奉仕→挿入→激しく→中出し",
        "intensity_pattern": [1, 1, 2, 3, 4, 5],
        "key_lines": {
            "early": ["え…脱ぐの…？マジで…？", "ブラまで外すの…恥ずかしい…",
                       "罰ゲームだから…仕方ない…", "見ないでよ…裸…", "触るのは…罰に入ってないでしょ…"],
            "mid": ["罰でフェラ…するの…？", "罰ゲームなのに…感じちゃう…",
                     "入ってきた…これも罰…？", "ゲームなんか…もういい…もっと…", "わざと負けた…かも…"],
            "late": ["罰じゃなくて…ご褒美だった♡", "中出しも…罰ゲーム♡",
                      "毎日負けたい…♡♡", "次の罰は…アナル…？♡♡", "ゲームなしでも…ヤりたい♡♡"],
        },
    },
    "bodyswap_possession": {
        "name": "入れ替わり/憑依",
        "applicable_themes": ["bodyswap", "入れ替わり", "憑依", "変身", "time_stop"],
        "beats": [
            "入れ替わり/憑依して女体の感覚に戸惑う",
            "好奇心で胸やあそこを触り、異性の快感を知る",
            "自慰では足りず、他人に体を差し出す",
            "女体で挿入され、男では感じられない快感に翻弄される",
            "中イキを覚え、何度も絶頂を繰り返す",
            "快楽に溺れ、元の体に戻りたくなくなる",
        ],
        "dialogue_evolution": "困惑→自慰→差し出す→挿入→中イキ→堕落",
        "intensity_pattern": [1, 2, 3, 4, 4, 5],
        "key_lines": {
            "early": ["胸…触ったら…声出た…", "女の体…敏感すぎ…",
                       "あそこ…こんなに濡れるの…", "指入れたら…男と全然違う…", "乳首…硬くなってる…"],
            "mid": ["挿れられてる…女ってこんなに…", "奥に当たって…頭真っ白…",
                     "中イキって…こういうこと…", "男じゃ絶対…味わえない…", "子宮に…響いてる…"],
            "late": ["戻りたくない…この体最高…♡", "毎日犯されたい…♡♡",
                      "中出しされるの…気持ちぃ…♡♡", "女の快感…もう手放せない♡", "元の体なんか…いらない♡♡"],
        },
    },
    "overnight_stay": {
        "name": "お泊まり→夜這い",
        "applicable_themes": ["vanilla", "幼なじみ", "お泊まり", "夜這い", "同棲"],
        "beats": [
            "泊まることになり、布団の中で互いの体温を感じる",
            "暗闇で手が体に触れ、胸を揉み始める",
            "寝たふりしながら体を触り合い、下着の中に手が入る",
            "我慢できずに押し倒し、そのまま挿入する",
            "布団の中で激しく腰を振り、声を殺して求め合う",
            "朝まで何度も出し入れし、布団が精液で汚れる",
        ],
        "dialogue_evolution": "意識→触る→愛撫→挿入→激しく→朝まで",
        "intensity_pattern": [1, 2, 2, 3, 4, 5],
        "key_lines": {
            "early": ["布団…一つしかない…密着してる…", "手…胸に当たってる…わざと…？",
                       "起きてるでしょ…体硬いよ…", "パジャマの中に…手入れないで…", "暗いから…見えないと思って…"],
            "mid": ["寝たふりもう無理…あっ…", "布団の中で…入ってきた…",
                     "声出したら…聞こえちゃう…", "指…抜かないで…もっと奥…", "暗い中で…挿れられてる…"],
            "late": ["朝まで…出し続けて♡", "布団ぐちゃぐちゃ…♡",
                      "毎晩…泊まって犯して♡", "もう一回…出して♡♡", "寝かせないで…朝まで♡♡"],
        },
    },
    "gratitude_repayment": {
        "name": "恩返し→体で返す",
        "applicable_themes": ["vanilla", "恩返し", "お礼", "助け", "借り"],
        "beats": [
            "恩人に「体で返す」と服を脱ぎ始める",
            "恩人の前で裸になり、奉仕を始める",
            "フェラで感謝を伝え、体中を舐め尽くす",
            "お礼として自分から跨り、挿入を受け入れる",
            "恩人に激しく突かれながら、もっと恩を返したいと求める",
            "中出しされ、恩返しが日課になる",
        ],
        "dialogue_evolution": "脱ぐ→奉仕→フェラ→挿入→激しく→中出し",
        "intensity_pattern": [1, 1, 2, 3, 4, 5],
        "key_lines": {
            "early": ["お礼…体で返します…", "脱ぎますから…見てて…",
                       "恩人に…全部見せます…", "何でもする…って言ったから…", "服…脱がせてください…"],
            "mid": ["お礼のフェラ…上手い…？", "入れて…感謝の気持ちです…",
                     "奥まで…恩返し…させて…", "体…好きに使って…", "こんなに気持ちいいなんて…"],
            "late": ["恩返し…毎日したい♡", "中出しも…お礼です♡",
                      "精液…全部飲みます♡♡", "体で…一生返す♡♡", "恩人の専用肉便器になる♡♡"],
        },
    },
    "reunion_ex": {
        "name": "元カレ/元カノ再会",
        "applicable_themes": ["netorare", "vanilla", "再会", "元カレ", "元カノ", "復縁"],
        "beats": [
            "元カレ/元カノと再会し、二人きりで飲みに行く",
            "昔の話をしながら体が密着し、キスしてしまう",
            "今のパートナーへの罪悪感を感じつつ、服を脱がし合う",
            "あの頃より上手くなった体で互いを愛撫する",
            "背徳感の中で挿入し、昔より激しく求め合う",
            "彼氏/彼女がいるのに中出しされ、元の体を思い出す",
        ],
        "dialogue_evolution": "再会→キス→脱がす→愛撫→挿入→中出し",
        "intensity_pattern": [1, 2, 2, 3, 4, 5],
        "key_lines": {
            "early": ["久しぶり…体つき変わった…", "彼氏いるのに…二人きり…まずい…",
                       "触らないで…昔の感覚…戻っちゃう…", "キスだけ…キスだけだから…", "あの頃と同じ匂い…"],
            "mid": ["彼氏より…全然大きい…", "体が覚えてる…あなたの形…",
                     "一回だけ…最後だから…入れて…", "あの頃よりテク上がった…あっ…", "浮気してる…のに…気持ちいい…"],
            "late": ["やっぱり…元カレの精液が一番♡", "彼氏には…ないイき方…♡♡",
                      "生で出して…あの頃みたいに♡", "もう戻る…別れて戻る♡♡", "毎週会って…中出しして♡♡"],
        },
    },
    "secret_relationship": {
        "name": "秘密の関係（先生/上司）",
        "applicable_themes": ["teacher_student", "OL", "上司", "先生", "秘密", "禁断"],
        "beats": [
            "密室で二人きりになり、禁断の関係を意識する",
            "書庫/準備室で服を乱し、互いの体を貪り始める",
            "バレないように声を殺しながら前戯する",
            "立場を忘れて挿入し、机の上で激しく交わる",
            "秘密の情事が常態化し、場所と体位を変えて楽しむ",
            "バレるスリルで興奮しながら中出しされる",
        ],
        "dialogue_evolution": "密室→脱がす→前戯→挿入→常習→中出し",
        "intensity_pattern": [1, 2, 3, 4, 4, 5],
        "key_lines": {
            "early": ["ここでは…まずいよ…服…", "鍵閉めて…バレたら終わり…",
                       "立場があるのに…胸触らないで…", "隣の部屋に人が…声出せない…", "先生と生徒なのに…脱がさないで…"],
            "mid": ["机の上で…挿れないで…あっ…", "バレるって…奥突かないで…",
                     "声出しちゃう…隣に…聞こえる…", "鍵の隙間から…見えちゃう…", "秘密のセックス…興奮する…"],
            "late": ["バレるかも…でもイく♡", "もう隠すの疲れた…好きにして♡",
                      "スリルで…膣が締まる♡♡", "秘密の中出し…最高♡♡", "毎日…こっそりヤろ♡♡"],
        },
    },
    "aphrodisiac_effect": {
        "name": "媚薬/薬効果",
        "applicable_themes": ["corruption", "催眠", "媚薬", "薬", "aphrodisiac"],
        "beats": [
            "知らずに媚薬を摂取し、体が熱くなり股間が疼き出す",
            "我慢できず自分で触り始めるが、全然足りない",
            "体が言うことを聞かず、目の前の相手に縋りつく",
            "挿入された瞬間に激しく絶頂し、媚薬の快感に支配される",
            "何度イっても収まらず、自分から腰を振って求め続ける",
            "媚薬が切れても体が快感を覚え、また欲しがる",
        ],
        "dialogue_evolution": "発情→自慰→懇願→挿入絶頂→連続絶頂→依存",
        "intensity_pattern": [1, 2, 3, 4, 5, 5],
        "key_lines": {
            "early": ["体…熱い…あそこが…疼く…", "なにこれ…自分で触っちゃう…",
                       "指じゃ…足りない…おかしい…", "パンツ…びしょびしょ…", "我慢…できない…誰か…"],
            "mid": ["入った瞬間…イった…あぁ…", "おかしくなる…止まらない…",
                     "何回イっても…足りない…もっと…", "子宮が…精液求めてる…", "頭真っ白…薬のせいで…"],
            "late": ["もっと…もっと注いで…♡♡", "薬なくても…この体…もう…♡",
                      "毎日…媚薬漬けにして♡♡", "一日中…犯されたい♡♡", "中出し…何回でも受け止める♡♡"],
        },
    },
    "dare_challenge": {
        "name": "王様ゲーム/大胆チャレンジ",
        "applicable_themes": ["harem", "vanilla", "王様ゲーム", "チャレンジ", "パーティー"],
        "beats": [
            "王様ゲームで際どい命令が出て脱衣を強制される",
            "みんなの前で下着姿にされ、次の命令で体を触られる",
            "命令でキスやフェラなど性的行為をさせられる",
            "二人きりにされ、挿入を命令される",
            "命令関係なく激しく求め合い、何度もイかされる",
            "みんなに聞こえる声で絶頂し、中出しされる",
        ],
        "dialogue_evolution": "脱衣→触られる→奉仕→挿入→絶頂→中出し",
        "intensity_pattern": [1, 1, 2, 3, 4, 5],
        "key_lines": {
            "early": ["え…脱ぐの…みんなの前で…？", "下着まで…見られちゃう…",
                       "命令だから…触っていいって…", "胸…揉まれてる…見ないで…", "恥ずかしい…でも命令だから…"],
            "mid": ["命令で…フェラ…するの…？", "二人きりにされた…もう…",
                     "入ってきた…命令…関係ない…", "みんなに…聞こえちゃう…", "こんな命令…もっと…"],
            "late": ["命令じゃなくても…もっとして♡", "みんなに聞こえた…でもイった♡♡",
                      "王様ゲーム…毎日やりたい♡", "次は中出し命令して♡♡", "命令でアナルも…♡♡"],
        },
    },
    "rescue_gratitude": {
        "name": "助けられた恩→好意→関係",
        "applicable_themes": ["vanilla", "monster", "ファンタジー", "異世界", "助け"],
        "beats": [
            "危機から助けられ、恩人と二人きりになる",
            "感謝を伝えるうちに体を密着させ、キスする",
            "服を脱いで恩人に体を差し出し、愛撫される",
            "感謝と興奮の中で恩人に挿入され、声を上げる",
            "助けてもらった体を激しく使われ、快感に震える",
            "恩人の精液を受け止め、体と心を完全に捧げる",
        ],
        "dialogue_evolution": "感謝→密着→差し出す→挿入→激しく→中出し",
        "intensity_pattern": [1, 1, 2, 3, 4, 5],
        "key_lines": {
            "early": ["助けてくれたお礼…体で…", "服…脱ぎますから…見て…",
                       "恩人に…全部捧げます…", "好きにしてください…命の恩人…", "この体…あなたのものです…"],
            "mid": ["恩人に…犯されてる…嬉しい…", "助けてもらった体…奥まで…",
                     "挿れて…お礼させて…", "恩人のが…大きい…あっ…", "体も命も…あなたのもの…"],
            "late": ["恩人の精液…受け止める♡", "助けてくれた分…何度でも♡♡",
                      "命の恩人に中出しされたい♡", "毎日…恩返しさせて♡♡", "あなた専用の体になる♡♡"],
        },
    },
    "peeping_discovered": {
        "name": "覗き→発覚→共犯関係",
        "applicable_themes": ["corruption", "覗き", "盗撮", "着替え", "風呂"],
        "beats": [
            "着替え/入浴中を覗いてしまい、裸体を目撃する",
            "覗きが発覚し、秘密にする条件で体を要求される",
            "弱みを握られ、目の前で脱がされて体を触られる",
            "覗いていた体を直接犯され、抵抗できずに感じる",
            "覗かれることに興奮し、わざと見せつけながら求める",
            "覗きの共犯として、互いの体を貪り合う関係になる",
        ],
        "dialogue_evolution": "目撃→脅迫→脱がす→挿入→見せつけ→共犯",
        "intensity_pattern": [2, 1, 2, 3, 4, 5],
        "key_lines": {
            "early": ["裸…見たでしょ…最低…", "覗いてたの…全部見られた…",
                       "あそこまで…見たくせに…", "秘密にする代わり…体…？", "脱げって…こと…？"],
            "mid": ["覗いてた体…直接触るの…", "見てただけじゃ…足りないの…",
                     "入ってきた…覗きの犯人に…", "見られてると…感じちゃう…", "もっと見て…中まで…"],
            "late": ["覗いてないで…直接犯して♡", "わざと見せてあげる♡♡",
                      "覗きながら…イかせて♡♡", "全部…見ていいから♡♡", "毎日覗いて…毎日犯して♡♡"],
        },
    },
    "sibling_taboo": {
        "name": "義兄妹/近親タブー",
        "applicable_themes": ["近親", "義妹", "義姉", "兄妹", "姉弟", "sibling", "家族"],
        "beats": [
            "義兄妹として同居し、入浴中を見てしまう",
            "風呂上がりの薄着に欲情し、胸やお尻を触り始める",
            "親がいない隙に服を脱がせ、義妹/義姉の体を貪る",
            "禁断と分かりながら挿入し、兄妹で繋がってしまう",
            "家族がいる時もこっそり触り合い、隠れてセックスする",
            "親の寝室の隣で声を殺して激しく突く",
            "もう兄妹に戻れない体になり、中出しを懇願する",
        ],
        "dialogue_evolution": "目撃→触る→脱がす→挿入→隠れて→中出し→依存",
        "intensity_pattern": [1, 1, 2, 3, 4, 5, 5],
        "key_lines": {
            "early": ["お兄ちゃん…裸見ないで…", "義妹の体…触らないで…",
                       "お風呂上がり…そんな目で見ないで…", "胸…揉まないでよ…兄妹でしょ…", "パジャマの中に…手入れないで…"],
            "mid": ["兄妹なのに…入ってる…", "親の隣の部屋で…声出せない…",
                     "お兄ちゃんのが…中に…あっ…", "バレたら…家族崩壊…でも…", "義妹に…こんなの…ずるい…"],
            "late": ["お兄ちゃん…中出しして♡", "妹の子宮に…精液注いで♡♡",
                      "家族の前じゃ…妹…ベッドでは…♡♡", "毎晩…お兄ちゃんの部屋行く♡♡", "お兄ちゃんの赤ちゃん欲しい♡♡"],
        },
    },
    "hypnosis_training": {
        "name": "催眠調教",
        "applicable_themes": ["催眠", "洗脳", "hypnosis", "調教", "マインドコントロール"],
        "beats": [
            "催眠にかけられ、命令通りに服を脱いでしまう",
            "暗示で体が勝手に感じ、触られると抵抗できない",
            "恥ずかしい命令で自ら股を開き、性器を晒す",
            "催眠状態のまま挿入され、快感が直接脳に響く",
            "催眠なしでも体が反応し、命令を待つようになる",
            "完全に催眠奴隷となり、自ら求めて腰を振る",
        ],
        "dialogue_evolution": "脱衣→感じる→晒す→挿入→調教→自発",
        "intensity_pattern": [1, 2, 3, 4, 4, 5],
        "key_lines": {
            "early": ["勝手に…服脱いでる…なんで…", "体が…動かない…触らないで…",
                       "意識あるのに…股…開いちゃう…", "催眠なんか…効くわけ…あっ…", "命令されると…体が勝手に…"],
            "mid": ["挿れられてるのに…抵抗できない…", "催眠で…イかされてる…",
                     "頭ぼんやり…でも感じる…", "命令通り…腰振っちゃう…", "考えられない…快感だけ…"],
            "late": ["ご主人様…犯して命令して♡", "催眠なくても…もう奴隷…♡♡",
                      "脳まで…犯されてる♡♡", "命令で…イかせて♡♡", "思考停止して…犯されたい♡♡"],
        },
    },
    "maid_service": {
        "name": "メイド奉仕→主従逆転",
        "applicable_themes": ["メイド", "ご奉仕", "maid", "主従", "お嬢様", "執事"],
        "beats": [
            "メイドとして仕え、ご主人様に体を見られる",
            "着替えの手伝いを口実に、メイド服の中に手が入る",
            "奉仕の一環として口でご主人様を咥えさせられる",
            "メイド服を捲られたまま挿入され、奉仕しながら感じる",
            "主従の快楽に溺れ、あらゆる体位で犯される",
            "メイド服を精液で汚されて、完全な性奴隷メイドになる",
        ],
        "dialogue_evolution": "奉仕→触られる→フェラ→挿入→調教→完堕ち",
        "intensity_pattern": [1, 1, 2, 3, 4, 5],
        "key_lines": {
            "early": ["メイド服の中…触らないで…", "ご主人様…スカートの中は…",
                       "お着替え中に…胸見ないでください…", "エプロンの下…何もつけてません…", "ご奉仕…口で…ですか…"],
            "mid": ["メイド服のまま…挿れるんですか…", "ご主人様の…おっきい…あっ…",
                     "奉仕中に…イっちゃ…だめ…", "テーブルの上で…はしたない…", "メイドなのに…こんな声…"],
            "late": ["ご主人様…メイド服…精液で…♡", "体で…ご奉仕します♡♡",
                      "メイドの穴…全部使ってください♡♡", "ご主人様専用の…肉便器メイド♡♡", "毎日…体で朝のご奉仕♡♡"],
        },
    },
    "gym_trainer": {
        "name": "トレーナー×教え子",
        "applicable_themes": ["スポーツ", "ジム", "ヨガ", "トレーナー", "コーチ", "部活"],
        "beats": [
            "トレーニング指導で体を密着させ、胸やお尻に手が当たる",
            "汗だくのウェアの上から乳首を弄り、体勢を崩させる",
            "ストレッチを口実に股を開かせ、直接触り始める",
            "汗だくのまま挿入し、トレーニング器具の上で犯す",
            "体位を変えながら鍛えた体をフルに使って激しく突く",
            "汗と精液まみれになりながら絶頂する",
        ],
        "dialogue_evolution": "密着→乳首→触る→挿入→激しく→絶頂",
        "intensity_pattern": [1, 2, 2, 3, 4, 5],
        "key_lines": {
            "early": ["コーチ…手が胸に…", "汗で…ウェア透けてる…見ないで…",
                       "その体勢…お尻当たってます…", "ストレッチで…股開かないで…", "汗臭い…のに…近い…"],
            "mid": ["トレーニング器具の上で…挿れるの…", "汗だくで…ぬるぬる…入ってく…",
                     "鍛えた体で…こんなに激しく…", "スクワット体勢で…奥まで…", "コーチの…太い…あっ…"],
            "late": ["汗と精液まみれ…最高♡", "毎日…この特別レッスンして♡♡",
                      "鍛えた体…全部使って♡♡", "コーチの精液…プロテイン代わり♡♡", "筋肉痛より…子宮の奥が痛い♡♡"],
        },
    },
    "delivery_encounter": {
        "name": "出張/訪問→密室展開",
        "applicable_themes": ["出張", "宅配", "修理", "訪問", "配達", "家庭訪問"],
        "beats": [
            "訪問先で二人きりになり、密室で距離が近づく",
            "アクシデントで体が密着し、胸や尻が当たる",
            "帰れない状況を利用して、キスから服を脱がし始める",
            "玄関先/リビングで我慢できずに挿入する",
            "場所を変えながら家中で何度も犯す",
            "次の訪問日を決めて、中出しして帰る",
        ],
        "dialogue_evolution": "密室→密着→脱がす→挿入→激しく→中出し",
        "intensity_pattern": [1, 1, 2, 3, 4, 5],
        "key_lines": {
            "early": ["上がってください…二人きりですけど…", "密着しちゃって…ごめんなさい…",
                       "胸…当たってます…", "帰れないんですか…泊まって…？", "お茶…飲んだら…出られない…"],
            "mid": ["玄関で…立ったまま…挿れないで…", "配達員さんに…犯されてる…",
                     "制服のまま…ボタン外さないで…", "ソファで…奥まで…あっ…", "仕事中なのに…感じちゃう…"],
            "late": ["また配達に来て…体に♡", "毎回…中出し配達♡♡",
                      "訪問のたびに…犯して♡♡", "帰さない…朝まで♡♡", "出前より…精液が欲しい♡♡"],
        },
    },
    "cosplay_roleplay": {
        "name": "コスプレ→なりきり本気",
        "applicable_themes": ["コスプレ", "変装", "cosplay", "なりきり", "衣装"],
        "beats": [
            "コスプレ衣装を着て、露出の多い格好に興奮する",
            "キャラになりきり、大胆なポーズで体を見せつける",
            "衣装の隙間から体を触られ、なりきりのまま感じる",
            "コスプレ衣装をずらして挿入され、キャラの台詞で喘ぐ",
            "衣装を着たまま激しく犯され、コスプレセックスに溺れる",
            "衣装を精液で汚されて、キャラごと堕とされる",
        ],
        "dialogue_evolution": "露出→見せつけ→触る→挿入→激しく→汚す",
        "intensity_pattern": [1, 2, 2, 3, 4, 5],
        "key_lines": {
            "early": ["この衣装…胸はみ出しそう…", "スカート短い…パンツ見えてる…",
                       "コスプレで…こんな露出…", "衣装の隙間から…触らないで…", "ニーソの太もも…撫でないで…"],
            "mid": ["衣装ずらして…挿れるの…あっ…", "コスプレのまま…犯されてる…",
                     "キャラの台詞で…喘いじゃう…", "衣装…破かないで…感じちゃう…", "ニーソ履いたまま…中に…"],
            "late": ["衣装…精液で汚されちゃった♡", "コスプレセックス…最高♡♡",
                      "このキャラの格好で…イく♡♡", "もっとエロい衣装…着る♡♡", "衣装着たまま…中出しして♡♡"],
        },
    },
    "online_offline": {
        "name": "ネット→オフ会→実行",
        "applicable_themes": ["出会い", "マッチング", "ネット", "SNS", "DM", "オフ会"],
        "beats": [
            "マッチングアプリで会い、すぐにホテルに誘う",
            "初対面の緊張の中、キスして服を脱がし合う",
            "ネットで妄想していた体を実際に触り、興奮する",
            "初対面なのに生で挿入し、ネットより激しく求め合う",
            "何度も体位を変えて、初めてとは思えない激しさで犯す",
            "中出しして連絡先を交換し、定期セフレになる",
        ],
        "dialogue_evolution": "ホテル→脱がす→触る→挿入→激しく→中出し",
        "intensity_pattern": [1, 1, 2, 3, 4, 5],
        "key_lines": {
            "early": ["初めまして…ホテル…行く…？", "写真より…エロい体…",
                       "初対面で…脱ぐの…緊張する…", "ネットで想像してた…実物すごい…", "会って即…キスしちゃった…"],
            "mid": ["初めてなのに…生で入れるの…", "ネットの妄想より…全然…あっ…",
                     "初対面で…こんなに激しく…", "アプリの相手に…中出しされてる…", "画面越しより…ずっと気持ちいい…"],
            "late": ["定期で会って…♡", "アプリ退会する…あなた専用♡♡",
                      "毎週ホテルで…中出しして♡♡", "リアルの方が…100倍いい♡♡", "セフレじゃなくて…彼女にして♡♡"],
        },
    },
    "subordinate_boss": {
        "name": "部下×上司 出張先",
        "applicable_themes": ["OL", "上司", "出張", "部下", "会社", "オフィス", "残業"],
        "beats": [
            "出張先のホテルで部下と二人、酒を飲んで距離が縮まる",
            "酔った勢いでキスし、スーツの上から体を触り始める",
            "ホテルのベッドでスーツを脱がし合い、互いの体を貪る",
            "上司と部下の関係を忘れて挿入し、ベッドで激しく交わる",
            "出張の夜を最大限使い、何度も体位を変えて犯す",
            "朝まで何度も出し入れし、会社では知らん顔で通す",
        ],
        "dialogue_evolution": "酔う→触る→脱がす→挿入→激しく→秘密",
        "intensity_pattern": [1, 2, 2, 3, 4, 5],
        "key_lines": {
            "early": ["部長…ホテル…同じ部屋ですか…", "スーツ…脱がさないで…まだ…",
                       "酔ってます…胸…触らないで…", "上司なのに…キスしちゃった…", "ブラウスのボタン…外さないで…"],
            "mid": ["部長のが…入ってきた…あっ…", "出張先で…上司に犯されてる…",
                     "ベッドで…敬語使えない…", "バレたら…クビ…でも…もっと…", "スーツのまま…挿れないで…"],
            "late": ["部長…中に出して♡", "毎月出張…二人で♡♡",
                      "会社で知らん顔…つらい♡♡", "残業と称して…毎日♡♡", "秘書になって…毎日犯されたい♡♡"],
        },
    },
    "festival_night": {
        "name": "祭り/浴衣→非日常の夜",
        "applicable_themes": ["祭り", "浴衣", "花火", "夏祭り", "夏", "縁日"],
        "beats": [
            "祭りの帰り道、浴衣姿の彼女と二人きりになる",
            "浴衣の帯に手をかけ、はだけさせて胸を露出させる",
            "浴衣を乱しながら体中を舐め、下着のない体に触れる",
            "浴衣をたくし上げて挿入し、花火の音に紛れて喘ぐ",
            "浴衣がはだけたまま激しく突き、祭りの熱気で汗だく",
            "浴衣を精液で汚しながら中出しし、祭りの夜を終える",
        ],
        "dialogue_evolution": "脱がす→露出→愛撫→挿入→激しく→中出し",
        "intensity_pattern": [1, 1, 2, 3, 4, 5],
        "key_lines": {
            "early": ["浴衣の帯…ほどかないで…", "下に何も着てないの…見ないで…",
                       "浴衣はだける…胸…隠して…", "花火の音で…誤魔化して…", "外で…こんなこと…だめ…"],
            "mid": ["浴衣めくって…挿れないで…あっ…", "花火の音で…声…消えてる…？",
                     "浴衣の中で…指が…", "汗で…浴衣が…肌に張り付いて…", "祭りの帰りに…犯されてる…"],
            "late": ["浴衣…精液で…汚れちゃった♡", "花火より…あなたの中出しが綺麗♡♡",
                      "来年も…浴衣で犯して♡♡", "夏祭り…毎年中出し♡♡", "浴衣…脱がないで…このまま♡♡"],
        },
    },
    "training_submission": {
        "name": "調教→服従→依存",
        "applicable_themes": ["調教", "SM", "服従", "奴隷", "ドS", "飼育", "しつけ"],
        "beats": [
            "支配者に捕獲され、拘束されて服を剥がされる",
            "最初の調教で体中を弄ばれ、屈辱的な快感を与えられる",
            "繰り返しの調教で性感帯を開発され、体が覚え始める",
            "挿入されると抵抗の意思が折れ、快楽に屈服する",
            "自ら腰を振って求め、調教されることを懇願する",
            "完全な性奴隷となり、精液を受け止めて歓喜する",
        ],
        "dialogue_evolution": "拘束→弄ぶ→開発→挿入→懇願→奴隷化",
        "intensity_pattern": [1, 2, 3, 4, 5, 5],
        "key_lines": {
            "early": ["触るな…この体は…", "拘束を…解け…脱がすな…",
                       "こんなので…屈するか…", "汚い手で…胸触るな…", "絶対に…感じない…"],
            "mid": ["体が…反応して…嫌なのに…", "挿れるな…あっ…感じて…しまう…",
                     "何回イかせる気…もう…無理…", "体が…調教されて…しまった…", "腰が…勝手に…動いて…"],
            "late": ["ご主人様…もっと犯して♡", "調教されるの…好き♡♡",
                      "精液…全部飲みます♡♡", "奴隷として…中出しされたい♡♡♡", "壊れるまで…調教して♡♡♡"],
        },
    },
    "revenge_ntr": {
        "name": "寝取り返し/復讐NTR",
        "applicable_themes": ["NTR", "寝取", "復讐", "netorare", "浮気", "裏切り"],
        "beats": [
            "パートナーの浮気を知り、復讐相手を見つける",
            "復讐のつもりで別の男/女とキスし、服を脱ぐ",
            "怒りに任せて激しく前戯し、パートナーより良い体に興奮する",
            "復讐セックスで挿入し、パートナーとの違いに驚愕する",
            "怒りが快感に変わり、パートナーより気持ちいい体に溺れる",
            "復讐を超えて中出しされ、完全に乗り換える",
        ],
        "dialogue_evolution": "復讐→脱ぐ→前戯→挿入→快感→中出し",
        "intensity_pattern": [1, 1, 3, 4, 5, 5],
        "key_lines": {
            "early": ["あいつに…復讐してやる…", "脱ぐ…あいつより…いい体見せてやる…",
                       "キスして…あいつの味…消して…", "あいつより…上手いんでしょ…", "復讐…だから…遠慮しないで…"],
            "mid": ["あの人より…全然大きい…あっ…", "こんな奥…あの人じゃ届かない…",
                     "復讐のつもりが…本気で感じてる…", "あの人より…何倍も…気持ちいい…", "比べちゃだめなのに…全然違う…"],
            "late": ["あの人じゃ…中イキできなかった♡", "復讐じゃなくて…本気で欲しい♡♡",
                      "全部…上書きして♡♡", "精液で…あいつの記憶消して♡♡", "寝取り返し…最高♡♡♡"],
        },
    },
    "monster_mating": {
        "name": "異種族/モンスター交配",
        "applicable_themes": ["異種族", "モンスター", "触手", "monster", "オーク", "ゴブリン", "人外"],
        "beats": [
            "モンスター/異種族に捕獲され、服を引き裂かれる",
            "人間とは違う巨大な性器や触手に驚愕する",
            "異種の生殖器で全身の穴を同時に犯される",
            "人間では味わえない快感に体が順応し始める",
            "本能的な交配で子宮を直接突かれ、何度も絶頂する",
            "大量の精液を注がれ、人間の男では満足できなくなる",
        ],
        "dialogue_evolution": "捕獲→驚愕→陵辱→順応→交配→堕落",
        "intensity_pattern": [1, 2, 3, 4, 5, 5],
        "key_lines": {
            "early": ["服…引き裂かれた…", "この大きさ…人間じゃない…",
                       "触手が…全身に…", "穴が…全部…同時に…", "入らない…裂けちゃう…"],
            "mid": ["人間のと…全然違う…奥まで…", "触手で…全部の穴…同時に…あっ…",
                     "子宮に…直接…当たって…", "体が…モンスターに…順応してる…", "人間じゃ…こんなに感じない…"],
            "late": ["精液…大量に…注がれてる♡♡", "孕ませて…異種の子でも♡♡♡",
                      "人間の男じゃ…もう無理♡♡", "触手で全身…犯して♡♡♡", "モンスターの…肉便器になる♡♡♡"],
        },
    },

    # ====== v5.0 新パターン: 痴漢・公共・密室 ======

    "public_molestation": {
        "name": "公共場所での痴漢",
        "applicable_themes": ["痴漢", "chikan", "電車", "バス", "公共", "public", "満員電車", "通勤"],
        "beats": [
            "満員電車で背後から体を密着させられ、スカートの中に手が入る",
            "動けない状況でパンツの中を直接触られ、指を挿れられる",
            "声を出せずに感じてしまい、パンツが濡れていく",
            "周囲に気づかれないように挿入され、立ったまま犯される",
            "声を殺したまま何度も絶頂させられ、膝が震える",
            "精液を中に出されたまま下車し、太ももを伝う",
        ],
        "dialogue_evolution": "触られる→指→濡れる→挿入→絶頂→中出し",
        "intensity_pattern": [1, 2, 3, 3, 4, 4, 3, 4, 5, 4],
        "key_lines": {
            "early": ["スカートの中に…手が…", "パンツ…ずらさないで…",
                       "指…入れないで…人が…", "声出したら…バレる…", "触らないで…濡れちゃう…"],
            "mid": ["入ってる…電車の中で…", "立ったまま…犯されてる…",
                     "声…漏れちゃう…感じて…", "周り…気づいてない…のに…", "パンツの中…ぐちゃぐちゃ…"],
            "late": ["電車で…イっちゃう…♡♡", "中に出さないで…♡♡",
                      "精液…太ももに…垂れてる…♡♡", "また…同じ時間に乗る…♡♡♡", "毎朝…犯されたい…♡♡♡"],
        },
    },

    "toilet_trap": {
        "name": "トイレ/密室での凌辱",
        "applicable_themes": ["トイレ", "密室", "公衆トイレ", "便所", "個室", "閉じ込め"],
        "beats": [
            "個室に押し込まれ、狭い空間で服を剥がされる",
            "便器に座らされたまま、股を開かされて触られる",
            "口を塞がれながらフェラを強要され、壁に押し付けられる",
            "狭い個室で立ったまま/便器に跨がったまま挿入される",
            "ドアの向こうの足音に怯えながら激しく突かれる",
            "個室内で中出しされ、精液が便器に滴る",
        ],
        "dialogue_evolution": "押し込み→触る→フェラ→挿入→激しく→中出し",
        "intensity_pattern": [1, 2, 3, 4, 3, 4, 4, 5, 5, 2],
        "key_lines": {
            "early": ["狭い…個室で…脱がさないで…", "こんなとこで…やだ…開かないで…",
                       "汚い…こんな場所で…", "口塞がないで…息ができ…", "ドアの隙間…見えちゃう…"],
            "mid": ["座らされたまま…挿れるの…", "壁に押し付けられて…奥まで…",
                     "足音…怖い…でも…感じる…", "こんなとこで…最低なのに…", "狭くて…密着して…熱い…"],
            "late": ["こんなとこで…イっちゃう…♡♡", "やだ…垂れてる…♡♡",
                      "外に聞こえてもいい…♡♡", "汚い場所で…中出し…♡♡♡", "また…連れ込んで♡♡♡"],
        },
    },

    "stranger_assault": {
        "name": "見知らぬ相手からの暴行",
        "applicable_themes": ["暴行", "見知らぬ", "おじさん", "知らない男", "不審者", "凌辱", "強姦"],
        "beats": [
            "見知らぬ男に捕まり、力ずくで服を剥がされる",
            "抵抗できない力の差で押さえつけられ、全身を舐められる",
            "知らない男の太い指で性器を弄られ、体が反応してしまう",
            "見知らぬ男の巨根を挿入され、知らない精液の匂いに包まれる",
            "知らない相手に激しく突かれ、嫌悪と快感が混在する",
            "見知らぬ男に中出しされ、屈辱と快感で頭が壊れる",
        ],
        "dialogue_evolution": "捕獲→舐められる→弄る→挿入→激しく→中出し",
        "intensity_pattern": [1, 2, 3, 4, 3, 4, 4, 5, 4, 2],
        "key_lines": {
            "early": ["知らない人…服…破かないで…", "助けて…力が…全然…",
                       "臭い…嫌…体…舐めないで…", "知らない指…中に入れないで…", "顔も知らない男に…裸にされて…"],
            "mid": ["知らない男のが…入ってる…", "見知らぬ精液の匂い…嫌なのに…",
                     "顔も知らない男に…奥まで…", "嫌悪感…なのに…体が感じて…", "知らない男のが…大きくて…"],
            "late": ["知らない男に…イかされた…♡♡", "見知らぬ精液…中に…♡♡",
                      "知らない男の方が…気持ちいい…♡♡", "名前も知らないのに…堕ちた♡♡♡", "また…知らない男に犯されたい♡♡♡"],
        },
    },

    # ===== v6.0 新パターン（15種） =====

    "confession_date": {
        "name": "告白→初デート→初体験",
        "applicable_themes": ["love", "vanilla", "純愛", "恋人", "初体験", "カップル", "初めて"],
        "beats": [
            "初デートの帰り、ホテルに誘ってぎこちなくキスする",
            "初めて互いの服を脱がし合い、裸を見せ合う",
            "初めての体を震えながら触り合い、前戯する",
            "緊張しながら初めて挿入し、痛みと快感が混じる",
            "初めてなのに腰が止まらなくなり、夢中で突く",
            "初めての中出しで繋がったまま幸福感に浸る",
        ],
        "dialogue_evolution": "キス→脱がす→前戯→挿入→激しく→中出し",
        "intensity_pattern": [1, 1, 2, 2, 3, 4, 5],
        "key_lines": {
            "early": ["ホテル…いいの…？緊張する…", "服…脱ぐの…恥ずかしい…",
                       "裸…初めて見せる…", "ブラ外すの…見ないで…", "あそこ…見ないでよ…"],
            "mid": ["痛い…けど…入れて…", "初めてなのに…気持ちいい…",
                     "奥まで…来てる…あっ…", "初めてで…こんなに感じるの…", "動いて…もっと…"],
            "late": ["初めてなのに…中出し…♡", "繋がったまま…抜かないで♡♡",
                      "初めてが…最高…♡♡", "またすぐ…したい♡♡", "毎日…繋がってたい♡♡♡"],
        },
    },

    "isekai_slave": {
        "name": "異世界奴隷購入→主従→関係変化",
        "applicable_themes": ["isekai", "異世界", "奴隷", "ファンタジー", "主従", "エルフ"],
        "beats": [
            "奴隷として購入され、首輪をつけられて裸にされる",
            "主人に体を検分され、全身を触られて品定めされる",
            "奴隷紋が疼き、命令通りに股を開いて奉仕させられる",
            "主人に挿入され、奴隷紋の効果で快感が増幅される",
            "抵抗の意志が折れ、自ら腰を振って精液を求める",
            "完全な性奴隷となり、毎日主人に犯されることを喜ぶ",
        ],
        "dialogue_evolution": "裸→検分→強制奉仕→挿入→自発→奴隷化",
        "intensity_pattern": [1, 2, 3, 4, 4, 5],
        "key_lines": {
            "early": ["裸にするな…人間…", "首輪…外せ…体を…触るな…",
                       "奴隷紋が…体を…勝手に…", "品定めなんか…させない…", "股を…開けるわけ…あっ…"],
            "mid": ["人間に…犯されてる…屈辱…", "奴隷紋で…感じさせられて…",
                     "主人の…大きい…エルフの体に…", "逆らえない…体が…勝手に腰を…", "人間の精液…中に…熱い…"],
            "late": ["ご主人様…奴隷を犯して♡", "毎日…種付けしてください♡♡",
                      "エルフの子宮…人間に…♡♡", "奴隷の体…好きに使って♡♡", "一生…性奴隷でいます♡♡♡"],
        },
    },

    "isekai_capture": {
        "name": "勇者敗北→魔王軍捕獲→堕落",
        "applicable_themes": ["isekai", "異世界", "勇者", "魔王", "敗北", "corruption", "堕落"],
        "beats": [
            "魔王軍に敗北し、鎧を剥がされて裸で拘束される",
            "魔族に体中を弄ばれ、勇者の体を玩具にされる",
            "魔王自ら勇者の体を犯し、聖なる力を快楽で穢す",
            "何度も絶頂させられ、勇者の誇りが快感で折れていく",
            "魔王の精液を注がれ、闇の魔力に体が染まる",
            "自ら魔王に腰を振り、勇者から魔王の性奴隷に堕ちる",
        ],
        "dialogue_evolution": "拘束→弄ぶ→犯す→絶頂→注がれる→堕落",
        "intensity_pattern": [1, 2, 3, 4, 5, 5],
        "key_lines": {
            "early": ["鎧…剥がすな…裸を見るな…", "勇者の体…玩具にするな…",
                       "拘束が…聖なる力が…出ない…", "触るな…魔族の手で…", "仲間が…助けに…来る…"],
            "mid": ["勇者の体が…魔王に…犯されて…", "聖なる力が…快感で…穢れて…",
                     "魔王の…大きすぎ…勇者なのに…", "何回…イかせる…もう無理…", "闇の魔力…体に…染みて…"],
            "late": ["魔王様…精液もっと♡♡", "勇者…やめる…魔王の奴隷になる♡♡",
                      "聖なる子宮…闇に染めて♡♡", "世界より…魔王の精液♡♡♡", "勇者の穴…全部魔王のもの♡♡♡"],
        },
    },

    "onsen_encounter": {
        "name": "温泉鉢合わせ→混浴→湯の中で",
        "applicable_themes": ["温泉", "onsen", "入浴", "風呂", "旅館", "混浴", "銭湯"],
        "beats": [
            "温泉で鉢合わせし、互いの全裸を見てしまう",
            "湯船の中で体が触れ、濡れた肌同士が密着する",
            "湯気の中で胸やお尻を触り合い、お湯の下で手が伸びる",
            "温泉の中で挿入し、お湯が波立つ中で交わる",
            "脱衣所に移動して体を拭く間もなく激しく犯す",
            "部屋に戻って布団の上で中出しし、温泉の余韻に浸る",
        ],
        "dialogue_evolution": "全裸→密着→触る→挿入→激しく→中出し",
        "intensity_pattern": [1, 1, 2, 3, 4, 5],
        "key_lines": {
            "early": ["全裸…見られちゃった…", "タオルで…隠して…おっぱい…",
                       "お湯の中でも…裸は裸…", "体…見ないで…全部見えてる…", "湯船で…密着しないで…"],
            "mid": ["お湯の中で…指が…あっ…", "温泉で…挿れないで…波が…",
                     "湯気で…顔見えないけど…感じてる…", "お湯がぐちゃぐちゃ…バレる…", "脱衣所で…濡れたまま…"],
            "late": ["温泉より…中が熱い♡", "お湯の中で…イっちゃった♡♡",
                      "部屋で…もう一回…中出し♡♡", "朝風呂で…また犯して♡♡", "温泉旅行…毎月行こ♡♡♡"],
        },
    },

    "changing_room": {
        "name": "更衣室→目撃→密室",
        "applicable_themes": ["水着", "プール", "部活", "スポーツ", "swimsuit", "着替え", "更衣室"],
        "beats": [
            "更衣室で着替え中の裸を見られ、逃げ場がない",
            "水着姿/下着姿のまま押し倒され、胸を揉まれる",
            "濡れた肌を舐められ、水着の隙間から指を入れられる",
            "水着をずらして挿入され、ロッカーに押し付けられる",
            "人が来る緊張感の中で声を殺しながら激しく突かれる",
            "時間切れギリギリで中出しされ、精液が水着に染みる",
        ],
        "dialogue_evolution": "裸→押し倒す→指→挿入→激しく→中出し",
        "intensity_pattern": [1, 2, 3, 4, 4, 5],
        "key_lines": {
            "early": ["着替え中…裸見ないで…", "水着…脱ぎかけ…押し倒さないで…",
                       "濡れた体…触らないで…", "ロッカーに…押し付けないで…", "鍵…かけ忘れてて…誰か来たら…"],
            "mid": ["水着ずらして…入れるの…あっ…", "ロッカーに押し付けられて…奥まで…",
                     "シャワーの音で…声…消えてる…？", "濡れてるの…水じゃない…", "人が来る…早く…でも止めないで…"],
            "late": ["更衣室で…中出し…♡♡", "水着…精液で…汚れちゃった♡♡",
                      "次の授業…間に合わない♡♡", "着替えのたびに…犯して♡♡", "プールの後は…いつもこう♡♡♡"],
        },
    },

    "medical_exam": {
        "name": "診察→不適切触診→医療行為の延長",
        "applicable_themes": ["医療", "診察", "doctor", "医者", "検診", "ナース", "病院"],
        "beats": [
            "診察で服を脱がされ、必要以上に体を触られる",
            "診察台の上で股を開かされ、性器を直接弄られる",
            "治療と称して指やバイブを挿入され、体が反応する",
            "診察台の上で医者に挿入され、白衣越しに犯される",
            "聴診器を当てながら激しく突かれ、心音が乱れる",
            "診察室で中出しされ、定期的な「治療」が始まる",
        ],
        "dialogue_evolution": "脱がす→触診→器具→挿入→激しく→中出し",
        "intensity_pattern": [1, 2, 2, 3, 4, 5],
        "key_lines": {
            "early": ["先生…そこは…診察に関係…", "下も脱ぐんですか…全部…",
                       "足…そんなに開かないで…", "他の先生は…触らないのに…", "指…中に入れるんですか…"],
            "mid": ["先生…それ治療器具じゃ…あっ…", "診察台で…挿れるなんて…",
                     "白衣越しに…犯されてる…", "聴診器…心音…バレちゃう…", "患者さんに…聞こえる…声…"],
            "late": ["先生の精液…治療薬…♡♡", "毎週…内診お願いします♡♡",
                      "先生専用の…患者になる♡♡", "診察台…私の定位置♡♡", "先生の注射…子宮に♡♡♡"],
        },
    },

    "idol_backstage": {
        "name": "アイドル楽屋→プロデューサー→裏の顔",
        "applicable_themes": ["アイドル", "idol", "芸能", "プロデューサー", "地下アイドル", "ステージ"],
        "beats": [
            "ライブ後の楽屋で、衣装姿のままPに体を触られる",
            "アイドルの立場を盾に、衣装をずらして胸を露出させられる",
            "ステージ衣装のまま跪かされ、口で奉仕させられる",
            "楽屋のソファで衣装を着たまま挿入される",
            "ファンに見せられない淫らな表情で、衣装姿のまま何度もイかされる",
            "衣装を精液で汚され、次のライブまでPの性処理係になる",
        ],
        "dialogue_evolution": "触られる→露出→奉仕→挿入→絶頂→性処理",
        "intensity_pattern": [1, 2, 3, 3, 4, 5],
        "key_lines": {
            "early": ["P…さん…衣装の中…触らないで…", "ステージ衣装…脱がさないで…",
                       "マネージャーが来たら…胸…隠して…", "アイドルなのに…こんな格好…", "スカート…めくらないで…"],
            "mid": ["衣装姿で…フェラ…させるんですか…", "楽屋のソファで…入ってきた…あっ…",
                     "アイドルの顔…できない…感じて…", "握手会前なのに…精液の匂い…", "ファンに…こんな声…聞かれたら…"],
            "late": ["P…さん…衣装精液まみれ♡♡", "アイドル…Pの性処理係♡♡",
                      "ライブより…Pに犯される方が♡♡", "裏の顔…あなただけに見せる♡♡", "次のライブまで…毎日犯して♡♡♡"],
        },
    },

    "neighbor_visit": {
        "name": "隣人→鍵忘れ→お泊り→壁一枚",
        "applicable_themes": ["隣人", "neighbor", "お隣", "アパート", "マンション", "vanilla"],
        "beats": [
            "鍵を忘れて隣人の部屋に上がり、薄着で過ごす",
            "シャワーを借りた後、タオル一枚の姿に興奮する",
            "ベッド/布団が足りず密着し、体を触り始める",
            "壁が薄いのに声を殺しながら挿入する",
            "隣人の体を激しく突き、壁の向こうに聞こえないよう必死",
            "中出しして、隣人から毎晩通う関係に変わる",
        ],
        "dialogue_evolution": "薄着→タオル→触る→挿入→激しく→中出し",
        "intensity_pattern": [1, 1, 2, 3, 4, 5],
        "key_lines": {
            "early": ["タオル一枚…見ないで…", "パジャマ…持ってない…この格好で…",
                       "壁薄い…声出しちゃだめ…", "シャワー後…体温かい…密着しないで…", "隣の部屋に…聞こえちゃう…"],
            "mid": ["布団の中で…挿れないで…あっ…", "壁薄いのに…声出ちゃう…",
                     "隣人に…犯されてる…嬉しい…", "ベッド軋む…隣に聞こえる…", "お隣さんのが…大きい…"],
            "late": ["毎晩…隣の部屋から来て♡", "壁越しに…喘ぎ聞かせてあげる♡♡",
                      "合鍵渡す…いつでも犯して♡♡", "壁なんかいらない…♡♡", "隣人の精液…毎晩中出し♡♡♡"],
        },
    },

    "sleep_visit": {
        "name": "就寝→忍び寄り→覚醒→抵抗できない",
        "applicable_themes": ["睡眠", "夜這い", "sleep", "添い寝", "寝込み", "夜"],
        "beats": [
            "寝ている間にパジャマを脱がされ、体を触られ始める",
            "半覚醒状態で胸を揉まれ、下着の中に指が入る",
            "寝たふりを続けながら、体が反応して濡れていく",
            "気づいていることに気づかれず、そのまま挿入される",
            "寝たふりのまま感じてしまい、声を漏らしてバレる",
            "起きていたことを告白し、自分から腰を振って求める",
        ],
        "dialogue_evolution": "触られる→指→寝たふり→挿入→バレる→求める",
        "intensity_pattern": [1, 2, 2, 3, 4, 5],
        "key_lines": {
            "early": ["んっ…パジャマ…脱がされて…", "指…下着の中に…んん…",
                       "寝てるのに…胸…触って…", "夢…じゃない…手が…", "寝たふり…しなきゃ…"],
            "mid": ["寝たふり…してるのに…入ってきた…", "寝てる間に…犯されてる…あっ…",
                     "声…漏れちゃう…起きてるの…バレる…", "体が…反応して…濡れてる…", "寝たふりなのに…腰動いちゃう…"],
            "late": ["起きてた…最初から気持ちよかった♡", "毎晩…夜這いして犯して♡♡",
                      "寝てる間に…全部出して♡♡", "朝まで…犯し続けて♡♡", "寝込み…中出し♡♡♡"],
        },
    },

    "group_assault": {
        "name": "包囲→蹂躙→交代→崩壊",
        "applicable_themes": ["輪姦", "集団", "gangbang", "group", "複数", "乱交", "forced"],
        "beats": [
            "複数人に囲まれ、服を引き裂かれて全裸にされる",
            "口と性器を同時に使われ、体の穴全てを塞がれる",
            "代わる代わるの挿入で休む間もなく犯され続ける",
            "前も後ろも同時に挿入され、二穴同時で壊れ始める",
            "何人もの精液を注がれ、体中が白く汚される",
            "全員分を受け入れ、精液まみれで完全崩壊する",
        ],
        "dialogue_evolution": "剥ぐ→同時→代わる→二穴→注がれる→崩壊",
        "intensity_pattern": [1, 3, 4, 4, 5, 5],
        "key_lines": {
            "early": ["服…破かないで…何人…", "口と…同時に…むり…",
                       "全部の穴…塞がないで…", "一人ずつにして…壊れる…", "逃げられない…囲まれて…"],
            "mid": ["何人目…もうわかんない…", "前と後ろ…同時に…裂ける…",
                     "精液…全身に…ベタベタ…", "休ませて…次の人…もう…", "お腹…精液でパンパン…"],
            "late": ["全員の…受け止める♡♡", "もっと…全員で犯して♡♡",
                      "精液まみれ…もっと♡♡♡", "全部の穴…同時に使って♡♡♡", "壊れても…全員分出して♡♡♡"],
        },
    },

    "service_escalation": {
        "name": "風俗サービス→本番→感情の芽生え",
        "applicable_themes": ["風俗", "prostitution", "ソープ", "デリヘル", "サービス", "嬢"],
        "beats": [
            "指名客の前で服を脱ぎ、プロの手つきで体を洗い始める",
            "マニュアル通りの手コキ・フェラでサービスする",
            "客の要望で禁止行為の生挿入を求められ、断れない",
            "プロの仮面が剥がれ、本気で感じてしまう",
            "仕事を超えた快感に溺れ、自分から腰を振る",
            "生中出しを受け入れ、この客専用の嬢になる",
        ],
        "dialogue_evolution": "脱ぐ→奉仕→生挿入→本気→自発→専属",
        "intensity_pattern": [1, 2, 3, 4, 4, 5],
        "key_lines": {
            "early": ["ご指名ありがとう…脱ぎますね…", "お体…洗いますね…大きい…",
                       "フェラ…お好きですか…♡", "手で…いかせますね…", "サービス…何でもします…"],
            "mid": ["生は…禁止なのに…入れちゃうの…", "仕事なのに…本気で感じてる…",
                     "お客さんのが…今までで一番…", "中はだめ…あっ…出しちゃ…", "プロなのに…イっちゃう…"],
            "late": ["お金いらない…生で出して♡♡", "仕事じゃない…本気で欲しい♡♡",
                      "指名…あなただけ♡♡", "プライベートで…中出しして♡♡", "引退する…あなた専用の体♡♡♡"],
        },
    },

    "photography_session": {
        "name": "撮影→過激化→カメラマンが一線越え",
        "applicable_themes": ["撮影", "cosplay", "コスプレ", "モデル", "グラビア", "カメラ"],
        "beats": [
            "撮影でポーズがエスカレートし、下着姿にされる",
            "カメラマンが直接体に触れてポーズをつけ、胸を揉む",
            "全裸にされ、股を開いたポーズで性器を撮影される",
            "カメラを回したまま挿入され、撮影しながら犯される",
            "レンズの前で何度もイかされ、淫らな表情を撮られ続ける",
            "撮影データと引き換えに、定期的な撮影兼セックスが始まる",
        ],
        "dialogue_evolution": "脱がす→触る→全裸→挿入→イかされる→継続",
        "intensity_pattern": [1, 2, 2, 3, 4, 5],
        "key_lines": {
            "early": ["下着まで…脱ぐんですか…", "胸…直接触らないで…ポーズなら…",
                       "カメラの前で…全裸…恥ずかしい…", "股…開くポーズ…嫌です…", "あそこ…撮らないで…"],
            "mid": ["撮影しながら…挿れるの…", "カメラの前で…犯されてる…",
                     "レンズに…イく顔…撮られてる…", "データ…消して…あっ…無理…", "撮影中に…中出しなんて…"],
            "late": ["もっと撮って…イく顔♡♡", "カメラの前で…中出し♡♡",
                      "撮影データ…あなただけに♡♡", "もっと過激な…撮影♡♡", "毎週…撮影で犯して♡♡♡"],
        },
    },

    "club_room_afterschool": {
        "name": "放課後部室→二人きり→練習の延長",
        "applicable_themes": ["部室", "放課後", "部活", "先輩", "後輩", "学校", "teacher_student"],
        "beats": [
            "放課後の部室で二人きりになり、鍵を閉める",
            "練習の延長で体が密着し、制服の上から胸を触る",
            "制服を乱しながらキスし、ブラウスのボタンを外す",
            "部室のマットの上で制服姿のまま挿入する",
            "用具室の奥で声を殺しながら激しく突く",
            "放課後の部室で中出しし、秘密の関係が始まる",
        ],
        "dialogue_evolution": "密室→触る→脱がす→挿入→激しく→中出し",
        "intensity_pattern": [1, 1, 2, 3, 4, 5],
        "key_lines": {
            "early": ["先輩…鍵閉めたんですか…", "制服…触らないで…ボタン…",
                       "二人きりで…胸揉まないで…", "部室で…こんなこと…だめ…", "他の部員来たら…"],
            "mid": ["マットの上で…制服のまま…あっ…", "先輩の…入ってきた…部室で…",
                     "用具室の奥で…声出せない…", "制服…精液つく…だめ…", "先輩…奥まで…もっと…"],
            "late": ["放課後…先輩に犯されるの楽しみ♡", "部室…二人の秘密の場所♡♡",
                      "制服…精液の匂い♡♡", "毎日…居残り中出し♡♡", "卒業まで…部室でヤろ♡♡♡"],
        },
    },

    "part_time_romance": {
        "name": "バイト先→閉店後→バックルーム",
        "applicable_themes": ["バイト", "アルバイト", "職場", "閉店", "vanilla", "同僚"],
        "beats": [
            "閉店後に二人きりになり、バックルームで体が近づく",
            "制服の上から体を触り始め、エプロンの下に手が入る",
            "倉庫の棚の間で制服を乱し、キスして前戯する",
            "制服姿のまま倉庫の中で挿入し、商品棚に押し付ける",
            "閉店後の店内で場所を変えながら激しく犯す",
            "バックルームで中出しし、制服を精液で汚す",
        ],
        "dialogue_evolution": "密着→触る→前戯→挿入→激しく→中出し",
        "intensity_pattern": [1, 1, 2, 3, 4, 5],
        "key_lines": {
            "early": ["閉店後…二人きり…エプロンの下…触らないで…", "バックルーム…暗い…胸揉まないで…",
                       "制服の中に…手入れないで…", "防犯カメラ…映ってる…だめ…", "倉庫の棚…狭い…密着しちゃう…"],
            "mid": ["制服のまま…挿れるの…あっ…", "商品棚に…押し付けられて…奥まで…",
                     "店長来たら…クビ…でも止まらない…", "エプロンの下で…犯されてる…", "倉庫で…声出しちゃだめ…"],
            "late": ["閉店後…毎日犯して♡", "バックルーム…精液臭い♡♡",
                      "制服…汚されちゃった♡♡", "シフト合わせて…毎日中出し♡♡", "バイト辞められない…この快感♡♡♡"],
        },
    },

    "rain_shelter": {
        "name": "雨宿り→密着→濡れた服→体温で温め合い",
        "applicable_themes": ["雨", "雨宿り", "love", "vanilla", "ロマンチック", "偶然"],
        "beats": [
            "雨で濡れた服が体に張り付き、下着が透けて見える",
            "寒さを口実に密着し、濡れた服の上から胸を触る",
            "服を脱いで温め合い、裸同士で体を擦り合わせる",
            "体温で温め合ううちに興奮し、そのまま挿入する",
            "雨音に紛れて激しく腰を振り、濡れた体が絡み合う",
            "雨が止んでも離れられず、中出しして体を重ねたまま",
        ],
        "dialogue_evolution": "透ける→触る→脱ぐ→挿入→激しく→中出し",
        "intensity_pattern": [1, 1, 2, 3, 4, 5],
        "key_lines": {
            "early": ["服…透けてる…ブラ見えてる…", "濡れた服…脱がさないで…",
                       "寒い…くっつくと…胸が当たる…", "下着まで…びしょ濡れ…", "体で温めるって…裸で…？"],
            "mid": ["濡れた体…直接…あっ…入ってくる…", "雨音で…声消えてる…もっと…",
                     "寒かったのに…中が…熱い…", "濡れた肌…ぬるぬるして…", "雨宿りで…犯されてる…"],
            "late": ["雨止んだけど…抜かないで♡", "濡れてるの…雨のせいじゃない♡♡",
                      "中出しされて…体あったかい♡♡", "雨降るたびに…犯して♡♡", "濡れた体…精液で温めて♡♡♡"],
        },
    },
}

# --- ストーリーパターン拡張マージ ---
_PATTERN_IMPORTS = [
    ("story_patterns_group_a", "PATTERNS_GROUP_A"),
    ("story_patterns_ext_b", "PATTERNS_EXT_B"),
    ("story_patterns_ext_c", "PATTERNS_EXT_C"),
    ("story_patterns_ext_d", "PATTERNS_EXT_D"),
    ("story_patterns_ext_e", "PATTERNS_EXT_E"),
]
for _mod, _var in _PATTERN_IMPORTS:
    try:
        _m = __import__(_mod)
        STORY_PATTERN_LIBRARY.update(getattr(_m, _var))
    except (ImportError, AttributeError):
        pass


def select_story_pattern(theme: str, concept: str = "") -> dict | None:
    """テーマ/コンセプトから最適なストーリーパターンを選択。
    マッチしない場合はNoneを返す。"""
    theme_lower = theme.lower() if theme else ""
    concept_lower = concept.lower() if concept else ""
    combined = f"{theme_lower} {concept_lower}"

    best_match = None
    best_score = 0

    for key, pattern in STORY_PATTERN_LIBRARY.items():
        score = 0
        for kw in pattern["applicable_themes"]:
            kw_lower = kw.lower()
            if kw_lower in combined:
                score += 2
            elif kw_lower in theme_lower:
                score += 1
        if score > best_score:
            best_score = score
            best_match = pattern
    return best_match if best_score >= 1 else None


def get_pattern_key_lines(theme: str, concept: str = "", phase: str = "mid") -> list:
    """パターンのフェーズに応じたkey_linesを返す。phase: early/mid/late"""
    pattern = select_story_pattern(theme, concept)
    if not pattern:
        return []
    return list(pattern.get("key_lines", {}).get(phase, []))
